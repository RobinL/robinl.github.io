"use strict";(self.webpackChunkrobinlinacre=self.webpackChunkrobinlinacre||[]).push([[5256],{5391:function(e,t,n){n.r(t),n.d(t,{Head:function(){return C},default:function(){return B},output_order:function(){return L}});var r=n(7294),i=n(7848),a=n(7825);function o(e,t,n){return e`# ${t(n[1],n[0])} years of flights`}function l(e){return e`A final version of this notebook can be viewed on my blog [here](https://www.robinlinacre.com/flights/).`}function u(e,t,n,r,i,a,o,l,u,c){return e`Between ${t(n[0])} and ${t(n[1])} I took ${r.length} flights with and average distance of ${i(a)} miles, and total milage of ${i(o)}.  Total energy usage was around ${l(u.flying.flying_miles_to_kwh(o))} kwh or ${l(c)} tonnes of co2.

You can drag the globe below to rotate.`}function c(e,t,n,r,i,a,o,l,u,c,s){const d=e.context2d(t,n),f=r.geoPath(i,d);function m(){d.clearRect(0,0,t,n),d.beginPath(),f(a),d.fillStyle="#fff",d.fill(),d.beginPath(),f(o),d.fillStyle="#000",d.fill(),d.beginPath(),f(a),d.stroke(),l.forEach((function(e){let t=[[e.lng_from,e.lat_from],[e.lng_to,e.lat_to]],n=u(t),r=[n.after[1][0]+e.random,n.after[1][1]+e.random];n.after[1]=r;let i={type:"LineString",coordinates:n.after};d.lineWidth=1,d.lineO,d.beginPath(),f(i),d.strokeStyle=c(e.date),d.stroke()})),d.lineWidth=1,d.strokeStyle="#000000"}return r.select(d.canvas).call(s(i).on("drag.render",m)).call(m).node()}function s(e,t,n,r){return e.geoOrthographic().fitExtent([[1,1],[t-1,n-1]],r).translate([t/2,n/2]).rotate([0,-51]).precision(.1)}function d(e,t,n){return e(t.flying.flying_miles_to_kwh(n))/1e3}function f(e){return function(t){return t*e.convert.per("kg_co2_jet_fuel/kwh")}}function m(e,t){return e.sum(t,(e=>e.distance))}function h(e,t){return e.mean(t,(e=>e.distance))}function v(e){return e("@robinl/energy_usage@0.0.34")}function _(e,t){return e.extent(t,(e=>e.date))}function b(e){return e.format(",.0f")}function g(e){return e.format(",.2r")}function p(){return function(e,t){var n=(e.getTime()-t.getTime())/1e3;return n/=86400,Math.abs(Math.round(n/365.25))}}function w(){return e=>e.toISOString().split("T")[0]}function y(e,t){return e.scaleSequential(e.interpolateOrRd).domain(e.extent(t,(e=>e.date)))}function k(e,t){return function(n){for(var r=0,i=n.length,a=[],o=[];++r<i;){var l=n[r-1].slice(),u=n[r].slice(),c=e(l),s=e(u),d=s[0]-c[0],f=s[1]-c[1],m=d*d+f*f;if(a.push(l),o.push(l),m>.4){var h=t.geoInterpolate(l,u)(.5),v=e(h),_=v[0]-c[0],b=v[1]-c[1],g=f*_-d*b;if(g*g/m>.1){var p=(_*d+b*f)/m;a.push(e.invert(h.resampled=[c[0]+p*d,c[1]+p*f])),o.push(h)}}}return i&&(a.push(u),o.push(u)),{before:a,after:o}}}function E(e,t){return function(n){let r,i,a;return t.drag().on("start",(function(){r=e.cartesian(n.invert(t.mouse(this))),i=e(a=n.rotate())})).on("drag",(function(){const o=e.cartesian(n.rotate(a).invert(t.mouse(this))),l=e.multiply(i,e.delta(r,o));n.rotate(e.rotation(l))}))}}function j(e){return e}function $(){return{type:"Sphere"}}function S(e,t){return e.feature(t,t.objects.land)}function x(e){return e.json("https://unpkg.com/world-atlas@1/world/110m.json")}function O(e){return e("versor@0.0.3")}function q(e){return e("topojson-client@3")}function I(e){return e("d3@5")}function M(e){return e.csv("https://gist.githubusercontent.com/RobinL/ba3acbf42349115ed266a98643eb5a80/raw/a603b1fec071383d6a3eb27cbcda789c54cb0014/my_flights.csv",e.autoType)}function P(e){return e.map((e=>(e.random=(Math.random()-.5)*e.distance/1e3,e)))}function R(e,t){const n=e.module();return n.variable(t("title")).define("title",["md","diff_years","start_end_date"],o),n.variable(t()).define(["md"],l),n.variable(t("blurb")).define("blurb",["md","format_date","start_end_date","routes","fmt_num","average_miles","total_miles","fmt_num_round","eu","tonnes_co2"],u),n.variable(t("chart")).define("chart",["DOM","width","height","d3","projection","sphere","land","routes","resample","colour_scale","drag"],c),n.variable(t("projection")).define("projection",["d3","width","height","sphere"],s),n.variable(t("tonnes_co2")).define("tonnes_co2",["kwh_to_kg_co2","eu","total_miles"],d),n.variable(t("kwh_to_kg_co2")).define("kwh_to_kg_co2",["eu"],f),n.variable(t("total_miles")).define("total_miles",["d3","routes"],m),n.variable(t("average_miles")).define("average_miles",["d3","routes"],h),n.variable(t("eu")).define("eu",["require"],v),n.variable(t("start_end_date")).define("start_end_date",["d3","routes"],_),n.variable(t("fmt_num")).define("fmt_num",["d3"],b),n.variable(t("fmt_num_round")).define("fmt_num_round",["d3"],g),n.variable(t("diff_years")).define("diff_years",p),n.variable(t("format_date")).define("format_date",w),n.variable(t("colour_scale")).define("colour_scale",["d3","routes"],y),n.variable(t("resample")).define("resample",["projection","d3"],k),n.variable(t("drag")).define("drag",["versor","d3"],E),n.variable(t("height")).define("height",["width"],j),n.variable(t("sphere")).define("sphere",$),n.variable(t("land")).define("land",["topojson","world"],S),n.variable(t("world")).define("world",["d3"],x),n.variable(t("versor")).define("versor",["require"],O),n.variable(t("topojson")).define("topojson",["require"],q),n.variable(t("d3")).define("d3",["require"],I),n.variable(t("routes_raw")).define("routes_raw",["d3"],M),n.variable(t("routes")).define("routes",["routes_raw"],P),n}var T=n(5860);const C=e=>r.createElement(a.H,{frontmatter:e.pageContext.frontmatter}),L=["title","blurb","chart"];function W(e){return r.createElement(T.Z,{notebook:R,cells:L})}var B=function(e){return void 0===e&&(e={}),r.createElement(i.fE,e,r.createElement(W,e))}},5860:function(e,t,n){var r=n(7294),i=n(6493);const a="mdx-container-div",o=new i.Zu,l=Object.assign({},o,{width:function(){return o.Generators.observe((e=>{let t=e(document.getElementById(a).clientWidth);function n(){let n=document.getElementById(a).clientWidth;n!==t&&e(t=n)}return window.addEventListener("resize",n),()=>window.removeEventListener("resize",n)}))}});t.Z=function(e){let{notebook:t,cells:n,customClassName:a}=e;const o=(0,r.useRef)(n.map((()=>r.createRef())));return(0,r.useEffect)((()=>{const e=new i.r_(l);return e.module(t,(e=>{const t=n.indexOf(e);if(-1!==t)return new i.lj(o.current[t].current)})),()=>e.dispose()}),[t,n]),r.createElement("div",{className:a},o.current.map(((e,t)=>r.createElement("div",{key:t,ref:e}))))}},7825:function(e,t,n){n.d(t,{H:function(){return a}});var r=n(7294),i=n(4160);const a=e=>{let{frontmatter:t}=e;const{title:n,description:a,image:o,siteUrl:l,twitterUsername:u}=(0,i.K2)("1865044719").site.siteMetadata,c={title:(null==t?void 0:t.title)||n,description:(null==t?void 0:t.description)||a,image:`${l}${(null==t?void 0:t.image)||o}`,url:`${l}${(null==t?void 0:t.pathname)||""}`,twitterUsername:u,...t},s=null==t?void 0:t.stylesheet;return r.createElement(r.Fragment,null,r.createElement("title",null,c.title),r.createElement("meta",{name:"description",content:c.description}),r.createElement("meta",{name:"image",content:c.image}),s&&r.createElement("link",{rel:"stylesheet",type:"text/css",href:`/styles/${s}`}))}}}]);
//# sourceMappingURL=component---src-mdx-flights-mdx-670be02566ada69bb0a3.js.map