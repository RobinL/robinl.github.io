"use strict";(self.webpackChunkrobinlinacre=self.webpackChunkrobinlinacre||[]).push([[1749],{9394:function(e,t,a){a.r(t),a.d(t,{Head:function(){return C},default:function(){return Z}});var r=a(1151),o=a(7294),n=a(6965),i=a(7825),l=a(8588),s=a(8342);a(2692),a(6702);function c(e){return e`# ## partial match weights draft`}function m(e){return e.button("refresh splink_vis_utils javascript lib")}function _(e){const t={domain:["Prior","probability_two_random_records_match","first_name","surname","postcode","gender","Final score"],range:["#1f77b4","#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#17becf"]};function a(e,t=1){const[a,r,o]=[parseInt(e.slice(1,3),16),parseInt(e.slice(3,5),16),parseInt(e.slice(5,7),16)];return`rgba(${a}, ${r}, ${o}, ${t})`}const r={};return t.domain.forEach(((e,o)=>{r[e]=[a(t.range[o],.35),a(t.range[o],.1)]})),e`
  <table id="data-table">
    <tr>
      <th style="background-color:${r.first_name[0]};">first_name</th>
      <th style="background-color:${r.surname[0]};">surname</th>
      <th style="background-color:${r.postcode[0]};">postcode</th>
      <th style="background-color:${r.gender[0]};">gender</th>
    </tr>
    <tr contenteditable>
      <td style="background-color:${r.first_name[1]};">Robin</td>
      <td style="background-color:${r.surname[1]};">Linacre</td>
      <td style="background-color:${r.postcode[1]};">W1A 1AA</td>
      <td style="background-color:${r.gender[1]};">
        <select>
          <option value="male">Male</option>
          <option value="female" selected>Female</option>
          <option value="other">Non-binary</option>
        </select>
      </td>
    </tr>
    <tr contenteditable>
      <td style="background-color:${r.first_name[1]};">Robyn</td>
      <td style="background-color:${r.surname[1]};">Linacre</td>
      <td style="background-color:${r.postcode[1]};">W1A 1AA</td>
      <td style="background-color:${r.gender[1]};">
        <select>
          <option value="male" selected>Male</option>
          <option value="female">Female</option>
          <option value="other">Non-binary</option>
        </select>
      </td>
    </tr>
  </table>`}function d(e,t,a){return e(t.charts.partial_match_weights_chart(a,!0))}function p(e,t){const a={Prior:"#1f77b4",probability_two_random_records_match:"#1f77b4",first_name:"#ff7f0e",surname:"#2ca02c",postcode:"#d62728",gender:"#9467bd","Final score":"#17becf"};return t`<ul>${e.filter((e=>"Prior"!==e.column_name&&"Final score"!==e.column_name)).map((e=>`\n    <li style="color: ${a[e.column_name]||"#000"};">\n      <span style="display: inline-block; width: 120px; font-family: monospace;">${e.column_name}</span>:   \n      <span style="font-family: monospace;">'${e.value_l}'</span> \n      vs \n      <span style="font-family: monospace;">'${e.value_r}'</span> \n      is categorised as ${e.label_for_charts}\n    </li>\n  `)).join("")}</ul>`}function h(e,t,a,r){let o=e.settingsToWaterfall(t,a[0]);return r(e.charts.waterfall_chart(o,!0))}function u(e,t){const a={Prior:"#1f77b4",probability_two_random_records_match:"#1f77b4",first_name:"#ff7f0e",surname:"#2ca02c",postcode:"#d62728",gender:"#9467bd","Final score":"#17becf"};let r=`\n\\begin{array}{rcl rcl rcl rcl}\n${e.filter((e=>"Final score"!==e.column_name)).map((e=>`\\textcolor{${a[e.column_name]}}{\\omega_{\\text{${e.column_name.replace(/_/g,"\\_")}}}} &+&`)).join(" ").slice(0,-3)} &=& \\textcolor{${a["Final score"]}}{\\text{Final match weight}} \\\\[2ex]\n`,o=e.find((e=>"Final score"===e.column_name)).log2_bayes_factor.toFixed(2);return r+=`${e.filter((e=>"Final score"!==e.column_name)).map((e=>{let t=e.log2_bayes_factor.toFixed(2),r=a[e.column_name];return`\\textcolor{${r}}{${t}} &+&`})).join(" ").slice(0,-3)} &=& \\textcolor{${a["Final score"]}}{${o}} \\\\\n\\end{array}\n`,t`${r}`}function f(e,t){let a=e.find((e=>"Final score"===e.column_name)).log2_bayes_factor,r=Math.pow(2,a)/(1+Math.pow(2,a));return t`${`\\large{\\text{probability} = \\frac{2^{\\omega}}{1 + 2^{\\omega}} = \\frac{2^{${a.toFixed(2)}}}{1 + 2^{${a.toFixed(2)}}} = ${r.toFixed(3)}}`}`}function b(e,t,a){return e.settingsToWaterfall(t,a[0])}function g(e,t,a){return e.settingsToWaterfall(t,a[0])}function y(e,t,a){return e.observe((e=>{const r=r=>e(t.parseTableData(a));return a.addEventListener("input",r,!1),e(t.parseTableData(a)),()=>window.removeEventListener("input",r)}))}function v(e){return e("jaro-winkler")}function w(e,t){return e.createComparisonRows(t)}function E(e){return{first_name:e.jaroWinklerComparison,surname:e.jaroWinklerComparison,postcode:e.levenshteinComparison,gender:e.exactMatchComparison}}function x(e,t,a){return e.applyComparisonFunctions(t,a)}function j(e){return e.tutorial_partial_match_weights_settings}function k(e,t){return e.settingsToPartialMatchWeightsData(t)}function A(e,t,a){return e.setBarIsActive(t,a[0])}function q(e){return e("vega-embed@6")}function N(e,t,a){return e(`${t}?${a}${Date.now()}`)}function $(e){return e("@robinl/record_linkage_javascript_utilities@0.0.7")}function I(){return"http://127.0.0.1:8889/bundle.js"}function F(e,t){const a=e.module();return a.variable(t()).define(["md"],c),a.variable(t("viewof refresh")).define("viewof refresh",["Inputs"],m),a.variable(t("refresh")).define("refresh",["Generators","viewof refresh"],((e,t)=>e.input(t))),a.variable(t("input_table")).define("input_table",["html"],_),a.variable(t("partial_match_weights_highligh")).define("partial_match_weights_highligh",["embed","rlju","partial_match_weight_chart_data_raw_with_barisactive"],d),a.variable(t("text_activated_categories")).define("text_activated_categories",["waterfall_data","html"],p),a.variable(t("waterfall_highlight")).define("waterfall_highlight",["rlju","tutorial_settings","comparison_vector","embed"],h),a.variable(t("waterfall_as_formula")).define("waterfall_as_formula",["waterfall_data","tex"],u),a.variable(t("probability_formula")).define("probability_formula",["waterfall_data","tex"],f),a.variable(t("waterfall_data")).define("waterfall_data",["rlju","tutorial_settings","comparison_vector"],b),a.variable(t()).define(["rlju","tutorial_settings","comparison_vector"],g),a.variable(t("tableData")).define("tableData",["Generators","rlju","input_table"],y),a.variable(t("jaro_winkler")).define("jaro_winkler",["require"],v),a.variable(t("comparison_pairs")).define("comparison_pairs",["rlju","tableData"],w),a.variable(t("comparison_functions")).define("comparison_functions",["rlju"],E),a.variable(t("comparison_vector")).define("comparison_vector",["rlju","comparison_pairs","comparison_functions"],x),a.variable(t("tutorial_settings")).define("tutorial_settings",["rlju"],j),a.variable(t("partial_match_weight_chart_data_raw")).define("partial_match_weight_chart_data_raw",["rlju","tutorial_settings"],k),a.variable(t("partial_match_weight_chart_data_raw_with_barisactive")).define("partial_match_weight_chart_data_raw_with_barisactive",["rlju","partial_match_weight_chart_data_raw","comparison_vector"],A),a.variable(t("embed")).define("embed",["require"],q),a.variable(t("rlju2")).define("rlju2",["require","localUrl","refresh"],N),a.variable(t("rlju")).define("rlju",["require"],$),a.variable(t("localUrl")).define("localUrl",I),a}var W=a(1237),T=JSON.parse('{"config":{"view":{"continuousWidth":400,"continuousHeight":300,"discreteHeight":60,"discreteWidth":400},"header":{"title":null},"mark":{"tooltip":null},"title":{"anchor":"middle"}},"vconcat":[{"mark":{"type":"bar","clip":true,"height":15},"encoding":{"color":{"field":"log2_bayes_factor","legend":null,"scale":{"domain":[-10,0,10],"interpolate":"lab","range":["red","#bbbbbb","green"]},"title":"Match weight","type":"quantitative"},"tooltip":[{"field":"comparison_name","title":"Comparison name","type":"nominal"},{"field":"probability_two_random_records_match","format":".4f","title":"Probability two random records match","type":"nominal"},{"field":"log2_bayes_factor","format":",.4f","title":"Equivalent match weight","type":"quantitative"},{"field":"bayes_factor_description","title":"Match weight description","type":"nominal"}],"x":{"axis":{"domain":false,"labels":false,"ticks":false,"title":""},"field":"log2_bayes_factor","scale":{"domain":[-20,20]},"type":"quantitative"},"y":{"axis":{"title":"Prior (starting) match weight","titleAlign":"right","titleAngle":0,"titleFontWeight":"normal"},"field":"label_for_charts","sort":{"field":"comparison_vector_value","order":"descending"},"type":"nominal"}},"height":20,"transform":[{"filter":"(datum.comparison_name == \'probability_two_random_records_match\')"}]},{"mark":{"type":"bar","clip":true},"encoding":{"color":{"field":"log2_bayes_factor","scale":{"domain":[-10,0,10],"interpolate":"lab","range":["red","#bbbbbb","green"]},"title":"Match weight","type":"quantitative"},"row":{"field":"comparison_name","header":{"labelAlign":"left","labelAnchor":"middle","labelAngle":0},"sort":{"field":"comparison_sort_order"},"type":"nominal"},"tooltip":[{"field":"comparison_name","title":"Comparison name","type":"nominal"},{"field":"label_for_charts","title":"Label","type":"ordinal"},{"field":"sql_condition","title":"SQL condition","type":"nominal"},{"field":"m_probability","format":".4f","title":"M probability","type":"quantitative"},{"field":"u_probability","format":".4f","title":"U probability","type":"quantitative"},{"field":"bayes_factor","format":",.4f","title":"Bayes factor = m/u","type":"quantitative"},{"field":"log2_bayes_factor","format":",.4f","title":"Match weight = log2(m/u)","type":"quantitative"},{"field":"bayes_factor_description","title":"Match weight description","type":"nominal"}],"x":{"axis":{"title":"Comparison level match weight = log2(m/u)"},"field":"log2_bayes_factor","scale":{"domain":[-20,20]},"type":"quantitative"},"y":{"axis":{"title":null},"field":"label_for_charts","sort":{"field":"comparison_vector_value","order":"descending"},"type":"nominal"}},"height":{"step":12},"resolve":{"axis":{"y":"independent"},"scale":{"y":"independent"}},"transform":[{"filter":"(datum.comparison_name != \'probability_two_random_records_match\')"}]}],"data":{"name":"mydata"},"datasets":{"mydata":[{"comparison_name":"probability_two_random_records_match","sql_condition":null,"label_for_charts":"","m_probability":null,"u_probability":null,"m_probability_description":null,"u_probability_description":null,"has_tf_adjustments":false,"tf_adjustment_column":null,"tf_adjustment_weight":null,"is_null_level":false,"bayes_factor":0.000001000001000001,"log2_bayes_factor":-19.931567126628412,"comparison_vector_value":0,"max_comparison_vector_value":0,"bayes_factor_description":"The probability that two random records drawn at random match is 0.000 or one in  1,000,000.0 records.This is equivalent to a starting match weight of -19.932.","probability_two_random_records_match":0.000001,"comparison_sort_order":-1},{"comparison_name":"first_name","sql_condition":"\\"first_name_l\\" = \\"first_name_r\\"","label_for_charts":"Exact match","m_probability":0.85,"u_probability":0.005666151471395701,"m_probability_description":"Amongst matching record comparisons, 85.00% of records are in the exact match comparison level","u_probability_description":"Amongst non-matching record comparisons, 0.57% of records are in the exact match comparison level","has_tf_adjustments":false,"tf_adjustment_column":null,"tf_adjustment_weight":1,"is_null_level":false,"bayes_factor":150.01363876187128,"log2_bayes_factor":7.228949861693366,"comparison_vector_value":2,"max_comparison_vector_value":2,"bayes_factor_description":"If comparison level is `exact match` then comparison is 150.01 times more likely to be a match","probability_two_random_records_match":0.000001,"comparison_sort_order":0},{"comparison_name":"first_name","sql_condition":"jaro_similarity(\\"first_name_l\\", \\"first_name_r\\") >= 0.9","label_for_charts":"Jaro_similarity >= 0.9","m_probability":0.05,"u_probability":0.0007658173418514942,"m_probability_description":"Amongst matching record comparisons, 5.00% of records are in the jaro_similarity >= 0.9 comparison level","u_probability_description":"Amongst non-matching record comparisons, 0.08% of records are in the jaro_similarity >= 0.9 comparison level","has_tf_adjustments":false,"tf_adjustment_column":null,"tf_adjustment_weight":1,"is_null_level":false,"bayes_factor":65.28972023422251,"log2_bayes_factor":6.028783954429782,"comparison_vector_value":1,"max_comparison_vector_value":2,"bayes_factor_description":"If comparison level is `jaro_similarity >= 0.9` then comparison is 65.29 times more likely to be a match","probability_two_random_records_match":0.000001,"comparison_sort_order":0},{"comparison_name":"first_name","sql_condition":"ELSE","label_for_charts":"All other comparisons","m_probability":0.1,"u_probability":0.9935680311867529,"m_probability_description":"Amongst matching record comparisons, 10.00% of records are in the all other comparisons comparison level","u_probability_description":"Amongst non-matching record comparisons, 99.36% of records are in the all other comparisons comparison level","has_tf_adjustments":false,"tf_adjustment_column":null,"tf_adjustment_weight":1,"is_null_level":false,"bayes_factor":0.10064736068506196,"log2_bayes_factor":-3.312618754486011,"comparison_vector_value":0,"max_comparison_vector_value":2,"bayes_factor_description":"If comparison level is `all other comparisons` then comparison is  9.94 times less likely to be a match","probability_two_random_records_match":0.000001,"comparison_sort_order":0},{"comparison_name":"surname","sql_condition":"\\"surname_l\\" = \\"surname_r\\"","label_for_charts":"Exact match","m_probability":0.8,"u_probability":0.0004781954661494436,"m_probability_description":"Amongst matching record comparisons, 80.00% of records are in the exact match comparison level","u_probability_description":"Amongst non-matching record comparisons, 0.05% of records are in the exact match comparison level","has_tf_adjustments":false,"tf_adjustment_column":null,"tf_adjustment_weight":1,"is_null_level":false,"bayes_factor":1672.9560538116593,"log2_bayes_factor":10.708183832978756,"comparison_vector_value":2,"max_comparison_vector_value":2,"bayes_factor_description":"If comparison level is `exact match` then comparison is 1,672.96 times more likely to be a match","probability_two_random_records_match":0.000001,"comparison_sort_order":1},{"comparison_name":"surname","sql_condition":"jaro_similarity(\\"surname_l\\", \\"surname_r\\") >= 0.9","label_for_charts":"Jaro_similarity >= 0.9","m_probability":0.15,"u_probability":0.00020478774447207112,"m_probability_description":"Amongst matching record comparisons, 15.00% of records are in the jaro_similarity >= 0.9 comparison level","u_probability_description":"Amongst non-matching record comparisons, 0.02% of records are in the jaro_similarity >= 0.9 comparison level","has_tf_adjustments":false,"tf_adjustment_column":null,"tf_adjustment_weight":1,"is_null_level":false,"bayes_factor":732.4657068062827,"log2_bayes_factor":9.51661740558447,"comparison_vector_value":1,"max_comparison_vector_value":2,"bayes_factor_description":"If comparison level is `jaro_similarity >= 0.9` then comparison is 732.47 times more likely to be a match","probability_two_random_records_match":0.000001,"comparison_sort_order":1},{"comparison_name":"surname","sql_condition":"ELSE","label_for_charts":"All other comparisons","m_probability":0.05,"u_probability":0.9993170167893785,"m_probability_description":"Amongst matching record comparisons, 5.00% of records are in the all other comparisons comparison level","u_probability_description":"Amongst non-matching record comparisons, 99.93% of records are in the all other comparisons comparison level","has_tf_adjustments":false,"tf_adjustment_column":null,"tf_adjustment_weight":1,"is_null_level":false,"bayes_factor":0.05003417249977469,"log2_bayes_factor":-4.320942421758961,"comparison_vector_value":0,"max_comparison_vector_value":2,"bayes_factor_description":"If comparison level is `all other comparisons` then comparison is  19.99 times less likely to be a match","probability_two_random_records_match":0.000001,"comparison_sort_order":1},{"comparison_name":"postcode","sql_condition":"\\"postcode_l\\" = \\"postcode_r\\"","label_for_charts":"Exact match","m_probability":0.3,"u_probability":0.00002912586012305676,"m_probability_description":"Amongst matching record comparisons, 30.00% of records are in the exact match comparison level","u_probability_description":"Amongst non-matching record comparisons, 0.00% of records are in the exact match comparison level","has_tf_adjustments":false,"tf_adjustment_column":null,"tf_adjustment_weight":1,"is_null_level":false,"bayes_factor":10300.125,"log2_bayes_factor":13.330374225286665,"comparison_vector_value":2,"max_comparison_vector_value":2,"bayes_factor_description":"If comparison level is `exact match` then comparison is 10,300.12 times more likely to be a match","probability_two_random_records_match":0.000001,"comparison_sort_order":2},{"comparison_name":"postcode","sql_condition":"levenshtein(\\"postcode_l\\", \\"postcode_r\\") <= 1","label_for_charts":"Levenshtein <= 1","m_probability":0.3,"u_probability":0.00006431960777175035,"m_probability_description":"Amongst matching record comparisons, 30.00% of records are in the levenshtein <= 1 comparison level","u_probability_description":"Amongst non-matching record comparisons, 0.01% of records are in the levenshtein <= 1 comparison level","has_tf_adjustments":false,"tf_adjustment_column":null,"tf_adjustment_weight":1,"is_null_level":false,"bayes_factor":4664.207547169811,"log2_bayes_factor":12.187416271444622,"comparison_vector_value":1,"max_comparison_vector_value":2,"bayes_factor_description":"If comparison level is `levenshtein <= 1` then comparison is 4,664.21 times more likely to be a match","probability_two_random_records_match":0.000001,"comparison_sort_order":2},{"comparison_name":"postcode","sql_condition":"ELSE","label_for_charts":"All other comparisons","m_probability":0.4,"u_probability":0.9999065545321052,"m_probability_description":"Amongst matching record comparisons, 40.00% of records are in the all other comparisons comparison level","u_probability_description":"Amongst non-matching record comparisons, 99.99% of records are in the all other comparisons comparison level","has_tf_adjustments":false,"tf_adjustment_column":null,"tf_adjustment_weight":1,"is_null_level":false,"bayes_factor":0.40003738168030656,"log2_bayes_factor":-1.321793275274998,"comparison_vector_value":0,"max_comparison_vector_value":2,"bayes_factor_description":"If comparison level is `all other comparisons` then comparison is  2.50 times less likely to be a match","probability_two_random_records_match":0.000001,"comparison_sort_order":2},{"comparison_name":"gender","sql_condition":"\\"gender_l\\" = \\"gender_r\\"","label_for_charts":"Exact match","m_probability":0.995,"u_probability":0.7073805470837176,"m_probability_description":"Amongst matching record comparisons, 99.50% of records are in the exact match comparison level","u_probability_description":"Amongst non-matching record comparisons, 70.74% of records are in the exact match comparison level","has_tf_adjustments":false,"tf_adjustment_column":null,"tf_adjustment_weight":1,"is_null_level":false,"bayes_factor":1.4065979112686047,"log2_bayes_factor":0.4922099800861225,"comparison_vector_value":1,"max_comparison_vector_value":1,"bayes_factor_description":"If comparison level is `exact match` then comparison is 1.41 times more likely to be a match","probability_two_random_records_match":0.000001,"comparison_sort_order":3},{"comparison_name":"gender","sql_condition":"ELSE","label_for_charts":"All other comparisons","m_probability":0.005,"u_probability":0.2926194529162825,"m_probability_description":"Amongst matching record comparisons, 0.50% of records are in the all other comparisons comparison level","u_probability_description":"Amongst non-matching record comparisons, 29.26% of records are in the all other comparisons comparison level","has_tf_adjustments":false,"tf_adjustment_column":null,"tf_adjustment_weight":1,"is_null_level":false,"bayes_factor":0.017087038985854727,"log2_bayes_factor":-5.870953775823034,"comparison_vector_value":0,"max_comparison_vector_value":1,"bayes_factor_description":"If comparison level is `all other comparisons` then comparison is  58.52 times less likely to be a match","probability_two_random_records_match":0.000001,"comparison_sort_order":3}]},"params":[{"name":"mouse_zoom","select":{"type":"interval","encodings":["x"]},"bind":"scales","views":[]}],"resolve":{"axis":{"y":"independent"},"scale":{"y":"independent"}},"title":"Partial match weights","$schema":"https://vega.github.io/schema/vega-lite/v5.9.3.json"}'),M=JSON.parse('{"config":{"view":{"continuousWidth":400,"continuousHeight":300,"discreteHeight":60,"discreteWidth":400},"header":{"title":null},"mark":{"tooltip":null},"title":{"anchor":"middle"}},"vconcat":[{"mark":{"type":"bar","clip":true},"encoding":{"color":{"field":"log2_bayes_factor","scale":{"domain":[-10,0,10],"interpolate":"lab","range":["red","#bbbbbb","green"]},"title":"Match weight","type":"quantitative","legend":null},"row":{"field":"comparison_name","header":{"labelAlign":"left","labelAnchor":"middle","labelAngle":0},"sort":{"field":"comparison_sort_order"},"type":"nominal"},"tooltip":[{"field":"comparison_name","title":"Comparison name","type":"nominal"},{"field":"label_for_charts","title":"Label","type":"ordinal"},{"field":"sql_condition","title":"SQL condition","type":"nominal"},{"field":"m_probability","format":".4f","title":"M probability","type":"quantitative"},{"field":"u_probability","format":".4f","title":"U probability","type":"quantitative"},{"field":"bayes_factor","format":",.4f","title":"Bayes factor = m/u","type":"quantitative"},{"field":"log2_bayes_factor","format":",.4f","title":"Match weight = log2(m/u)","type":"quantitative"},{"field":"bayes_factor_description","title":"Match weight description","type":"nominal"}],"x":{"axis":{"title":"Partial match"},"field":"log2_bayes_factor","scale":{"domain":[-20,20]},"type":"quantitative"},"y":{"axis":{"title":null},"field":"label_for_charts","sort":{"field":"comparison_vector_value","order":"descending"},"type":"nominal"}},"height":{"step":12},"resolve":{"axis":{"y":"independent"},"scale":{"y":"independent"}},"transform":[{"filter":"(datum.comparison_name != \'probability_two_random_records_match\')"}]}],"data":{"name":"mydata"},"datasets":{"mydata":[{"comparison_name":"first_name","sql_condition":"\\"first_name_l\\" = \\"first_name_r\\"","label_for_charts":"Exact match","m_probability":0.85,"u_probability":0.005666151471395701,"m_probability_description":"Amongst matching record comparisons, 85.00% of records are in the exact match comparison level","u_probability_description":"Amongst non-matching record comparisons, 0.57% of records are in the exact match comparison level","has_tf_adjustments":false,"tf_adjustment_column":null,"tf_adjustment_weight":1,"is_null_level":false,"bayes_factor":150.01363876187128,"log2_bayes_factor":7.228949861693366,"comparison_vector_value":2,"max_comparison_vector_value":2,"bayes_factor_description":"If comparison level is `exact match` then comparison is 150.01 times more likely to be a match","probability_two_random_records_match":0.000001,"comparison_sort_order":0},{"comparison_name":"first_name","sql_condition":"jaro_similarity(\\"first_name_l\\", \\"first_name_r\\") >= 0.9","label_for_charts":"Jaro_similarity >= 0.9","m_probability":0.05,"u_probability":0.0007658173418514942,"m_probability_description":"Amongst matching record comparisons, 5.00% of records are in the jaro_similarity >= 0.9 comparison level","u_probability_description":"Amongst non-matching record comparisons, 0.08% of records are in the jaro_similarity >= 0.9 comparison level","has_tf_adjustments":false,"tf_adjustment_column":null,"tf_adjustment_weight":1,"is_null_level":false,"bayes_factor":65.28972023422251,"log2_bayes_factor":6.028783954429782,"comparison_vector_value":1,"max_comparison_vector_value":2,"bayes_factor_description":"If comparison level is `jaro_similarity >= 0.9` then comparison is 65.29 times more likely to be a match","probability_two_random_records_match":0.000001,"comparison_sort_order":0},{"comparison_name":"first_name","sql_condition":"ELSE","label_for_charts":"All other comparisons","m_probability":0.1,"u_probability":0.9935680311867529,"m_probability_description":"Amongst matching record comparisons, 10.00% of records are in the all other comparisons comparison level","u_probability_description":"Amongst non-matching record comparisons, 99.36% of records are in the all other comparisons comparison level","has_tf_adjustments":false,"tf_adjustment_column":null,"tf_adjustment_weight":1,"is_null_level":false,"bayes_factor":0.10064736068506196,"log2_bayes_factor":-3.312618754486011,"comparison_vector_value":0,"max_comparison_vector_value":2,"bayes_factor_description":"If comparison level is `all other comparisons` then comparison is  9.94 times less likely to be a match","probability_two_random_records_match":0.000001,"comparison_sort_order":0}]},"params":[{"name":"mouse_zoom","select":{"type":"interval","encodings":["x"]},"bind":"scales","views":[]}],"resolve":{"axis":{"y":"independent"},"scale":{"y":"independent"}},"title":"Partial match weights for first name","$schema":"https://vega.github.io/schema/vega-lite/v5.9.3.json"}'),L=a(1508);const C=e=>o.createElement(i.H,{frontmatter:e.pageContext.frontmatter});function P(e){const t=Object.assign({h1:"h1",p:"p",sup:"sup",a:"a",h2:"h2",ul:"ul",li:"li",h3:"h3",ol:"ol",code:"code",pre:"pre",section:"section"},(0,r.ah)(),e.components);return o.createElement(o.Fragment,null,o.createElement(t.h1,null,"Partial Match Weights"),"\n",o.createElement(t.p,null,"In the previous article we saw that the Fellegi-Sunter model makes its predictions with a simple calculation: the sum of the ",o.createElement(L.Z,{term:"partial_match_weight"}),"s."),"\n",o.createElement(t.p,null,"But what are partial match weights and where do they come from?",o.createElement(t.sup,null,o.createElement(t.a,{href:"#user-content-fn-1",id:"user-content-fnref-1","data-footnote-ref":!0,"aria-describedby":"footnote-label"},"1"))),"\n",o.createElement(t.h2,null,"What are they?"),"\n",o.createElement(t.p,null,"Some columns are more important than others to the calculation of overall match probability.",o.createElement(t.sup,null,o.createElement(t.a,{href:"#user-content-fn-2",id:"user-content-fnref-2","data-footnote-ref":!0,"aria-describedby":"footnote-label"},"2")),"  This is quantified by the partial match weights."),"\n",o.createElement(t.p,null,"For example:"),"\n",o.createElement(t.ul,null,"\n",o.createElement(t.li,null,"A match on date of birth provides stronger evidence in favour of a match than a match on gender."),"\n",o.createElement(t.li,null,"A mismatch on date of birth may provide more evidence against a match than a mismatch on address (because people move house)."),"\n"),"\n",o.createElement(t.p,null,"Positive values indicate evidence in favour of a match whilst negative values mean evidence against a match."),"\n",o.createElement(t.p,null,"The concept applies more generally than just to matches and non-matches: partial match weights can be estimated for more subtle ",o.createElement(L.Z,{term:"scenario"}),"s like 'first name not an exact match, but similar'."),"\n",o.createElement(t.p,null,"It is up to the modeller to define these scenarios and the resultant partial match weights they wish to estimate."),"\n",o.createElement(t.h3,null,"Example:  First name column"),"\n",o.createElement(t.p,null,"For first name, we could define the following three scenarios:"),"\n",o.createElement(t.ol,null,"\n",o.createElement(t.li,null,"Exact match: First names are identical"),"\n",o.createElement(t.li,null,"Fuzzy match:  First names are similar according to the ",o.createElement(t.a,{href:"https://en.wikipedia.org/wiki/Jaro%E2%80%93Winkler_distance#Jaro%E2%80%93Winkler_similarity"},"Jaro Winkler")," measure"),"\n",o.createElement(t.li,null,"All other cases"),"\n"),"\n",o.createElement(t.p,null,"The estimated partial match weights may look like this:",o.createElement(t.sup,null,o.createElement(t.a,{href:"#user-content-fn-3",id:"user-content-fnref-3","data-footnote-ref":!0,"aria-describedby":"footnote-label"},"3"))),"\n",o.createElement(l.Z,{spec:M}),"\n",o.createElement(t.p,null,"Observe that:"),"\n",o.createElement(t.ul,null,"\n",o.createElement(t.li,null,"An exact match on first name provides stronger evidence in favour of a match than a fuzzy match"),"\n",o.createElement(t.li,null,"If the first name is completely different (neither and exact nor fuzzy match), this is evidence against the records being a match."),"\n"),"\n",o.createElement(t.p,null,"These scenarios are mutually exclusive, and are implemented like a sequence of ",o.createElement(t.code,null,"if")," statements:"),"\n",o.createElement(t.pre,null,o.createElement(t.code,{className:"language-python"},"if first_name_l == first_name_r:\n    first_name_partial_match_weight = 7.2\nelif jaro_winkler_sim(first_name_l, first_name_r) >= 0.9:\n    first_name_partial_match_weight = 5.9\nelse:\n    first_name_partial_match_weight = -3.3\n")),"\n",o.createElement(t.h3,null,"Remaining columns"),"\n",o.createElement(t.p,null,"We can also estimate partial match weights for the remaining columns."),"\n",o.createElement(t.p,null,"The number of scenarios modelled and the definition of these scenarios can vary depending on the type of information."),"\n",o.createElement(t.p,null,"For example, since gender is a categorical variable we'd likely have just two partial weights: match, and non-match."),"\n",o.createElement(t.p,null,"For date of birth, we may define three scenarios, but ",o.createElement(t.a,{href:"https://en.wikipedia.org/wiki/Levenshtein_distance"},"Levenshtein")," would be more suitable than ",o.createElement(t.a,{href:"https://en.wikipedia.org/wiki/Jaro%E2%80%93Winkler_distance"},"Jaro Winkler")," for assessing similarity."),"\n",o.createElement(t.p,null,"We can plot all the partial match weights in a single chart like this:"),"\n",o.createElement(l.Z,{spec:T}),"\n",o.createElement(t.p,null,"This provides a succinct summary of the whole model."),"\n",o.createElement(t.h2,null,"Intuitive interpretation of partial match weights"),"\n",o.createElement(t.p,null,"The partial match weights in the chart have intuitive interpretations."),"\n",o.createElement(t.p,null,"For example, the partial match weight associated with an exact match on postcode is stronger than the partial match weight associated with gender."),"\n",o.createElement(t.p,null,"This makes sense: a match on gender doesn't tell us much about whether two records are a match, whereas a match on postcode is much more informative."),"\n",o.createElement(t.p,null,"The pattern of negative partial match weights is also intuitive:  If gender is recorded as categorical variable, then it may be very accurate.  A mismatch would thus be strong evidence against a match."),"\n",o.createElement(t.p,null,"Conversely, a mismatch on postcode may offer little evidence against a match since people move house, or typos may have been made."),"\n",o.createElement(t.h2,null,"Understanding the partial match weight chart and waterfall chart"),"\n",o.createElement(t.p,null,"Let's take a look at an example record comparison, and see how the partial match weights are used."),"\n",o.createElement(W.Z,null,"You can edit the data in the below table to see how the calculation changes"),"\n",o.createElement(s.A5,{notebook:F},o.createElement(s.Gc,{cellName:"input_table"}),o.createElement(t.p,null,"The first stage is to calculate which scenarios apply for each column.  For example, are the first names an exact match, a fuzzy match, or neither?"),o.createElement(s.Gc,{cellName:"text_activated_categories"}),o.createElement(t.p,null,"In the below chart, I reproduce the partial match weights chart, but with the activated partial match weights highlighted."),o.createElement(s.Gc,{cellName:"partial_match_weights_highligh"}),o.createElement(t.p,null,"The activated (selected) partial match weights can then be plotted in a waterfall chart, which represents how they are summed up to compute the final match weight:"),o.createElement(s.Gc,{cellName:"waterfall_highlight"}),o.createElement(t.p,null,"Alternatively we can represent the calculation of overall match weight as a sum:"),o.createElement(s.Gc,{cellName:"waterfall_as_formula"}),o.createElement(t.p,null,"The final match weight is a measure of the similarity of the two records.  In subsequent articles we will see how it can be converted into a probability using the formula:"),o.createElement(s.Gc,{cellName:"probability_formula"})),"\n",o.createElement(t.h2,null,"Next steps"),"\n",o.createElement(t.p,null,"We now have a good qualitative understanding of the meaning of partial match weights."),"\n",o.createElement(t.p,null,"In the next article we explore how they are calculated, and how to interpret their values."),"\n",o.createElement(t.section,{"data-footnotes":!0,className:"footnotes"},o.createElement(t.h2,{className:"sr-only",id:"footnote-label"},"Footnotes"),"\n",o.createElement(t.ol,null,"\n",o.createElement(t.li,{id:"user-content-fn-1"},"\n",o.createElement(t.p,null,"In this context, the word 'partial' means 'using only a subset of the information in the record' - often a single column.  There is then a partial match weight for each column. ",o.createElement(t.a,{href:"#user-content-fnref-1","data-footnote-backref":!0,className:"data-footnote-backref","aria-label":"Back to content"},"↩")),"\n"),"\n",o.createElement(t.li,{id:"user-content-fn-2"},"\n",o.createElement(t.p,null,"In this article, for simplicity,  there's a one to one correspondence between columns and partial match weights. Each column is treated as a separate piece of information.  In reality, the model allows for more flexibility.  We could split a column (e.g. date of birth) into several pieces of information (e.g. day, month, year) and estimate partial match weights for each.  Or we could combine several columns (e.g. first, middle and surname) into a single piece of information and estimate a partial match weights for this information. ",o.createElement(t.a,{href:"#user-content-fnref-2","data-footnote-backref":!0,className:"data-footnote-backref","aria-label":"Back to content"},"↩")),"\n"),"\n",o.createElement(t.li,{id:"user-content-fn-3"},"\n",o.createElement(t.p,null,"A later article will explain how to estimate partial match weights.  Here I just assume they have already been estimated. ",o.createElement(t.a,{href:"#user-content-fnref-3","data-footnote-backref":!0,className:"data-footnote-backref","aria-label":"Back to content"},"↩")),"\n"),"\n"),"\n"))}var Z=function(e){return void 0===e&&(e={}),o.createElement(n.B,e,o.createElement(P,e))}},6702:function(e,t,a){var r=a(7294),o=a(4160);t.Z=e=>{var t,a,n,i,l,s;let{frontmatter:c}=e;const{tutorial_number:m}=c,_=(0,o.K2)("4236107564"),d=_.allMdx.edges.map((e=>e.node.frontmatter.tutorial_number)),p=d.includes(m-1),h=d.includes(m+1),u=null===(t=_.allMdx.edges.find((e=>e.node.frontmatter.tutorial_number===m-1)))||void 0===t||null===(a=t.node)||void 0===a||null===(n=a.fields)||void 0===n?void 0:n.slug,f=null===(i=_.allMdx.edges.find((e=>e.node.frontmatter.tutorial_number===m+1)))||void 0===i||null===(l=i.node)||void 0===l||null===(s=l.fields)||void 0===s?void 0:s.slug;return r.createElement("div",{className:"bg-gray-100 p-2 mt-2 mb-2 italic rounded-md text-gray-600 text-xs"},r.createElement("div",{className:"flex justify-between"},r.createElement("div",{className:"w-1/3 text-left"},p&&r.createElement(o.rU,{to:u,className:"text-blue-500 hover:underline"},"← Previous article")),r.createElement("div",{className:"w-1/3 text-center"},r.createElement("span",null,"This is part ",m," of the"," ",r.createElement(o.rU,{to:"/probabilistic_linkage",className:"text-blue-500 hover:underline"},"tutorial"))),r.createElement("div",{className:"w-1/3 text-right"},h&&r.createElement(o.rU,{to:f,className:"text-blue-500 hover:underline"},"Next article →"))))}},1237:function(e,t,a){var r=a(7294),o=a(2091);t.Z=e=>{let{children:t}=e;return r.createElement("div",{className:"bg-yellow-100 border-l-4 border-yellow-500 text-yellow-700 py-2 px-4 mb-4",role:"alert"},r.createElement("div",{className:"flex"},r.createElement("div",null,r.createElement(o.hWE,{className:"text-yellow-400 mr-4"})),r.createElement("div",null,r.createElement("p",{className:"mb-0"},t))))}},8342:function(e,t,a){a.d(t,{A5:function(){return _},Gc:function(){return m}});var r=a(7294),o=a(6493);const n=(0,r.createContext)(null),i="mdx-container-div",l=new o.Zu;Object.assign({},l,{width:s});function s(){return l.Generators.observe((e=>{let t=e(document.getElementById(i).clientWidth);function a(){let a=document.getElementById(i).clientWidth;a!==t&&e(t=a)}return window.addEventListener("resize",a),()=>window.removeEventListener("resize",a)}))}function c(e){let{notebook:t,children:a}=e;const{0:i,1:l}=(0,r.useState)({}),c=new o.r_(Object.assign({},new o.Zu,{width:s}));return(0,r.useEffect)((()=>(c.module(t,(e=>{if(i[e])return new o.lj(i[e])})),()=>c.dispose())),[c,i,t]),r.createElement(n.Provider,{value:{setSharedRefs:l}},a)}function m(e){let{cellName:t,styles:a,className:o}=e;const i=(0,r.useRef)(null),{setSharedRefs:l}=(0,r.useContext)(n);return(0,r.useEffect)((()=>{l((e=>({...e,[t]:i.current})))}),[t,l]),r.createElement("div",{ref:i,style:a,className:o})}function _(e){let{notebook:t,children:a}=e;return r.createElement(c,{notebook:t},a)}},6965:function(e,t,a){a.d(t,{B:function(){return l}});var r=a(7294),o=a(7848),n=a(2692),i=a(6702);function l(e){let{children:t,pageContext:a}=e;const{frontmatter:l}=a,s=()=>r.createElement("div",null,r.createElement(i.Z,{frontmatter:l}),t,r.createElement(n.Z,{frontmatter:l}));return r.createElement(o.ZP,{pageContext:a},r.createElement(s,null))}},2692:function(e,t,a){var r=a(7294),o=a(4160);t.Z=e=>{let{frontmatter:t}=e;const{tutorial_number:a,title:n}=t,i=(0,o.K2)("1842021157").allMdx.edges.sort(((e,t)=>e.node.frontmatter.tutorial_number-t.node.frontmatter.tutorial_number));return r.createElement("div",{className:"bg-blue-100  p-4 mt-8  mb-4 rounded-lg "},r.createElement("div",{className:"container mx-auto"},r.createElement("div",{className:"text-blue-800 font-semibold text-base mb-2"},r.createElement(o.rU,{to:"/probabilistic_linkage",className:"text-blue-500 hover:underline"},"Probabilistic Linkage Tutorial Navigation:")),r.createElement("ol",{className:"space-y-2 text-sm"},i.map((e=>r.createElement("li",{key:e.node.frontmatter.tutorial_number,className:"text-blue-600 text-sm"},a===e.node.frontmatter.tutorial_number?r.createElement("span",{className:"font-bold text-sm"},e.node.frontmatter.title):r.createElement(o.rU,{to:e.node.fields.slug,className:"hover:underline"},e.node.frontmatter.title)))))))}},8588:function(e,t,a){a.d(t,{Z:function(){return i}});var r=a(7294),o=a(2394);function n(){return n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e},n.apply(this,arguments)}function i(e){return r.createElement(o.Z,n({},e,{mode:"vega-lite"}))}}}]);
//# sourceMappingURL=component---src-mdx-partial-match-weights-mdx-b2ed475e5d19c41440ae.js.map