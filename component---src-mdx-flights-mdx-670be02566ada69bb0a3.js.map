{"version":3,"file":"component---src-mdx-flights-mdx-670be02566ada69bb0a3.js","mappings":"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","sources":["webpack://robinlinacre/./node_modules/@robinl/my-flights/fe522555ef506fc9@514.js","webpack://robinlinacre/./src/mdx/flights.mdx","webpack://robinlinacre/./src/components/ObservableNotebook.jsx","webpack://robinlinacre/./src/hooks/use-site-metadata.jsx","webpack://robinlinacre/./src/components/SEO.jsx"],"sourcesContent":["// https://observablehq.com/@robinl/my-flights@514\nfunction _title(md,diff_years,start_end_date){return(\nmd`# ${diff_years(\n  start_end_date[1],\n  start_end_date[0]\n)} years of flights`\n)}\n\nfunction _2(md){return(\nmd`A final version of this notebook can be viewed on my blog [here](https://www.robinlinacre.com/flights/).`\n)}\n\nfunction _blurb(md,format_date,start_end_date,routes,fmt_num,average_miles,total_miles,fmt_num_round,eu,tonnes_co2){return(\nmd`Between ${format_date(start_end_date[0])} and ${format_date(\n  start_end_date[1]\n)} I took ${routes.length} flights with and average distance of ${fmt_num(\n  average_miles\n)} miles, and total milage of ${fmt_num(\n  total_miles\n)}.  Total energy usage was around ${fmt_num_round(\n  eu.flying.flying_miles_to_kwh(total_miles)\n)} kwh or ${fmt_num_round(tonnes_co2)} tonnes of co2.\n\nYou can drag the globe below to rotate.`\n)}\n\nfunction _chart(DOM,width,height,d3,projection,sphere,land,routes,resample,colour_scale,drag)\n{\n  const context = DOM.context2d(width, height);\n  const path = d3.geoPath(projection, context);\n\n  function render() {\n    context.clearRect(0, 0, width, height);\n\n    context.beginPath(),\n      path(sphere),\n      (context.fillStyle = \"#fff\"),\n      context.fill();\n\n    context.beginPath(),\n      path(land),\n      (context.fillStyle = \"#000\"),\n      context.fill();\n\n    context.beginPath(), path(sphere), context.stroke();\n\n    routes.forEach(function(d) {\n      let coordinates = [\n        [d[\"lng_from\"], d[\"lat_from\"]],\n        [d[\"lng_to\"], d[\"lat_to\"]]\n      ];\n\n      let resampled = resample(coordinates);\n\n      let mid_point_with_drift = [\n        resampled[\"after\"][1][0] + d[\"random\"],\n        resampled[\"after\"][1][1] + d[\"random\"]\n      ];\n\n      resampled[\"after\"][1] = mid_point_with_drift;\n\n      let route = {\n        type: \"LineString\",\n        coordinates: resampled[\"after\"]\n      };\n      context.lineWidth = 1;\n      context.lineO;\n      context.beginPath(),\n        path(route),\n        (context.strokeStyle = colour_scale(d[\"date\"])),\n        context.stroke();\n    });\n\n    context.lineWidth = 1;\n    context.strokeStyle = \"#000000\";\n  }\n\n  return d3\n    .select(context.canvas)\n    .call(drag(projection).on(\"drag.render\", render))\n    .call(render)\n    .node();\n}\n\n\nfunction _projection(d3,width,height,sphere){return(\nd3\n  .geoOrthographic()\n  .fitExtent([[1, 1], [width - 1, height - 1]], sphere)\n  .translate([width / 2, height / 2])\n  .rotate([0, -51])\n  .precision(0.1)\n)}\n\nfunction _tonnes_co2(kwh_to_kg_co2,eu,total_miles){return(\nkwh_to_kg_co2(eu.flying.flying_miles_to_kwh(total_miles)) / 1000\n)}\n\nfunction _kwh_to_kg_co2(eu){return(\nfunction(kwh) {\n  return kwh * eu.convert.per(\"kg_co2_jet_fuel/kwh\");\n}\n)}\n\nfunction _total_miles(d3,routes){return(\nd3.sum(routes, d => d[\"distance\"])\n)}\n\nfunction _average_miles(d3,routes){return(\nd3.mean(routes, d => d[\"distance\"])\n)}\n\nfunction _eu(require){return(\nrequire(\"@robinl/energy_usage@0.0.34\")\n)}\n\nfunction _start_end_date(d3,routes){return(\nd3.extent(routes, d => d[\"date\"])\n)}\n\nfunction _fmt_num(d3){return(\nd3.format(\",.0f\")\n)}\n\nfunction _fmt_num_round(d3){return(\nd3.format(\",.2r\")\n)}\n\nfunction _diff_years(){return(\nfunction diff_years(dt2, dt1) {\n  var diff = (dt2.getTime() - dt1.getTime()) / 1000;\n  diff /= 60 * 60 * 24;\n  return Math.abs(Math.round(diff / 365.25));\n}\n)}\n\nfunction _format_date(){return(\nd => d.toISOString().split('T')[0]\n)}\n\nfunction _colour_scale(d3,routes){return(\nd3\n  .scaleSequential(d3.interpolateOrRd)\n  .domain(d3.extent(routes, d => d[\"date\"]))\n)}\n\nfunction _resample(projection,d3){return(\nfunction resample(coordinates) {\n  var i = 0,\n    n = coordinates.length,\n    before = [],\n    after = [];\n  while (++i < n) {\n    var c0 = coordinates[i - 1].slice(),\n      c1 = coordinates[i].slice(),\n      p0 = projection(c0),\n      p1 = projection(c1),\n      x10 = p1[0] - p0[0],\n      y10 = p1[1] - p0[1],\n      d1 = x10 * x10 + y10 * y10;\n    before.push(c0);\n    after.push(c0);\n    if (d1 > 4 * .1) {\n      // linear distance check\n      var c2 = d3.geoInterpolate(c0, c1)(.5),\n        p2 = projection(c2),\n        x20 = p2[0] - p0[0],\n        y20 = p2[1] - p0[1],\n        dz = y10 * x20 - x10 * y20;\n      if ((dz * dz) / d1 > .1) {\n        // perpendicular distance check\n        var t = (x20 * x10 + y20 * y10) / d1;\n        before.push(\n          projection.invert((c2.resampled = [p0[0] + t * x10, p0[1] + t * y10]))\n        );\n        after.push(c2);\n      }\n    }\n  }\n  if (n) before.push(c1), after.push(c1);\n  return { before: before, after: after };\n}\n)}\n\nfunction _drag(versor,d3){return(\nfunction drag(projection) {\n  let v0, q0, r0;\n  \n  function dragstarted() {\n    v0 = versor.cartesian(projection.invert(d3.mouse(this)));\n    q0 = versor(r0 = projection.rotate());\n  }\n  \n  function dragged() {\n    const v1 = versor.cartesian(projection.rotate(r0).invert(d3.mouse(this)));\n    const q1 = versor.multiply(q0, versor.delta(v0, v1));\n    projection.rotate(versor.rotation(q1));\n  }\n  \n  return d3.drag()\n      .on(\"start\", dragstarted)\n      .on(\"drag\", dragged);\n}\n)}\n\nfunction _height(width){return(\nwidth\n)}\n\nfunction _sphere(){return(\n{type: \"Sphere\"}\n)}\n\nfunction _land(topojson,world){return(\ntopojson.feature(world, world.objects.land)\n)}\n\nfunction _world(d3){return(\nd3.json(\"https://unpkg.com/world-atlas@1/world/110m.json\")\n)}\n\nfunction _versor(require){return(\nrequire(\"versor@0.0.3\")\n)}\n\nfunction _topojson(require){return(\nrequire(\"topojson-client@3\")\n)}\n\nfunction _d3(require){return(\nrequire(\"d3@5\")\n)}\n\nfunction _routes_raw(d3){return(\nd3.csv(\"https://gist.githubusercontent.com/RobinL/ba3acbf42349115ed266a98643eb5a80/raw/a603b1fec071383d6a3eb27cbcda789c54cb0014/my_flights.csv\", d3.autoType)\n)}\n\nfunction _routes(routes_raw){return(\nroutes_raw.map(d => {\n  d[\"random\"] = ((Math.random() - 0.5) * d[\"distance\"]) / 1000;\n  return d;\n})\n)}\n\nexport default function define(runtime, observer) {\n  const main = runtime.module();\n  main.variable(observer(\"title\")).define(\"title\", [\"md\",\"diff_years\",\"start_end_date\"], _title);\n  main.variable(observer()).define([\"md\"], _2);\n  main.variable(observer(\"blurb\")).define(\"blurb\", [\"md\",\"format_date\",\"start_end_date\",\"routes\",\"fmt_num\",\"average_miles\",\"total_miles\",\"fmt_num_round\",\"eu\",\"tonnes_co2\"], _blurb);\n  main.variable(observer(\"chart\")).define(\"chart\", [\"DOM\",\"width\",\"height\",\"d3\",\"projection\",\"sphere\",\"land\",\"routes\",\"resample\",\"colour_scale\",\"drag\"], _chart);\n  main.variable(observer(\"projection\")).define(\"projection\", [\"d3\",\"width\",\"height\",\"sphere\"], _projection);\n  main.variable(observer(\"tonnes_co2\")).define(\"tonnes_co2\", [\"kwh_to_kg_co2\",\"eu\",\"total_miles\"], _tonnes_co2);\n  main.variable(observer(\"kwh_to_kg_co2\")).define(\"kwh_to_kg_co2\", [\"eu\"], _kwh_to_kg_co2);\n  main.variable(observer(\"total_miles\")).define(\"total_miles\", [\"d3\",\"routes\"], _total_miles);\n  main.variable(observer(\"average_miles\")).define(\"average_miles\", [\"d3\",\"routes\"], _average_miles);\n  main.variable(observer(\"eu\")).define(\"eu\", [\"require\"], _eu);\n  main.variable(observer(\"start_end_date\")).define(\"start_end_date\", [\"d3\",\"routes\"], _start_end_date);\n  main.variable(observer(\"fmt_num\")).define(\"fmt_num\", [\"d3\"], _fmt_num);\n  main.variable(observer(\"fmt_num_round\")).define(\"fmt_num_round\", [\"d3\"], _fmt_num_round);\n  main.variable(observer(\"diff_years\")).define(\"diff_years\", _diff_years);\n  main.variable(observer(\"format_date\")).define(\"format_date\", _format_date);\n  main.variable(observer(\"colour_scale\")).define(\"colour_scale\", [\"d3\",\"routes\"], _colour_scale);\n  main.variable(observer(\"resample\")).define(\"resample\", [\"projection\",\"d3\"], _resample);\n  main.variable(observer(\"drag\")).define(\"drag\", [\"versor\",\"d3\"], _drag);\n  main.variable(observer(\"height\")).define(\"height\", [\"width\"], _height);\n  main.variable(observer(\"sphere\")).define(\"sphere\", _sphere);\n  main.variable(observer(\"land\")).define(\"land\", [\"topojson\",\"world\"], _land);\n  main.variable(observer(\"world\")).define(\"world\", [\"d3\"], _world);\n  main.variable(observer(\"versor\")).define(\"versor\", [\"require\"], _versor);\n  main.variable(observer(\"topojson\")).define(\"topojson\", [\"require\"], _topojson);\n  main.variable(observer(\"d3\")).define(\"d3\", [\"require\"], _d3);\n  main.variable(observer(\"routes_raw\")).define(\"routes_raw\", [\"d3\"], _routes_raw);\n  main.variable(observer(\"routes\")).define(\"routes\", [\"routes_raw\"], _routes);\n  return main;\n}\n","/*@jsxRuntime classic @jsx React.createElement @jsxFrag React.Fragment*/\nimport React from \"react\";\nimport {MDXLayout} from \"../components/MDXLayout\";\nimport {SEO} from \"../components/SEO\";\nexport const Head = props => React.createElement(SEO, {\n  frontmatter: props.pageContext.frontmatter\n});\nimport notebook from '@robinl/my-flights';\nimport ObservableNotebook from '../components/ObservableNotebook';\nexport const output_order = ['title', 'blurb', 'chart'];\nfunction _createMdxContent(props) {\n  return React.createElement(ObservableNotebook, {\n    notebook: notebook,\n    cells: output_order\n  });\n}\nfunction MDXContent(props = {}) {\n  return React.createElement(MDXLayout, props, React.createElement(_createMdxContent, props));\n}\nexport default MDXContent;\n","import React, { useRef, useEffect } from 'react';\nimport { Runtime, Inspector, Library } from '@observablehq/runtime';\n\nconst mountId = 'mdx-container-div';\n\nconst stdlib = new Library();\n\nconst library = Object.assign({}, stdlib, { width: width_mdx });\n\nfunction width_mdx() {\n    return stdlib.Generators.observe(notify => {\n        let width1 = notify(document.getElementById(mountId).clientWidth);\n        function resized() {\n            let width2 = document.getElementById(mountId).clientWidth;\n            if (width2 !== width1) notify((width1 = width2));\n        }\n\n        window.addEventListener('resize', resized);\n        return () => window.removeEventListener('resize', resized);\n    });\n}\n\nfunction ObservableNotebook({ notebook, cells, customClassName }) {\n    const refs = useRef(cells.map(() => React.createRef()));\n\n    useEffect(() => {\n        const runtime = new Runtime(library);\n        runtime.module(notebook, name => {\n            const index = cells.indexOf(name);\n            if (index !== -1) {\n                return new Inspector(refs.current[index].current);\n            }\n        });\n        return () => runtime.dispose();\n    }, [notebook, cells]);\n\n    return (\n        <div className={customClassName}>\n            {refs.current.map((ref, index) => (\n                <div key={index} ref={ref} />\n            ))}\n        </div>\n    );\n}\n\nexport default ObservableNotebook;\n","import { graphql, useStaticQuery } from 'gatsby';\n\nexport const useSiteMetadata = () => {\n    const data = useStaticQuery(graphql`\n        query {\n            site {\n                siteMetadata {\n                    title\n                    description\n                    twitterUsername\n                    image\n                    siteUrl\n                }\n            }\n        }\n    `);\n\n    return data.site.siteMetadata;\n};\n","import React from 'react';\nimport { useSiteMetadata } from '../hooks/use-site-metadata';\n\nexport const SEO = ({ frontmatter }) => {\n    const {\n        title: defaultTitle,\n        description: defaultDescription,\n        image,\n        siteUrl,\n        twitterUsername,\n    } = useSiteMetadata();\n\n    const seo = {\n        title: frontmatter?.title || defaultTitle,\n        description: frontmatter?.description || defaultDescription,\n        image: `${siteUrl}${frontmatter?.image || image}`,\n        url: `${siteUrl}${frontmatter?.pathname || ``}`,\n        twitterUsername,\n        ...frontmatter,\n    };\n\n    const stylesheetLink = frontmatter?.stylesheet;\n\n    return (\n        <>\n            <title>{seo.title}</title>\n            <meta name=\"description\" content={seo.description} />\n            <meta name=\"image\" content={seo.image} />\n            {stylesheetLink && (\n                <link\n                    rel=\"stylesheet\"\n                    type=\"text/css\"\n                    href={`/styles/${stylesheetLink}`}\n                />\n            )}\n        </>\n    );\n};\n"],"names":["_title","md","diff_years","start_end_date","_2","_blurb","format_date","routes","fmt_num","average_miles","total_miles","fmt_num_round","eu","tonnes_co2","length","flying","flying_miles_to_kwh","_chart","DOM","width","height","d3","projection","sphere","land","resample","colour_scale","drag","context","context2d","path","geoPath","render","clearRect","beginPath","fillStyle","fill","stroke","forEach","d","coordinates","resampled","mid_point_with_drift","route","type","lineWidth","lineO","strokeStyle","select","canvas","call","on","node","_projection","geoOrthographic","fitExtent","translate","rotate","precision","_tonnes_co2","kwh_to_kg_co2","_kwh_to_kg_co2","kwh","convert","per","_total_miles","sum","_average_miles","mean","_eu","require","_start_end_date","extent","_fmt_num","format","_fmt_num_round","_diff_years","dt2","dt1","diff","getTime","Math","abs","round","_format_date","toISOString","split","_colour_scale","scaleSequential","interpolateOrRd","domain","_resample","i","n","before","after","c0","slice","c1","p0","p1","x10","y10","d1","push","c2","geoInterpolate","p2","x20","y20","dz","t","invert","_drag","versor","v0","q0","r0","cartesian","mouse","this","v1","q1","multiply","delta","rotation","_height","_sphere","_land","topojson","world","feature","objects","_world","json","_versor","_topojson","_d3","_routes_raw","csv","autoType","_routes","routes_raw","map","random","runtime","observer","main","module","variable","define","Head","props","React","SEO","frontmatter","pageContext","output_order","_createMdxContent","ObservableNotebook","notebook","cells","MDXLayout","mountId","stdlib","Library","library","Object","assign","Generators","observe","notify","width1","document","getElementById","clientWidth","resized","width2","window","addEventListener","removeEventListener","_ref","customClassName","refs","useRef","useEffect","Runtime","name","index","indexOf","Inspector","current","dispose","className","ref","key","title","defaultTitle","description","defaultDescription","image","siteUrl","twitterUsername","useStaticQuery","site","siteMetadata","seo","url","pathname","stylesheetLink","stylesheet","content","rel","href"],"sourceRoot":""}