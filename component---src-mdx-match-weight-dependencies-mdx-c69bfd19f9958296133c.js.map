{"version":3,"file":"component---src-mdx-match-weight-dependencies-mdx-c69bfd19f9958296133c.js","mappings":"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","sources":["webpack://robinlinacre/./node_modules/@robinl/dependencies-between-match-weights/817db6818ab226c0@104.js","webpack://robinlinacre/./node_modules/@robinl/dependencies-between-match-weights/34fd4ef09fb0509a@2296.js","webpack://robinlinacre/./node_modules/@robinl/dependencies-between-match-weights/9547bc35da079fbb@158.js","webpack://robinlinacre/./src/mdx/match_weight_dependencies.mdx","webpack://robinlinacre/./src/components/ObservableNotebook.jsx"],"sourcesContent":["function _1(md){return(\nmd`# Match Weights Charts`\n)}\n\nfunction _base_spec_m_u(width)\n{\n  return {\n    config: {\n      view: { width: width / 3, height: 300 },\n      title: { anchor: \"middle\", offset: 10 },\n      header: { title: null }\n    },\n    hconcat: [\n      {\n        mark: \"bar\",\n        title: { text: \"Non-matches\", fontWeight: \"normal\" },\n        encoding: {\n          row: {\n            type: \"nominal\",\n            field: \"column_name\",\n            sort: { field: \"gamma_index\" },\n            header: { labelAngle: 0, labelAnchor: \"middle\", labelAlign: \"left\" }\n          },\n          x: {\n            type: \"quantitative\",\n            field: \"u_probability\",\n            axis: { title: \"proportion\" }\n          },\n          y: { type: \"nominal\", axis: { title: null }, field: \"level_name\" },\n          tooltip: [\n            { type: \"nominal\", field: \"column_name\" },\n            { type: \"ordinal\", field: \"level_name\" },\n            { type: \"quantitative\", field: \"u_probability\", format: \".4f\" },\n            { type: \"quantitative\", field: \"bayes_factor\", format: \".4f\" },\n            {\n              type: \"nominal\",\n              field: \"level_proportion\",\n              title: \"Percentage of record comparisons in this level\",\n              format: \".2%\"\n            },\n            { type: \"quantitative\", field: \"log2_bayes_factor\", format: \".4f\" }\n          ],\n          color: { value: \"red\" }\n        },\n        resolve: { scale: { y: \"independent\" } },\n        transform: [\n          {\n            filter:\n              \"(datum.bayes_factor != 'unnecessary filter2 due to vega lite issue 4680')\"\n          }\n        ],\n        // width: width / 2,\n        height: 50\n      },\n      {\n        mark: \"bar\",\n        title: { text: \"Matches\", fontWeight: \"normal\" },\n        encoding: {\n          row: {\n            type: \"nominal\",\n            field: \"column_name\",\n            sort: { field: \"gamma_index\" },\n            header: { labels: false }\n          },\n          x: {\n            type: \"quantitative\",\n            field: \"m_probability\",\n            axis: { title: \"proportion\" }\n          },\n          y: { type: \"nominal\", axis: { title: null }, field: \"level_name\" },\n          tooltip: [\n            { type: \"nominal\", field: \"column_name\" },\n            { type: \"ordinal\", field: \"level_name\" },\n            { type: \"quantitative\", field: \"m_probability\", format: \".4f\" },\n            { type: \"quantitative\", field: \"bayes_factor\", format: \".4f\" },\n            {\n              type: \"nominal\",\n              field: \"level_proportion\",\n              title: \"Percentage of record comparisons in this level\",\n              format: \".2%\"\n            },\n            { type: \"quantitative\", field: \"log2_bayes_factor\", format: \".4f\" }\n          ],\n          color: { value: \"green\" }\n        },\n        resolve: { scale: { y: \"independent\" } },\n        transform: [\n          {\n            filter:\n              \"(datum.bayes_factor != 'unnecessary filter due to vega lite issue 4680')\"\n          }\n        ],\n        // width: width / 2,\n        height: 50\n      }\n    ],\n    data: { values: null },\n    transform: [],\n    title: {\n      text: \"Probability distributions of non-matches and matches \",\n      subtitle: \"Estimated proportion of matches λ = \"\n    },\n    $schema: \"https://vega.github.io/schema/vega-lite/v4.json\"\n  };\n}\n\n\nfunction _base_spec_bayes_factors(width)\n{\n  return {\n    config: {\n      view: { width: width / 1.5, height: 300 },\n      mark: { tooltip: null },\n      title: { anchor: \"middle\" },\n      header: { title: null }\n    },\n    data: { values: null },\n    mark: { type: \"bar\", clip: true },\n    selection: {\n      selector076: { type: \"interval\", bind: \"scales\", encodings: [\"x\"] }\n    },\n    encoding: {\n      color: {\n        type: \"quantitative\",\n        field: \"log2_bayes_factor\",\n        scale: { range: [\"red\", \"orange\", \"green\"], domain: [-10, 0, 10] }\n      },\n      row: {\n        type: \"nominal\",\n        field: \"column_name\",\n        sort: { field: \"gamma_index\" },\n        header: { labelAngle: 0, labelAnchor: \"middle\", labelAlign: \"left\" }\n      },\n      tooltip: [\n        { type: \"nominal\", field: \"column_name\" },\n        { type: \"ordinal\", field: \"level_name\" },\n        { type: \"quantitative\", field: \"m_probability\", format: \".4f\" },\n        { type: \"quantitative\", field: \"bayes_factor\", format: \".4f\" },\n        {\n          type: \"nominal\",\n          field: \"level_proportion\",\n          title: \"Percentage of record comparisons in this level\",\n          format: \".2%\"\n        },\n        {\n          type: \"quantitative\",\n          field: \"log2_bayes_factor\",\n          title: \"log2(Bayes factor, K = m/u)\",\n          format: \".4f\"\n        }\n      ],\n      x: {\n        type: \"quantitative\",\n        axis: {\n          title: \"log2(Bayes factor, K = m/u)\",\n          values: [-10, -5, 0, 5, 10]\n        },\n        field: \"log2_bayes_factor\",\n        scale: { domain: [-10, 10] }\n      },\n      y: { type: \"nominal\", field: \"level_name\", axis: { title: null } }\n    },\n    height: 50,\n    resolve: { scale: { y: \"independent\" } },\n    title: {\n      text: \"Influence of comparison vector values on match probability\",\n      subtitle: \"Use mousewheeel to zoom\"\n    },\n    $schema: \"https://vega.github.io/schema/vega-lite/v4.json\"\n  };\n}\n\n\nfunction _settings_example(default_splink_settings){return(\nJSON.parse(default_splink_settings)\n)}\n\nfunction _chart_data_from_splink_settings(get_chart_row){return(\nfunction chart_data_from_splink_settings(splink_settings) {\n  let chart_data = [];\n  const zip = (a, b) => a.map((k, i) => [k, b[i]]);\n\n  splink_settings.comparison_columns.forEach((cc) => {\n    let zipped = zip(cc[\"m_probabilities\"], cc[\"u_probabilities\"]);\n    zipped.forEach((m_u_pair, index) => {\n      let row = get_chart_row(m_u_pair, cc, index);\n      chart_data.push(row);\n    });\n  });\n  return chart_data;\n}\n)}\n\nfunction _get_m_u_chart(base_spec_m_u,chart_data_from_splink_settings,embed){return(\nfunction get_m_u_chart(splink_setttings) {\n  let base_spec = JSON.parse(JSON.stringify(base_spec_m_u));\n  let lam = splink_setttings.proportion_of_matches;\n  base_spec.data.values = chart_data_from_splink_settings(splink_setttings);\n  base_spec.title.subtitle = `Estimated proportion of matches λ = ${lam}`;\n  return embed(base_spec);\n}\n)}\n\nfunction _7(get_m_u_chart,settings_example){return(\nget_m_u_chart(settings_example)\n)}\n\nfunction _get_bayes_factor_chart(base_spec_bayes_factors,chart_data_from_splink_settings,embed){return(\nfunction get_bayes_factor_chart(splink_setttings) {\n  let base_spec = JSON.parse(JSON.stringify(base_spec_bayes_factors));\n  let lam = splink_setttings.proportion_of_matches;\n  base_spec.data.values = chart_data_from_splink_settings(splink_setttings);\n  base_spec.title.subtitle = `Estimated proportion of matches λ = ${lam.toPrecision(\n    4\n  )}`;\n  return embed(base_spec);\n}\n)}\n\nfunction _9(get_bayes_factor_chart,settings_example){return(\nget_bayes_factor_chart(settings_example)\n)}\n\nfunction _get_chart_row(){return(\nfunction get_chart_row(m_u_pair, comparison_column, index) {\n  let row = {};\n  let cc = comparison_column;\n  row[\"m_probability\"] = m_u_pair[0];\n  row[\"u_probability\"] = m_u_pair[1];\n  row[\"bayes_factor\"] = m_u_pair[0] / m_u_pair[1];\n  row[\"column_name\"] = cc[\"col_name\"];\n  row[\"log2_bayes_factor\"] = Math.log2(row[\"bayes_factor\"]);\n  row[\"gamma_index\"] = index;\n  row[\"gamma_column_name\"] = \"gamma_\" + cc[\"col_name\"];\n  row[\"level_name\"] = \"level_\" + index;\n  row[\"max_gamma_index\"] = cc.m_probabilities.length - 1;\n  row[\"num_levels\"] = cc.m_probabilities.length;\n\n  return row;\n}\n)}\n\nfunction _default_splink_settings()\n{\n  return `{\n    \"proportion_of_matches\": 0.001,\n    \"comparison_columns\": [\n      {\n        \"col_name\": \"fname\",\n        \"u_probabilities\": [0.8, 0.2],\n        \"m_probabilities\": [0.2, 0.8]\n      },\n      {\n        \"col_name\": \"sname\",\n        \"u_probabilities\": [0.9, 0.1],\n        \"m_probabilities\": [0.2, 0.8]\n      },\n      {\n        \"col_name\": \"dob\",\n        \"u_probabilities\": [0.99, 0.01],\n        \"m_probabilities\": [0.2, 0.8]\n      },\n      {\n        \"col_name\": \"town\",\n        \"u_probabilities\": [0.7, 0.3],\n        \"m_probabilities\": [0.3, 0.7]\n      }\n    ]\n  \n  }`;\n}\n\n\nfunction _embed(require){return(\nrequire(\"vega-embed@6\")\n)}\n\nexport default function define(runtime, observer) {\n  const main = runtime.module();\n  main.variable(observer()).define([\"md\"], _1);\n  main.variable(observer(\"base_spec_m_u\")).define(\"base_spec_m_u\", [\"width\"], _base_spec_m_u);\n  main.variable(observer(\"base_spec_bayes_factors\")).define(\"base_spec_bayes_factors\", [\"width\"], _base_spec_bayes_factors);\n  main.variable(observer(\"settings_example\")).define(\"settings_example\", [\"default_splink_settings\"], _settings_example);\n  main.variable(observer(\"chart_data_from_splink_settings\")).define(\"chart_data_from_splink_settings\", [\"get_chart_row\"], _chart_data_from_splink_settings);\n  main.variable(observer(\"get_m_u_chart\")).define(\"get_m_u_chart\", [\"base_spec_m_u\",\"chart_data_from_splink_settings\",\"embed\"], _get_m_u_chart);\n  main.variable(observer()).define([\"get_m_u_chart\",\"settings_example\"], _7);\n  main.variable(observer(\"get_bayes_factor_chart\")).define(\"get_bayes_factor_chart\", [\"base_spec_bayes_factors\",\"chart_data_from_splink_settings\",\"embed\"], _get_bayes_factor_chart);\n  main.variable(observer()).define([\"get_bayes_factor_chart\",\"settings_example\"], _9);\n  main.variable(observer(\"get_chart_row\")).define(\"get_chart_row\", _get_chart_row);\n  main.variable(observer(\"default_splink_settings\")).define(\"default_splink_settings\", _default_splink_settings);\n  main.variable(observer(\"embed\")).define(\"embed\", [\"require\"], _embed);\n  return main;\n}\n","import define1 from \"./817db6818ab226c0@104.js\";\n\nfunction _1(md){return(\nmd`# Resizable areas`\n)}\n\nfunction _num_levels(inputs){return(\ninputs.range([2, 6], {\n  label: 'num levels',\n  step: 1,\n  value: 3\n})\n)}\n\nfunction _3(md){return(\nmd`## Drag within the bars to resize\n\nNote that if you change the number of levels of the axis squishiness, values will reset`\n)}\n\nfunction _thing(m_u_input_control,width,height,starting_data){return(\nm_u_input_control(width, height, starting_data, 0, true, 0)\n)}\n\nfunction _gen_y_scale(d3){return(\nfunction(axis_stretch_at_extremes, height, internal_height) {\n  //https://www.wolframalpha.com/input/?i=solve+y%3D+log_b%28%28x%2Bc%29%2F%28c-x%29%29\n\n  if (axis_stretch_at_extremes == 0) {\n    return d3\n      .scaleLinear()\n      .domain([0, 1])\n      .range([internal_height, 0]);\n  }\n\n  let squash = axis_stretch_at_extremes;\n  let my_fn;\n  if (squash >= 0) {\n    my_fn = x => Math.pow(5, x) / (Math.pow(5, x) + 1);\n  } else {\n    my_fn = x => -1 * Math.log((x + 8.01) / (8.01 - x));\n\n    let root = 1 / 3;\n\n    let multiple = 8 / Math.pow(8, root);\n\n    squash = -Math.pow(-squash, root) * multiple;\n  }\n\n  let offset_scale = d3\n    .scaleLinear()\n    .domain([0, 1])\n    .range([-squash, squash]);\n\n  let num_points = 50;\n\n  let in_values_not_normalised = d3\n    .range(num_points + 1)\n    .map(d => d / num_points)\n    .map(offset_scale)\n    .map(my_fn);\n\n  let ext = d3.extent(in_values_not_normalised);\n\n  let normalise_scale = d3\n    .scaleLinear()\n    .domain(ext)\n    .range([0, 1]);\n\n  let domain = in_values_not_normalised.map(normalise_scale);\n\n  let range = d3\n    .range(num_points + 1)\n    .map(d => (internal_height * (num_points - d)) / num_points);\n\n  return d3\n    .scaleLinear()\n    .domain(domain)\n    .range(range);\n}\n)}\n\nfunction _m_u_input_control(DOM,d3,margin,splink_data_to_unstacked_data,unstacked_data_to_stacked,num_levels_to_level_keys,get_level_colours_scale,inputs,gen_x_scale,gen_y_scale,html,get_tick_vals,redraw){return(\nfunction(\n  width,\n  height,\n  splink_settings,\n  comparison_column_index = 0,\n  axis_compression_slider = false,\n  axis_compression_start_value = 0\n) {\n  // Lots of vars created in this funcion that need to be passed to other functinos like redraw\n  // Put them all in 'enclosed data'\n\n  let comparison_col =\n    splink_settings.comparison_columns[comparison_column_index];\n  let num_levels = comparison_col.u_probabilities.length;\n\n  const node = DOM.svg(width, height);\n  const svg_outer = d3.select(node);\n\n  // svg_outer.style(\"border\", \"1px solid black \");\n  const svg = svg_outer\n    .append(\"g\")\n    .attr(\"transform\", \"translate(\" + margin.left + \",\" + margin.top + \")\")\n    .attr(\"class\", \"outer_group\");\n\n  let unstacked_data = splink_data_to_unstacked_data(\n    splink_settings,\n    comparison_column_index\n  );\n  let stacked_data = unstacked_data_to_stacked(unstacked_data);\n\n  let plot_data = stacked_data.m_u;\n\n  let level_keys = num_levels_to_level_keys(num_levels);\n\n  let level_names = num_levels_to_level_keys(num_levels);\n  if ('level_names' in splink_settings) {\n    level_names = splink_settings.level_names;\n  }\n\n  let level_colours = get_level_colours_scale(stacked_data);\n  let internal_width = width - margin.left - margin.right;\n  let internal_height = height - margin.top - margin.bottom;\n\n  let axis_slider = inputs.range([-8, 8], {\n    step: 0.1,\n    label: 'Axis compression',\n    value: axis_compression_start_value\n  });\n\n  if (!axis_compression_slider) {\n    axis_slider.style.display = 'none';\n  }\n\n  let x = gen_x_scale(axis_slider.value, width, internal_width);\n  let y = gen_y_scale(axis_slider.value, height, internal_height);\n\n  let final_output = html`\n\n  ${axis_slider}\n  ${svg_outer.node()}\n  `;\n\n  let enclosed_data = {\n    x,\n    y,\n    svg,\n    svg_outer,\n    unstacked_data,\n    stacked_data,\n    level_keys,\n    level_names,\n    level_colours,\n    final_output,\n    axis_slider,\n    internal_height,\n    internal_width,\n    width,\n    height\n  };\n\n  svg.on(\".drag\", null);\n\n  let inner = svg\n    .selectAll(\"g\")\n    .data(plot_data)\n    .join(\"g\")\n    .attr(\"fill\", d => level_colours(d.key))\n    .attr(\"class\", d => d.key)\n    .classed(\"inner_group\", \"true\");\n\n  inner\n    .selectAll(\"rect\")\n    .data(d => d)\n    .join(\"rect\")\n    .attr(\"stroke\", \"white\")\n    .attr(\"stroke-width\", \"2px\")\n    .classed(\"m_u_areas\", \"true\");\n\n  inner\n    .selectAll(\"text\")\n    .data(d => d)\n    .join(\"text\")\n    .attr(\"text-anchor\", \"middle\")\n    .attr(\"dy\", \"0.5em\")\n    .style(\"font-size\", \"0.8em\")\n    .attr(\"pointer-events\", \"none\")\n\n    .style(\"font-family\", \"sans-serif\")\n    .classed(\"m_u_labels\", \"true\");\n  let tickVals = get_tick_vals(axis_slider.value);\n\n  svg.append('g').attr(\"class\", \"x_axis_group\");\n\n  svg.append('g').attr(\"class\", \"y_axis_group\");\n\n  inner.selectAll(\"text.chart_title\").remove();\n\n  inner\n    .append(\"text\")\n    .text(\"Distribution of m and u values\")\n    .attr(\"y\", -60)\n    .attr(\"x\", internal_width / 2)\n    .attr(\"class\", \"chart_title\")\n    .attr(\"text-anchor\", \"middle\")\n    .attr(\"dy\", \"0.5em\")\n    .style(\"font-size\", \"1em\")\n    .style(\"font-weight\", \"bold\")\n    .attr(\"pointer-events\", \"none\")\n    .style('fill', 'black')\n    .style(\"font-family\", \"sans-serif\");\n\n  inner\n    .append(\"text\")\n    .text(\"✨ Drag within rectangles to change values ✨\")\n    .attr(\"y\", -20)\n    .attr(\"x\", internal_width / 2)\n    .attr(\"class\", \"chart_title\")\n    .attr(\"text-anchor\", \"middle\")\n    .attr(\"dy\", \"0.5em\")\n    .style(\"font-size\", \"0.8em\")\n\n    .attr(\"pointer-events\", \"none\")\n    .style('fill', 'red')\n    .style(\"font-family\", \"sans-serif\");\n\n  inner\n    .append(\"text\")\n    .text(\n      \"The area represents all record comparisons, split into levels by match status\"\n    )\n    .attr(\"y\", -40)\n    .attr(\"x\", internal_width / 2)\n    .attr(\"class\", \"chart_title\")\n    .attr(\"text-anchor\", \"middle\")\n    .attr(\"dy\", \"0.5em\")\n    .style(\"font-size\", \"0.8em\")\n\n    .attr(\"pointer-events\", \"none\")\n    .style('fill', 'black')\n    .style(\"font-family\", \"sans-serif\");\n\n  redraw(enclosed_data);\n\n  d3.select(axis_slider).on('input', d => {\n    redraw(enclosed_data);\n  });\n\n  final_output.value = unstacked_data;\n\n  return final_output;\n}\n)}\n\nfunction _7(thing){return(\nthing\n)}\n\nfunction _redraw(gen_x_scale,gen_y_scale,get_scale,get_drag,get_label,get_tick_vals,d3,format_tick){return(\nfunction redraw(enclosed_data) {\n  let e = enclosed_data;\n\n  let unstacked_data = e.unstacked_data;\n  let svg = e.svg;\n  let svg_outer = e.svg_outer;\n  let stacked_data = e.stacked_data;\n  let plot_data = stacked_data.m_u;\n  let level_keys = e.level_keys;\n  let level_names = e.level_names;\n\n  let slider = e.axis_slider;\n  let axis_stretch = slider.value;\n  let internal_height = e.internal_height;\n  let internal_width = e.internal_width;\n  let width = e.width;\n  let height = e.height;\n\n  e.x = gen_x_scale(axis_stretch, width, internal_width);\n  e.y = gen_y_scale(axis_stretch, height, internal_height);\n\n  let inner = svg\n    .selectAll(\".inner_group\")\n    .data(plot_data)\n    .join(\"g\")\n    .attr(\"fill\", d => e.level_colours(d.key));\n\n  inner\n    .selectAll(\"rect.m_u_areas\")\n    .data(d => {\n      return d;\n    })\n    .join(\"rect\")\n    .attr(\"x\", d => {\n      return get_scale(d.data.match_status, e.stacked_data.lam, e.x)(\n        d.data.match_status\n      );\n    })\n    .attr(\"y\", d => e.y(d[1]))\n    .attr(\"height\", d => e.y(d[0]) - e.y(d[1]))\n    .attr(\"width\", d =>\n      get_scale(d.data.match_status, unstacked_data.lam, e.x).bandwidth()\n    )\n    .call(get_drag(enclosed_data, redraw));\n\n  inner\n    .selectAll(\"text.m_u_labels\")\n    .data(d => {\n      return d;\n    })\n    .join(\"text\")\n    .attr(\"x\", d => {\n      return (\n        get_scale(d.data.match_status, stacked_data.lam, e.x)(\n          d.data.match_status\n        ) +\n        get_scale(d.data.match_status, stacked_data.lam, e.x).bandwidth() / 2\n      );\n    })\n    .attr(\"y\", d => (e.y(d[1]) + e.y(d[0])) / 2)\n    .text(d => get_label(d, level_keys, level_names))\n    .style('fill', 'black');\n  inner.selectAll(\"text.axis_match_label\").remove();\n  inner\n    .selectAll(\"text.axis_match_label\")\n    .data([\n      {\n        text: \"Record comparisons which are non-matches\",\n        x: [0, 1 - unstacked_data.lam]\n      },\n      {\n        text: \"Record comparisons which are matches\",\n        x: [1 - unstacked_data.lam, 1]\n      }\n    ])\n    .join(\"text\")\n    .text(d => d.text)\n    .attr(\"y\", e.y(0) + 40)\n    .attr(\"x\", d => (e.x(d.x[0]) + e.x(d.x[1])) / 2)\n    .attr(\"class\", \"axis_match_label\")\n    .attr(\"text-anchor\", \"middle\")\n    .attr(\"dy\", \"0.5em\")\n    .style(\"font-size\", \"0.8em\")\n    .attr(\"pointer-events\", \"none\")\n    .style('fill', 'black')\n    .style(\"font-family\", \"sans-serif\");\n\n  let tickVals = get_tick_vals(slider.value);\n\n  svg\n    .selectAll(\".x_axis_group\")\n    .attr(\"transform\", \"translate(\" + 0 + \",\" + internal_height + \")\")\n    .call(\n      d3\n        .axisBottom(e.x)\n        .tickValues(tickVals)\n        .tickFormat(format_tick)\n    );\n\n  svg.selectAll(\".y_axis_group\").call(\n    d3\n      .axisLeft(e.y)\n      .tickValues(tickVals)\n      .tickFormat(format_tick)\n  );\n}\n)}\n\nfunction _starting_data(normalise,d3,num_levels){return(\n{\n  proportion_of_matches: 0.3,\n  comparison_columns: [\n    {\n      col_name: \"my column\",\n      m_probabilities: normalise(d3.range(1, num_levels + 1, 1)),\n      u_probabilities: normalise(d3.range(num_levels, 0, -1))\n    }\n  ]\n}\n)}\n\nfunction _splink_data_to_unstacked_data(){return(\nfunction(\n  splink_settings,\n  comparison_column_index = 0\n) {\n  let data = { lam: splink_settings.proportion_of_matches };\n  data.m_u = [null, null];\n\n  let u_probs =\n    splink_settings.comparison_columns[comparison_column_index].u_probabilities;\n  data.m_u[0] = { match_status: \"non-match\", match_index: 0 };\n  u_probs.forEach((p, i) => (data.m_u[0][\"level_\" + i] = p));\n\n  let m_probs =\n    splink_settings.comparison_columns[comparison_column_index].m_probabilities;\n  data.m_u[1] = { match_status: \"match\", match_index: 1 };\n  m_probs.forEach((p, i) => (data.m_u[1][\"level_\" + i] = p));\n\n  return data;\n}\n)}\n\nfunction _get_tick_vals(){return(\nfunction(axis_stretch_at_extremes) {\n  let vals = [\n    1e-10,\n    1e-9,\n    1e-8,\n    1e-7,\n    1e-6,\n    1e-5,\n    1e-4,\n    1e-3,\n    1e-2,\n    1e-1,\n    0.5,\n    1 - 1e-1,\n    1 - 1e-2,\n    1 - 1e-3,\n    1 - 1e-4,\n    1 - 1e-5,\n    1 - 1e-6,\n    1 - 1e-7,\n    1 - 1e-8,\n    1 - 1e-9,\n    1 - 1e-10\n  ];\n\n  let index_offset = Math.floor(axis_stretch_at_extremes * 0.65);\n  let middle_index = vals.indexOf(0.5);\n  let start_index = middle_index - index_offset;\n  let end_index = middle_index + index_offset;\n\n  if (axis_stretch_at_extremes > 2.5) {\n    return [0].concat(vals.slice(start_index, end_index + 1)).concat([1]);\n  } else {\n    return null;\n  }\n}\n)}\n\nfunction _get_label(d3){return(\nfunction(d, level_keys, level_names) {\n  let lev_name = d.key;\n\n  let lev_index = level_keys.indexOf(lev_name);\n  let this_name = level_names[lev_index];\n\n  let ms = d.data.match_status;\n  let level_prop = d3.format(\",.2%\")(d.data[d.key]);\n  this_name = this_name.replace(\"_\", \" \");\n\n  this_name = this_name.charAt(0).toUpperCase() + this_name.slice(1);\n\n  return `${this_name}: ${level_prop} of ${ms}es`;\n}\n)}\n\nfunction _gen_x_scale(d3){return(\nfunction(axis_stretch_at_extremes, width, internal_width) {\n  //https://www.wolframalpha.com/input/?i=solve+y%3D+log_b%28%28x%2Bc%29%2F%28c-x%29%29\n\n  if (axis_stretch_at_extremes == 0) {\n    return d3\n      .scaleLinear()\n      .domain([0, 1])\n      .range([0, internal_width]);\n  }\n\n  let squash = axis_stretch_at_extremes;\n  let my_fn;\n  if (squash >= 0) {\n    my_fn = x => Math.pow(5, x) / (Math.pow(5, x) + 1);\n  } else {\n    my_fn = x => -1 * Math.log((x + 8.01) / (8.01 - x));\n\n    let root = 1 / 3;\n\n    let multiple = 8 / Math.pow(8, root);\n\n    squash = -Math.pow(-squash, root) * multiple;\n  }\n\n  let offset_scale = d3\n    .scaleLinear()\n    .domain([0, 1])\n    .range([-squash, squash]);\n\n  let num_points = 50;\n\n  let in_values_not_normalised = d3\n    .range(num_points + 1)\n    .map(d => d / num_points)\n    .map(offset_scale)\n    .map(my_fn);\n\n  let ext = d3.extent(in_values_not_normalised);\n\n  let normalise_scale = d3\n    .scaleLinear()\n    .domain(ext)\n    .range([0, 1]);\n\n  let domain = in_values_not_normalised.map(normalise_scale);\n\n  let range = d3\n    .range(num_points + 1)\n    .map(d => (internal_width * d) / num_points);\n\n  return d3\n    .scaleLinear()\n    .domain(domain)\n    .range(range);\n}\n)}\n\nfunction _get_level_colours_scale(d3){return(\nfunction(stacked_data) {\n  let scheme = d3.schemeGnBu;\n  scheme[2] = [scheme[3][0], scheme[3][2]];\n\n  return d3\n    .scaleOrdinal()\n    .domain(stacked_data[\"m_u\"].map(d => d.key))\n    .range(scheme[stacked_data[\"m_u\"].length]);\n}\n)}\n\nfunction _get_drag(d3,get_lam,get_m_u,unstacked_data_to_stacked,Event){return(\nfunction(enclosed_data, redraw) {\n  // By passing data and redraw and then defining a function\n  // we create a closure over data and redraw, making them\n  // available to the drag function\n\n  return d3.drag().on(\"drag\", function(e) {\n    // Lam\n    enclosed_data.unstacked_data.lam = get_lam(e, enclosed_data);\n\n    // Now reallocate between bins\n    enclosed_data.unstacked_data.m_u = get_m_u(e, enclosed_data);\n\n    let plot_data = unstacked_data_to_stacked(enclosed_data.unstacked_data);\n    enclosed_data.stacked_data = plot_data;\n\n    enclosed_data.final_output.value = enclosed_data.unstacked_data;\n\n    redraw(enclosed_data);\n\n    enclosed_data.final_output.dispatchEvent(new Event(\"input\"));\n  });\n}\n)}\n\nfunction _get_lam(){return(\nfunction get_lam(e, enclosed_data) {\n  let x = enclosed_data.x;\n  let start_lam = enclosed_data.unstacked_data.lam;\n  let start_lam_x = x(start_lam);\n  let new_lam = x.invert(start_lam_x - e.dx);\n\n  new_lam = Math.min(new_lam, 1);\n  new_lam = Math.max(new_lam, 0);\n\n  return new_lam;\n}\n)}\n\nfunction _get_m_u(){return(\nfunction get_m_u(e, enclosed_data) {\n  //Note that e.subject, the datum associated with the rectangle, is fixed\n  // so for instance, the proportions contained in this data will not change\n  // during the course of an individual drag event\n  // m_u is being updated though, so it's actually m_u which contains the\n  // most up-to-date data associated with the diagram and hence this should be used\n  // for geometric calculations\n\n  let level_keys = enclosed_data.level_keys;\n\n  let stacked_data = enclosed_data.stacked_data;\n  let y = enclosed_data.y;\n  let m_u = enclosed_data.unstacked_data.m_u;\n\n  //   Get proportions associated with dragged rect\n  let this_level_name = e.subject.key;\n  let level_index = level_keys.indexOf(this_level_name);\n\n  let match_index = e.subject.data.match_index;\n\n  let dragged_cum_proportions = stacked_data.m_u[level_index][match_index];\n\n  //Get target level\n\n  let start_of_this_level_prop = dragged_cum_proportions[0];\n  let end_of_this_level_prop = dragged_cum_proportions[1];\n\n  let start_level_y = y(start_of_this_level_prop);\n  let end_level_y = y(end_of_this_level_prop);\n\n  // let midpoint_y = (y(e.subject[0]) + y(e.subject[1])) / 2;\n  let midpoint_y = (start_level_y + end_level_y) / 2;\n\n  let in_top_half;\n  if (e.y < midpoint_y) {\n    in_top_half = true;\n  } else {\n    in_top_half = false;\n  }\n\n  let target_level_index;\n  let dragging_from_bottom;\n\n  if (in_top_half) {\n    target_level_index = level_index + 1;\n    dragging_from_bottom = false;\n  } else {\n    target_level_index = level_index + -1;\n    dragging_from_bottom = true;\n  }\n  if (level_index == 0) {\n    target_level_index = 1;\n    dragging_from_bottom = false;\n  }\n\n  if (level_index == level_keys.length - 1) {\n    target_level_index = level_keys.length - 2;\n    dragging_from_bottom = true;\n  }\n\n  // Get y location we're starting the drag from\n\n  let cum_proportion_drag_start;\n  if (dragging_from_bottom) {\n    cum_proportion_drag_start = start_of_this_level_prop;\n  } else {\n    cum_proportion_drag_start = end_of_this_level_prop;\n  }\n\n  let change_from_start_prop;\n\n  let y_start = y(cum_proportion_drag_start);\n  let y_start_with_delta = y_start + e.dy;\n\n  let prop_start = y.invert(y_start);\n  let prop_end = y.invert(y_start_with_delta);\n\n  //   Update data\n\n  let change_in_prop = prop_end - prop_start;\n\n  if (!dragging_from_bottom) {\n    change_in_prop = -change_in_prop;\n  }\n\n  let target_level = level_keys[target_level_index];\n\n  let new_val_this_lev = m_u[match_index][this_level_name] - change_in_prop;\n\n  let new_val_target_lev = m_u[match_index][target_level] + change_in_prop;\n\n  function isBetween(n, a, b) {\n    return (n - a) * (n - b) <= 0;\n  }\n\n  if (\n    isBetween(new_val_this_lev, 0, 1) &&\n    isBetween(new_val_target_lev, 0, 1)\n  ) {\n    m_u[match_index][this_level_name] = new_val_this_lev;\n    m_u[match_index][target_level] = new_val_target_lev;\n  }\n\n  return m_u;\n}\n)}\n\nfunction _margin()\n{\n  let m_size = 60;\n  return { top: 80, right: m_size, bottom: m_size, left: m_size };\n}\n\n\nfunction _get_scale(d3){return(\nfunction(match_status, lam, x) {\n  let padding = 0.000;\n  let s1 = d3\n    .scaleBand()\n    .domain(['match'])\n    .range([x(1 - lam), x(1)])\n    .padding(padding);\n\n  let s2 = d3\n    .scaleBand()\n    .domain(['non-match'])\n    .range([x(0), x(1 - lam)])\n    .padding(padding);\n\n  if (match_status == 'match') {\n    return s1;\n  } else {\n    return s2;\n  }\n}\n)}\n\nfunction _input_control(num_levels_to_level_keys){return(\nfunction input_control(widget_data) {\n  let num_levels = widget_data.m_u[0].length;\n  let levels = num_levels_to_level_keys(num_levels);\n  let m = levels.map(lev => widget_data.m_u[1][lev]);\n  let u = levels.map(lev => widget_data.m_u[0][lev]);\n\n  return {\n    proportion_of_matches: widget_data.lam,\n    comparison_columns: [\n      {\n        col_name: 'my column',\n        m_probabilities: m,\n        u_probabilities: u,\n        num_levels: levels.length\n      }\n    ]\n  };\n}\n)}\n\nfunction _height(){return(\n500\n)}\n\nfunction _unstacked_data_to_stacked(level_keys_from_unstacked_data,d3){return(\nfunction(unstacked_data) {\n  let level_keys = level_keys_from_unstacked_data(unstacked_data);\n  let stack = d3\n    .stack()\n    .keys(level_keys)\n    .order(d3.stackOrderNone)\n    .offset(d3.stackOffsetNone);\n\n  let stacked = stack(unstacked_data[\"m_u\"]);\n  stacked = stacked.map(d => (d.forEach(v => (v.key = d.key)), d));\n  return { lam: unstacked_data.lam, m_u: stacked };\n}\n)}\n\nfunction _level_keys_from_unstacked_data(){return(\nfunction(unstacked_data) {\n  return Object.keys(unstacked_data.m_u[0]).filter(d => d.includes('level_'));\n}\n)}\n\nfunction _input_control_data_to_splink_settings(level_keys_from_unstacked_data,num_levels_to_level_keys){return(\nfunction input_control_data_to_splink_settings(input_control_data) {\n  let num_levels = level_keys_from_unstacked_data(input_control_data).length;\n  let levels = num_levels_to_level_keys(num_levels);\n  let m = levels.map(lev => input_control_data.m_u[1][lev]);\n  let u = levels.map(lev => input_control_data.m_u[0][lev]);\n\n  return {\n    proportion_of_matches: input_control_data.lam,\n    comparison_columns: [\n      {\n        col_name: ' ',\n        m_probabilities: m,\n        u_probabilities: u,\n        num_levels: levels.length\n      }\n    ]\n  };\n}\n)}\n\nfunction _num_levels_to_level_keys(d3){return(\nfunction(num_levels) {\n  return d3.range(num_levels).map(d => {\n    return \"level_\" + d;\n  });\n}\n)}\n\nfunction _format_tick(){return(\nfunction(d) {\n  return d.toString();\n}\n)}\n\nfunction _normalise(){return(\nfunction normalise(arr) {\n  let sum = arr.reduce((a, b) => a + b, 0);\n  return arr.map(d => d / sum);\n}\n)}\n\nfunction _gen_starting_data(num_levels_to_level_keys,d3,normalise){return(\nfunction(num_levels) {\n  let level_keys = num_levels_to_level_keys(num_levels);\n  let settings = {\n    proportion_of_matches: 0.3,\n    comparison_columns: [\n      {\n        col_name: \" \",\n        m_probabilities: null,\n        u_probabilities: null\n      }\n    ]\n  };\n\n  let norm = d3.range(1, num_levels + 1).reduce((d, acc) => {\n    return d + acc;\n  }, 0);\n\n  let m_probs = d3.range(1, num_levels + 1, 1).map(d => d**2)\n  m_probs = normalise(m_probs);\n\n  let u_probs = d3.range(num_levels, 0, -1).map(d => d**2);\n  u_probs = normalise(u_probs);\n\n  settings.comparison_columns[0].m_probabilities = m_probs;\n  settings.comparison_columns[0].u_probabilities = u_probs;\n\n  return settings;\n}\n)}\n\nfunction _30(md){return(\nmd`#### External fns`\n)}\n\nfunction _32(md){return(\nmd`#### External libs`\n)}\n\nfunction _inputs(require){return(\nrequire(\"@observablehq/inputs\")\n)}\n\nfunction _d3(require){return(\nrequire(\"d3@6\")\n)}\n\nexport default function define(runtime, observer) {\n  const main = runtime.module();\n  main.variable(observer()).define([\"md\"], _1);\n  main.variable(observer(\"viewof num_levels\")).define(\"viewof num_levels\", [\"inputs\"], _num_levels);\n  main.variable(observer(\"num_levels\")).define(\"num_levels\", [\"Generators\", \"viewof num_levels\"], (G, _) => G.input(_));\n  main.variable(observer()).define([\"md\"], _3);\n  main.variable(observer(\"viewof thing\")).define(\"viewof thing\", [\"m_u_input_control\",\"width\",\"height\",\"starting_data\"], _thing);\n  main.variable(observer(\"thing\")).define(\"thing\", [\"Generators\", \"viewof thing\"], (G, _) => G.input(_));\n  main.variable(observer(\"gen_y_scale\")).define(\"gen_y_scale\", [\"d3\"], _gen_y_scale);\n  main.variable(observer(\"m_u_input_control\")).define(\"m_u_input_control\", [\"DOM\",\"d3\",\"margin\",\"splink_data_to_unstacked_data\",\"unstacked_data_to_stacked\",\"num_levels_to_level_keys\",\"get_level_colours_scale\",\"inputs\",\"gen_x_scale\",\"gen_y_scale\",\"html\",\"get_tick_vals\",\"redraw\"], _m_u_input_control);\n  main.variable(observer()).define([\"thing\"], _7);\n  main.variable(observer(\"redraw\")).define(\"redraw\", [\"gen_x_scale\",\"gen_y_scale\",\"get_scale\",\"get_drag\",\"get_label\",\"get_tick_vals\",\"d3\",\"format_tick\"], _redraw);\n  main.variable(observer(\"starting_data\")).define(\"starting_data\", [\"normalise\",\"d3\",\"num_levels\"], _starting_data);\n  main.variable(observer(\"splink_data_to_unstacked_data\")).define(\"splink_data_to_unstacked_data\", _splink_data_to_unstacked_data);\n  main.variable(observer(\"get_tick_vals\")).define(\"get_tick_vals\", _get_tick_vals);\n  main.variable(observer(\"get_label\")).define(\"get_label\", [\"d3\"], _get_label);\n  main.variable(observer(\"gen_x_scale\")).define(\"gen_x_scale\", [\"d3\"], _gen_x_scale);\n  main.variable(observer(\"get_level_colours_scale\")).define(\"get_level_colours_scale\", [\"d3\"], _get_level_colours_scale);\n  main.variable(observer(\"get_drag\")).define(\"get_drag\", [\"d3\",\"get_lam\",\"get_m_u\",\"unstacked_data_to_stacked\",\"Event\"], _get_drag);\n  main.variable(observer(\"get_lam\")).define(\"get_lam\", _get_lam);\n  main.variable(observer(\"get_m_u\")).define(\"get_m_u\", _get_m_u);\n  main.variable(observer(\"margin\")).define(\"margin\", _margin);\n  main.variable(observer(\"get_scale\")).define(\"get_scale\", [\"d3\"], _get_scale);\n  main.variable(observer(\"input_control\")).define(\"input_control\", [\"num_levels_to_level_keys\"], _input_control);\n  main.variable(observer(\"height\")).define(\"height\", _height);\n  main.variable(observer(\"unstacked_data_to_stacked\")).define(\"unstacked_data_to_stacked\", [\"level_keys_from_unstacked_data\",\"d3\"], _unstacked_data_to_stacked);\n  main.variable(observer(\"level_keys_from_unstacked_data\")).define(\"level_keys_from_unstacked_data\", _level_keys_from_unstacked_data);\n  main.variable(observer(\"input_control_data_to_splink_settings\")).define(\"input_control_data_to_splink_settings\", [\"level_keys_from_unstacked_data\",\"num_levels_to_level_keys\"], _input_control_data_to_splink_settings);\n  main.variable(observer(\"num_levels_to_level_keys\")).define(\"num_levels_to_level_keys\", [\"d3\"], _num_levels_to_level_keys);\n  main.variable(observer(\"format_tick\")).define(\"format_tick\", _format_tick);\n  main.variable(observer(\"normalise\")).define(\"normalise\", _normalise);\n  main.variable(observer(\"gen_starting_data\")).define(\"gen_starting_data\", [\"num_levels_to_level_keys\",\"d3\",\"normalise\"], _gen_starting_data);\n  main.variable(observer()).define([\"md\"], _30);\n  const child1 = runtime.module(define1);\n  main.import(\"get_m_u_chart\", child1);\n  main.import(\"get_bayes_factor_chart\", child1);\n  main.variable(observer()).define([\"md\"], _32);\n  main.variable(observer(\"inputs\")).define(\"inputs\", [\"require\"], _inputs);\n  main.variable(observer(\"d3\")).define(\"d3\", [\"require\"], _d3);\n  return main;\n}\n","// https://observablehq.com/@robinl/dependencies-between-match-weights@158\nimport define1 from \"./34fd4ef09fb0509a@2296.js\";\nimport define2 from \"./817db6818ab226c0@104.js\";\n\nfunction _title(md){return(\nmd`# Dependencies between match weights`\n)}\n\nfunction _2(md){return(\nmd`*A final version of this notebook can be viewed on my blog [here](https://www.robinlinacre.com/match_weight_dependencies/).*`\n)}\n\nfunction _para_1(md){return(\nmd`The values of a column's match weights are interdependent:  Only certain combinations of values are possible.  \n\nSome types of data also result in maximum and minimum match weights.\n\nUnderstanding why these constraints occur can help you build better models, because it can help you find ways to extract more information from your comparison columns.\n\nThis article tries to build an intuition for why these constraints occur and why they matter.\n`\n)}\n\nfunction _para_2(md,tex){return(\nmd`## Example of a maximum match weight:  Gender\nConsider a column for gender, and let's assume there's an equal split of males and females in our data.\n\nA match on gender does not provide strong evidence in favour of a match because it's common to observe a match on gender amongst non-matching records.\n\nThis suggests there is an upper bound on the Bayes Factor for gender.  It turns out that, for this data, the maximum Bayes Factor is 2.0.\n\n Let's explore what this looks like visually, which will reveal the constraint.  Note that:\n\n- Amongst non-matching records, the gender field is just as likely to match as to mismatch, i.e.  ${tex`u_\\text{gender, level 0} = 0.5`} and ${tex`u_\\text{gender, level 1} = 0.5`}.\n\n-  ✨You can drag within the rectangles of the following diagram to see the effect of different m and u values on match weights✨\n`\n)}\n\nfunction _gen(reset_gender,m_u_input_control,width,settings_gender)\n{\n  reset_gender;\n  return m_u_input_control(width, 400, settings_gender, 0, 1);\n}\n\n\nfunction _reset_gender(inputs){return(\ninputs.button(\"Reset gender values\")\n)}\n\nfunction _bf_chart_gender(get_bayes_factor_chart,input_control_data_to_splink_settings,gen){return(\nget_bayes_factor_chart(\n  input_control_data_to_splink_settings(gen)\n)\n)}\n\nfunction _para_3(md){return(\nmd`### Observations\n\nTwo important findings emerge from this example:\n\n- There is a maximum bound of 2 on the match weight associated with a match on gender.  This is intuitive:  a match weight of two means that, if we observe a match on gender, it's now twice as likely that the records are a match - reflecting the equal split of genders.\n\n- There is no minimum bound of the match weight associated with a mismatch on gender.  This is also intuitive.  If gender is recorded with very high accuracy, then a mismatch on gender represents very strong evidence against a match.\n`\n)}\n\nfunction _para_4(md){return(\nmd`## Example of a minimum match weights:  Forename\n\nConsider a forename column.  Let's assume that nicknames, diminutives are common in this dataset.  For example, it may be common for someone called 'Jonathan' to appear variously as 'Jonathan', 'John' or 'Jonny'.  As such, it will be common that, amongst matches, the forename does not exactly match.\n\nConsider the following chart, which models this column with two comparison levels:\n- Level 1: Forename matches exactly\n- Level 0: Forname mismatches \n\nIn this scenario, the observation of a mismatch on forename does not provide strong evidence against a match, because it is so common to observe a mismatch amongst matching records.  \n`\n)}\n\nfunction _fn1(reset_fn1,m_u_input_control,width,settings_forename_1)\n{\n  reset_fn1;\n  return m_u_input_control(width, 400, settings_forename_1, 0, 3);\n}\n\n\nfunction _reset_fn1(inputs){return(\ninputs.button(\"Reset forename values\")\n)}\n\nfunction _bf_chart_fn_1(get_bayes_factor_chart,input_control_data_to_splink_settings,fn1){return(\nget_bayes_factor_chart(input_control_data_to_splink_settings(fn1))\n)}\n\nfunction _para_5(md){return(\nmd`Using a more sophisticted modelling approach, we can do better.\n\nLet's assume that we can capture the vast majority of nicknames and diminutives using a fuzzy matching function.  This allows us to draw a distinction between two scenarios:\n- Values do not match, but are similar\n- Values do not match, and are completely different.\n\nWe now set up our levels as follows:\n- Level 2: Exact match on forename\n- Level 1: Fuzzy match on forename\n- Level 0: Forename mismatches\n\n\n`\n)}\n\nfunction _fn2(reset_fn2,m_u_input_control,width,settings_forename_2)\n{\n  reset_fn2;\n  return m_u_input_control(width, 400, settings_forename_2, 0, 3);\n}\n\n\nfunction _reset_fn2(inputs){return(\ninputs.button(\"Reset forename values\")\n)}\n\nfunction _bf_chart_fn_2(get_bayes_factor_chart,input_control_data_to_splink_settings,fn2){return(\nget_bayes_factor_chart(\n  input_control_data_to_splink_settings(fn2)\n)\n)}\n\nfunction _para_6(md){return(\nmd`## Observations\n\n- When we modelled two levels, two names that fuzzy matched (John vs Jonny) would have been assigned the same negative match weight as two names which were completely different (John vs Robin).  We therefore lost information\n- When we model three levels, a much stronger negative weight on a mismatch is possible.  This is because the lowest level (level_0) now contains only names which are completely different, rather than being a mix of fuzzy matching names, and names which are competely different.\n\nModelling three levels thereby allows us to extract substantially more information from the data.\n`\n)}\n\nfunction _settings_gender(){return(\n{\n  proportion_of_matches: 0.3,\n  comparison_columns: [\n    {\n      col_name: \"gender\",\n      m_probabilities: [0.1, 0.9],\n      u_probabilities: [0.5, 0.5]\n    }\n  ],\n  level_names: [\"Gender mismatches\", \"Gender matches\"]\n}\n)}\n\nfunction _settings_forename_1(){return(\n{\n  proportion_of_matches: 0.3,\n  comparison_columns: [\n    {\n      col_name: \"gender\",\n      m_probabilities: [0.3, 0.7],\n      u_probabilities: [0.9, 0.1]\n    }\n  ],\n  level_names: [\"Forname mismatches\", \"Forename matches exactly\"]\n}\n)}\n\nfunction _settings_forename_2(){return(\n{\n  proportion_of_matches: 0.3,\n  comparison_columns: [\n    {\n      col_name: \"gender\",\n      m_probabilities: [0.05, 0.25, 0.7],\n      u_probabilities: [0.75, 0.15, 0.1]\n    }\n  ],\n  level_names: [\n    \"Forname mismatches\",\n    \"Forename fuzzy matches\",\n    \"Forename matches\"\n  ]\n}\n)}\n\nfunction _inputs(require){return(\nrequire(\"@observablehq/inputs\")\n)}\n\nexport default function define(runtime, observer) {\n  const main = runtime.module();\n  main.variable(observer(\"title\")).define(\"title\", [\"md\"], _title);\n  main.variable(observer()).define([\"md\"], _2);\n  main.variable(observer(\"para_1\")).define(\"para_1\", [\"md\"], _para_1);\n  main.variable(observer(\"para_2\")).define(\"para_2\", [\"md\",\"tex\"], _para_2);\n  main.variable(observer(\"viewof gen\")).define(\"viewof gen\", [\"reset_gender\",\"m_u_input_control\",\"width\",\"settings_gender\"], _gen);\n  main.variable(observer(\"gen\")).define(\"gen\", [\"Generators\", \"viewof gen\"], (G, _) => G.input(_));\n  main.variable(observer(\"viewof reset_gender\")).define(\"viewof reset_gender\", [\"inputs\"], _reset_gender);\n  main.variable(observer(\"reset_gender\")).define(\"reset_gender\", [\"Generators\", \"viewof reset_gender\"], (G, _) => G.input(_));\n  main.variable(observer(\"bf_chart_gender\")).define(\"bf_chart_gender\", [\"get_bayes_factor_chart\",\"input_control_data_to_splink_settings\",\"gen\"], _bf_chart_gender);\n  main.variable(observer(\"para_3\")).define(\"para_3\", [\"md\"], _para_3);\n  main.variable(observer(\"para_4\")).define(\"para_4\", [\"md\"], _para_4);\n  main.variable(observer(\"viewof fn1\")).define(\"viewof fn1\", [\"reset_fn1\",\"m_u_input_control\",\"width\",\"settings_forename_1\"], _fn1);\n  main.variable(observer(\"fn1\")).define(\"fn1\", [\"Generators\", \"viewof fn1\"], (G, _) => G.input(_));\n  main.variable(observer(\"viewof reset_fn1\")).define(\"viewof reset_fn1\", [\"inputs\"], _reset_fn1);\n  main.variable(observer(\"reset_fn1\")).define(\"reset_fn1\", [\"Generators\", \"viewof reset_fn1\"], (G, _) => G.input(_));\n  main.variable(observer(\"bf_chart_fn_1\")).define(\"bf_chart_fn_1\", [\"get_bayes_factor_chart\",\"input_control_data_to_splink_settings\",\"fn1\"], _bf_chart_fn_1);\n  main.variable(observer(\"para_5\")).define(\"para_5\", [\"md\"], _para_5);\n  main.variable(observer(\"viewof fn2\")).define(\"viewof fn2\", [\"reset_fn2\",\"m_u_input_control\",\"width\",\"settings_forename_2\"], _fn2);\n  main.variable(observer(\"fn2\")).define(\"fn2\", [\"Generators\", \"viewof fn2\"], (G, _) => G.input(_));\n  main.variable(observer(\"viewof reset_fn2\")).define(\"viewof reset_fn2\", [\"inputs\"], _reset_fn2);\n  main.variable(observer(\"reset_fn2\")).define(\"reset_fn2\", [\"Generators\", \"viewof reset_fn2\"], (G, _) => G.input(_));\n  main.variable(observer(\"bf_chart_fn_2\")).define(\"bf_chart_fn_2\", [\"get_bayes_factor_chart\",\"input_control_data_to_splink_settings\",\"fn2\"], _bf_chart_fn_2);\n  main.variable(observer(\"para_6\")).define(\"para_6\", [\"md\"], _para_6);\n  main.variable(observer(\"settings_gender\")).define(\"settings_gender\", _settings_gender);\n  main.variable(observer(\"settings_forename_1\")).define(\"settings_forename_1\", _settings_forename_1);\n  main.variable(observer(\"settings_forename_2\")).define(\"settings_forename_2\", _settings_forename_2);\n  main.variable(observer(\"inputs\")).define(\"inputs\", [\"require\"], _inputs);\n  const child1 = runtime.module(define1);\n  main.import(\"m_u_input_control\", child1);\n  main.import(\"input_control_data_to_splink_settings\", child1);\n  const child2 = runtime.module(define2);\n  main.import(\"get_m_u_chart\", child2);\n  main.import(\"get_bayes_factor_chart\", child2);\n  return main;\n}\n","/*@jsxRuntime classic @jsx React.createElement @jsxFrag React.Fragment*/\nimport React from \"react\";\nimport {MDXLayoutWide as MDXLayout} from \"../components/MDXLayout\";\nimport notebook from '@robinl/dependencies-between-match-weights';\nimport ObservableNotebook from '../components/ObservableNotebook';\nexport const output_order = [\"title\", \"para_1\", \"para_2\", \"viewof gen\", \"viewof reset_gender\", \"bf_chart_gender\", \"para_3\", \"para_4\", \"viewof fn1\", \"viewof reset_fn1\", \"bf_chart_fn_1\", \"para_5\", \"viewof fn2\", \"viewof reset_fn2\", \"bf_chart_fn_2\", \"para_6\"];\nfunction _createMdxContent(props) {\n  return React.createElement(ObservableNotebook, {\n    notebook: notebook,\n    cells: output_order\n  });\n}\nfunction MDXContent(props = {}) {\n  return React.createElement(MDXLayout, props, React.createElement(_createMdxContent, props));\n}\nexport default MDXContent;\n","import React, { useRef, useEffect } from 'react';\nimport { Runtime, Inspector, Library } from '@observablehq/runtime';\n\nconst mountId = 'mdx-container-div';\n\nconst stdlib = new Library();\n\nconst library = Object.assign({}, stdlib, { width: width_mdx });\n\nfunction width_mdx() {\n    return stdlib.Generators.observe(notify => {\n        let width1 = notify(document.getElementById(mountId).clientWidth);\n        function resized() {\n            let width2 = document.getElementById(mountId).clientWidth;\n            if (width2 !== width1) notify((width1 = width2));\n        }\n\n        window.addEventListener('resize', resized);\n        return () => window.removeEventListener('resize', resized);\n    });\n}\n\nfunction ObservableNotebook({ notebook, cells, customClassName }) {\n    const refs = useRef(cells.map(() => React.createRef()));\n\n    useEffect(() => {\n        const runtime = new Runtime(library);\n        runtime.module(notebook, name => {\n            const index = cells.indexOf(name);\n            if (index !== -1) {\n                return new Inspector(refs.current[index].current);\n            }\n        });\n        return () => runtime.dispose();\n    }, [notebook, cells]);\n\n    return (\n        <div className={customClassName}>\n            {refs.current.map((ref, index) => (\n                <div key={index} ref={ref} />\n            ))}\n        </div>\n    );\n}\n\nexport default ObservableNotebook;\n"],"names":["_1","md","_base_spec_m_u","width","config","view","height","title","anchor","offset","header","hconcat","mark","text","fontWeight","encoding","row","type","field","sort","labelAngle","labelAnchor","labelAlign","x","axis","y","tooltip","format","color","value","resolve","scale","transform","filter","labels","data","values","subtitle","$schema","_base_spec_bayes_factors","clip","selection","selector076","bind","encodings","range","domain","_settings_example","default_splink_settings","JSON","parse","_chart_data_from_splink_settings","get_chart_row","splink_settings","chart_data","comparison_columns","forEach","cc","a","b","map","k","i","m_u_pair","index","push","_get_m_u_chart","base_spec_m_u","chart_data_from_splink_settings","embed","splink_setttings","base_spec","stringify","lam","proportion_of_matches","_7","get_m_u_chart","settings_example","_get_bayes_factor_chart","base_spec_bayes_factors","toPrecision","_9","get_bayes_factor_chart","_get_chart_row","comparison_column","Math","log2","m_probabilities","length","_default_splink_settings","_embed","require","runtime","observer","main","module","variable","define","_num_levels","inputs","label","step","_3","_thing","m_u_input_control","starting_data","_gen_y_scale","d3","axis_stretch_at_extremes","internal_height","scaleLinear","my_fn","squash","pow","log","root","multiple","offset_scale","in_values_not_normalised","num_points","d","ext","extent","normalise_scale","_m_u_input_control","DOM","margin","splink_data_to_unstacked_data","unstacked_data_to_stacked","num_levels_to_level_keys","get_level_colours_scale","gen_x_scale","gen_y_scale","html","get_tick_vals","redraw","comparison_column_index","axis_compression_slider","axis_compression_start_value","num_levels","u_probabilities","node","svg","svg_outer","select","append","attr","left","top","unstacked_data","stacked_data","plot_data","m_u","level_keys","level_names","level_colours","internal_width","right","bottom","axis_slider","style","display","final_output","enclosed_data","on","inner","selectAll","join","key","classed","remove","thing","_redraw","get_scale","get_drag","get_label","format_tick","e","slider","axis_stretch","match_status","bandwidth","call","tickVals","axisBottom","tickValues","tickFormat","axisLeft","_starting_data","normalise","col_name","_splink_data_to_unstacked_data","u_probs","match_index","p","m_probs","_get_tick_vals","vals","index_offset","floor","middle_index","indexOf","start_index","end_index","concat","slice","_get_label","lev_name","this_name","ms","level_prop","replace","charAt","toUpperCase","_gen_x_scale","_get_level_colours_scale","scheme","schemeGnBu","scaleOrdinal","_get_drag","get_lam","get_m_u","Event","drag","dispatchEvent","_get_lam","start_lam_x","new_lam","invert","dx","min","max","_get_m_u","in_top_half","target_level_index","dragging_from_bottom","cum_proportion_drag_start","this_level_name","subject","level_index","dragged_cum_proportions","start_of_this_level_prop","end_of_this_level_prop","midpoint_y","y_start","y_start_with_delta","dy","prop_start","change_in_prop","target_level","new_val_this_lev","new_val_target_lev","isBetween","n","_margin","_get_scale","s1","scaleBand","padding","s2","_input_control","widget_data","levels","m","lev","u","_height","_unstacked_data_to_stacked","level_keys_from_unstacked_data","stacked","stack","keys","order","stackOrderNone","stackOffsetNone","v","_level_keys_from_unstacked_data","Object","includes","_input_control_data_to_splink_settings","input_control_data","_num_levels_to_level_keys","_format_tick","toString","_normalise","arr","sum","reduce","_gen_starting_data","settings","acc","_30","_32","_inputs","_d3","G","_","input","child1","import","_title","_2","_para_1","_para_2","tex","_gen","reset_gender","settings_gender","_reset_gender","button","_bf_chart_gender","input_control_data_to_splink_settings","gen","_para_3","_para_4","_fn1","reset_fn1","settings_forename_1","_reset_fn1","_bf_chart_fn_1","fn1","_para_5","_fn2","reset_fn2","settings_forename_2","_reset_fn2","_bf_chart_fn_2","fn2","_para_6","_settings_gender","_settings_forename_1","_settings_forename_2","child2","output_order","_createMdxContent","props","React","ObservableNotebook","notebook","cells","MDXLayout","mountId","stdlib","Library","library","assign","Generators","observe","notify","width1","document","getElementById","clientWidth","resized","width2","window","addEventListener","removeEventListener","_ref","customClassName","refs","useRef","useEffect","Runtime","name","Inspector","current","dispose","className","ref"],"sourceRoot":""}