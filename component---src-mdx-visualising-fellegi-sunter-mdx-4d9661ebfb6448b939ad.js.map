{"version":3,"file":"component---src-mdx-visualising-fellegi-sunter-mdx-4d9661ebfb6448b939ad.js","mappings":"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","sources":["webpack://robinlinacre/./node_modules/@robinl/visualising-fellegi-sunter/379dba93f4bb9357@1129.js","webpack://robinlinacre/./node_modules/@robinl/visualising-fellegi-sunter/79750b3b8e929d9d@209.js","webpack://robinlinacre/./node_modules/@robinl/visualising-fellegi-sunter/d25176b0fe784ad0@488.js","webpack://robinlinacre/./node_modules/@robinl/visualising-fellegi-sunter/ecf81050a24329e5@163.js","webpack://robinlinacre/./node_modules/@robinl/visualising-fellegi-sunter/060a32b021a09f92@1011.js","webpack://robinlinacre/./src/mdx/visualising_fellegi_sunter.mdx","webpack://robinlinacre/./src/components/CompactTutorialNav.jsx","webpack://robinlinacre/./src/components/ObservableNotebook.jsx","webpack://robinlinacre/./src/components/ProbHomeNav.jsx","webpack://robinlinacre/./src/components/TutorialNav.jsx"],"sourcesContent":["function _1(md){return(\nmd`# Treemap for Bayes Intuition`\n)}\n\nfunction _settings_raw(inputs,default_settings){return(\ninputs.textarea({\n  value: default_settings,\n  rows: 29\n})\n)}\n\nfunction _max_depth_1(settings,inputs)\n{\n  let num_levels = settings[\"comparison_columns\"].length;\n\n  return inputs.range([0, num_levels], {\n    step: 1,\n    label: \"How many columns to take account of?\"\n  });\n}\n\n\nfunction _4(md){return(\nmd`In the following diagram, the outermost rectangle represents the space all pairwise record comparisons.  \n\nThis can then be recursively split into subsets, beginning with spliting between record pairs that match and those that do not match, then further splitting these rectangles based on comparisons of the values in columns.\n`\n)}\n\nfunction _5(plot_treemap,settings,max_depth_1){return(\nplot_treemap(settings, max_depth_1, 600)\n)}\n\nfunction _plot_treemap(generate_treemap_data,treemap,html,d3,width,DOM,box_html){return(\nfunction (settings, max_depth, height) {\n  const data_generated = generate_treemap_data(settings);\n  const root = treemap(data_generated, height);\n\n  const container = html`<div class=\"treemap_container\">`;\n\n  const tooltip = d3\n    .select(container)\n    .append(\"div\")\n    .attr(\"class\", \"svg-tooltip\")\n    .style(\"position\", \"absolute\")\n    .style(\"display\", \"inline-block\")\n    .style(\"visibility\", \"hidden\")\n    .attr(\"pointer-events\", \"none\");\n\n  const svg = d3\n    .select(container)\n    .append(\"svg\")\n    .attr(\"height\", height)\n    .attr(\"width\", width);\n\n  let grouped_data = d3.filter(root, (d) => d.depth <= max_depth + 1);\n  grouped_data = d3.group(grouped_data, (d) => d.height);\n\n  const node = svg\n    .selectAll(\"g\")\n    .data(grouped_data)\n    .join(\"g\")\n    .selectAll(\"g\")\n    .data((d) => d[1])\n    .join(\"g\")\n    .attr(\"transform\", (d) => `translate(${d.x0},${d.y0})`);\n\n  node\n    .append(\"rect\")\n    .attr(\"id\", (d) => (d.nodeUid = DOM.uid(\"node\")).id)\n    .attr(\"width\", (d) => d.x1 - d.x0)\n    .attr(\"height\", (d) => d.y1 - d.y0)\n    .attr(\"stroke-width\", \"1px\")\n    .attr(\"stroke\", \"black\")\n    .attr(\"fill\", (d) => {\n      if (d.depth == max_depth + 1) {\n        return d3.rgb(d.data.colour);\n      } else {\n        let col = d3.rgb(d.data.colour);\n        if (col.hex() != \"#ffffff\") {\n          if (d.depth == 1) {\n            col.opacity = 0.3;\n          } else {\n            col.opacity = 0.0;\n          }\n        }\n        return col;\n      }\n    });\n\n  node\n    .append(\"foreignObject\")\n    .attr(\"pointer-events\", \"none\")\n    .attr(\"width\", (d) => d.x1 - d.x0)\n    .attr(\"height\", (d) => d.y1 - d.y0)\n    .attr(\"xmlns\", \"http://www.w3.org/1999/xhtml\")\n    .append(\"xhtml:div\")\n    .attr(\"class\", \"wrap-info\")\n\n    .append(\"div\")\n    .html((d) => box_html(d, max_depth));\n\n  node\n    .filter((d) => d.children)\n    .selectAll(\"tspan\")\n    .attr(\"dx\", 3)\n    .attr(\"y\", 13);\n\n  node\n    .filter((d) => !d.children)\n    .selectAll(\"tspan\")\n    .attr(\"x\", 3)\n    .attr(\n      \"y\",\n      (d, i, nodes) => `${(i === nodes.length - 1) * 0.3 + 1.1 + i * 0.9}em`\n    );\n\n  svg\n    .selectAll(\"rect\")\n    .on(\"mouseover\", function (event) {\n      return tooltip.style(\"visibility\", \"visible\");\n    })\n    .on(\"mousemove\", function (event) {\n      let this_data = d3.select(this).datum();\n\n      let b_html = box_html(this_data, max_depth);\n      tooltip.html(b_html);\n\n      let top;\n      let left;\n\n      let tt_height = tooltip.node().getBoundingClientRect().height;\n      let tt_width = tooltip.node().getBoundingClientRect().width;\n\n      top = event.offsetY + 10 + \"px\";\n\n      if (width - event.layerX > tt_width) {\n        left = event.offsetX + 10 + \"px\";\n      } else {\n        left = event.offsetX - tt_width - 10 + \"px\";\n      }\n\n      let visible = \"visible\";\n\n      if (b_html == \"\") {\n        visible = \"hidden\";\n      }\n      return tooltip\n        .style(\"top\", top)\n        .style(\"left\", left)\n        .style(\"visibility\", visible);\n    })\n    .on(\"click\", function (event) {\n      console.log(`height: ${height}`);\n      console.log(`event.layerY: ${event.layerY}`);\n    })\n    .on(\"mouseout\", function () {\n      return tooltip.style(\"visibility\", \"hidden\");\n    });\n\n  return container;\n}\n)}\n\nfunction _add_children_from_column(children_to_add){return(\nfunction add_children_from_column(subtree, column, match) {\n  // We want to find all current leaves.\n  if (\"children\" in subtree) {\n    subtree[\"children\"].forEach((c) => {\n      add_children_from_column(c, column, match);\n    });\n    \n  } \n  // When a leaf is found, add children\n  else {\n    let items_to_add = children_to_add(column, subtree, match);\n    subtree[\"children\"] = items_to_add;\n  }\n  delete subtree[\"value\"];\n}\n)}\n\nfunction _children_to_add(color_match,color_non_match,d3){return(\nfunction children_to_add(col, parent, match) {\n  let children = [];\n  let probabilities;\n  let this_colour;\n  if (match) {\n    probabilities = col[\"m_probabilities\"];\n    this_colour = color_match;\n  } else {\n    probabilities = col[\"u_probabilities\"];\n    this_colour = color_non_match;\n  }\n\n  probabilities.forEach((prob, i) => {\n    let name = \"gamma_\" + col[\"col_name\"] + \" = \" + i;\n    let child = {\n      name: name,\n      name_list: parent[\"name_list\"].concat(name),\n      value: parent[\"value\"] * prob,\n      prob: prob,\n      prob_list: parent[\"prob_list\"].concat(prob)\n    };\n\n    if (col[\"gamma_value\"] == i && parent[\"colour\"] == this_colour) {\n      child[\"colour\"] = this_colour;\n    } else {\n      child[\"colour\"] = d3.rgb(255, 255, 255);\n    }\n    children.push(child);\n  });\n\n  return children;\n}\n)}\n\nfunction _generate_treemap_data(d3,color_match,color_non_match,add_children_from_column){return(\nfunction (settings) {\n  let lam = settings[\"proportion_of_matches\"];\n  let start_template = {\n    name: \"All comparisons\",\n    name_list: [],\n    prob_list: [],\n    prob: 1.0,\n    colour: d3.rgb(255, 255, 255),\n    children: [\n      {\n        name: \"matches\",\n        name_list: [\"match\"],\n        prob_list: [lam],\n        prob: lam,\n        value: lam,\n        colour: color_match\n      },\n      {\n        name: \"non-match\",\n        name_list: [\"non-match\"],\n        prob_list: [1 - lam],\n        prob: 1 - lam,\n        value: 1 - lam,\n        colour: color_non_match\n      }\n    ]\n  };\n\n  let matches = start_template[\"children\"][0];\n  let non_matches = start_template[\"children\"][1];\n\n  settings[\"comparison_columns\"].forEach((c, i) => {\n    add_children_from_column(matches, c, true);\n    add_children_from_column(non_matches, c, false);\n  });\n\n  return start_template;\n}\n)}\n\nfunction _box_html(format_perc,html){return(\nfunction box_html(d, max_depth) {\n  let name_list = d.data.name_list;\n  let prob_list = d.data.prob_list;\n\n  let zipped = name_list.map((k, i) => [k, prob_list[i]]);\n\n  let elems = zipped.map((d) => `<p>${d[0]} (${format_perc(d[1])})`);\n\n  let text = elems.join(\" and \");\n  let final_prob = prob_list.reduce((a, b) => a * b, 1);\n  text = text + `<p>Proportion of all comparisons: ${format_perc(final_prob)}`;\n  let contents = html`${text}`;\n\n  if (d.depth == max_depth + 1) {\n    return contents.innerHTML;\n  } else {\n    return \"\";\n  }\n}\n)}\n\nfunction _settings(settings_raw){return(\nJSON.parse(settings_raw)\n)}\n\nfunction _12(settings){return(\nJSON.stringify(settings)\n)}\n\nfunction _styles(html){return(\nhtml`\n<style>\n.wrap-info {\n  padding: 5px;\n  font-family: monospace;\n  font-size: 0.6em;\n  line-height: 1.3em;\n}\n.wrap-info p {\n  margin-top: 0px;\n  margin-bottom: 0.1rem;\n  \n}\ntextarea {\n    max-height: 1000em !important\n}\n\n.svg-tooltip {\n\n    background: rgba(69,77,93,.9);\n    border-radius: .1rem;\n    color: #fff;\n    display: inline-block;\n    max-width: 500px;\n    padding: .2rem .4rem;\n    position: absolute;\n    text-overflow: ellipsis;\n    white-space: pre;\n    z-index: 300;\n    visibility: hidden;\n  }\n\n.svg-tooltip p {\nfont-family: sans-serif;\n    padding: 0;\n    margin: 0.2rem;\n      font-size: 0.8em;\n    line-height: 1.0em;\n  }\n</style>`\n)}\n\nfunction _treemap(d3,width){return(\n(data, height) =>\n  d3\n    .treemap()\n    .tile(d3.treemapSquarify)\n    .size([width, height])\n    .paddingOuter(5)\n    .paddingTop(5)\n    .paddingInner(5)\n    .round(true)(\n    d3\n      .hierarchy(data)\n      .sum((d) => d.value)\n      .sort((a, b) => b.value - a.value)\n  )\n)}\n\nfunction _default_settings(){return(\n`{\n    \"proportion_of_matches\": 0.4,\n    \"comparison_columns\": [\n        {\n            \"col_name\": \"fname\",\n            \"m_probabilities\": [0.25, 0.75],\n            \"u_probabilities\": [0.7,  0.3],\n            \"gamma_value\": 1\n        },\n        {\n            \"col_name\": \"sname\",\n            \"m_probabilities\": [0.2, 0.8],\n            \"u_probabilities\": [0.8,  0.2],\n            \"gamma_value\": 0\n        },\n        {\n            \"col_name\": \"dob\",\n            \"m_probabilities\": [0.2, 0.8],\n            \"u_probabilities\": [0.8,  0.2],\n            \"gamma_value\": 1\n        },\n        {\n            \"col_name\": \"town\",\n            \"m_probabilities\": [0.2, 0.8],\n            \"u_probabilities\": [0.8,  0.2],\n            \"gamma_value\": 1\n        }\n    ]\n}`\n)}\n\nfunction _format_perc(d3){return(\nd3.format(\".1%\")\n)}\n\nfunction _colours(d3){return(\nd3.scaleOrdinal(d3.schemeCategory10)\n)}\n\nfunction _color_match(d3,colours){return(\nd3.rgb(colours(2)).brighter(2.5)\n)}\n\nfunction _color_non_match(d3,colours){return(\nd3.rgb(colours(1)).brighter(1.5)\n)}\n\nfunction _d3(require){return(\nrequire(\"d3@6\")\n)}\n\nfunction _inputs(require){return(\nrequire(\"@observablehq/inputs\")\n)}\n\nfunction _22(){return(\n`Links:\n\nx times more likely: \nhttps://betterexplained.com/articles/understanding-bayes-theorem-with-ratios/\nhttps://rss.onlinelibrary.wiley.com/doi/pdf/10.1111/j.1740-9713.2006.00204.x\n\nOdds are not quite the same as bayes factors:  https://ocw.mit.edu/courses/mathematics/18-05-introduction-to-probability-and-statistics-spring-2014/readings/MIT18_05S14_Reading12b.pdf\n\nhttps://cran.r-project.org/web/packages/BayesFactor/vignettes/odds_probs.html#:~:text=The%20Bayes%20factor%20represents%20the,are%20what%20are%20being%20changed.&text=Further%2C%20these%20odds%20can%20be,models%20sum%20to%20known%20probability.\nThe Bayes factor represents the relative evidence between two models – that is, the change in the model odds due to the data – but the odds are what are being changed. \n\n\nhttps://bookdown.org/kevin_davisross/bayesian-reasoning-and-methods/bayes-factor.html\nRepresenting bayes theorem using bf\n\n`\n)}\n\nfunction _23(generate_treemap_data,settings){return(\ngenerate_treemap_data(settings)\n)}\n\nexport default function define(runtime, observer) {\n  const main = runtime.module();\n  main.variable(observer()).define([\"md\"], _1);\n  main.variable(observer(\"viewof settings_raw\")).define(\"viewof settings_raw\", [\"inputs\",\"default_settings\"], _settings_raw);\n  main.variable(observer(\"settings_raw\")).define(\"settings_raw\", [\"Generators\", \"viewof settings_raw\"], (G, _) => G.input(_));\n  main.variable(observer(\"viewof max_depth_1\")).define(\"viewof max_depth_1\", [\"settings\",\"inputs\"], _max_depth_1);\n  main.variable(observer(\"max_depth_1\")).define(\"max_depth_1\", [\"Generators\", \"viewof max_depth_1\"], (G, _) => G.input(_));\n  main.variable(observer()).define([\"md\"], _4);\n  main.variable(observer()).define([\"plot_treemap\",\"settings\",\"max_depth_1\"], _5);\n  main.variable(observer(\"plot_treemap\")).define(\"plot_treemap\", [\"generate_treemap_data\",\"treemap\",\"html\",\"d3\",\"width\",\"DOM\",\"box_html\"], _plot_treemap);\n  main.variable(observer(\"add_children_from_column\")).define(\"add_children_from_column\", [\"children_to_add\"], _add_children_from_column);\n  main.variable(observer(\"children_to_add\")).define(\"children_to_add\", [\"color_match\",\"color_non_match\",\"d3\"], _children_to_add);\n  main.variable(observer(\"generate_treemap_data\")).define(\"generate_treemap_data\", [\"d3\",\"color_match\",\"color_non_match\",\"add_children_from_column\"], _generate_treemap_data);\n  main.variable(observer(\"box_html\")).define(\"box_html\", [\"format_perc\",\"html\"], _box_html);\n  main.variable(observer(\"settings\")).define(\"settings\", [\"settings_raw\"], _settings);\n  main.variable(observer()).define([\"settings\"], _12);\n  main.variable(observer(\"styles\")).define(\"styles\", [\"html\"], _styles);\n  main.variable(observer(\"treemap\")).define(\"treemap\", [\"d3\",\"width\"], _treemap);\n  main.variable(observer(\"default_settings\")).define(\"default_settings\", _default_settings);\n  main.variable(observer(\"format_perc\")).define(\"format_perc\", [\"d3\"], _format_perc);\n  main.variable(observer(\"colours\")).define(\"colours\", [\"d3\"], _colours);\n  main.variable(observer(\"color_match\")).define(\"color_match\", [\"d3\",\"colours\"], _color_match);\n  main.variable(observer(\"color_non_match\")).define(\"color_non_match\", [\"d3\",\"colours\"], _color_non_match);\n  main.variable(observer(\"d3\")).define(\"d3\", [\"require\"], _d3);\n  main.variable(observer(\"inputs\")).define(\"inputs\", [\"require\"], _inputs);\n  main.variable(observer()).define(_22);\n  main.variable(observer()).define([\"generate_treemap_data\",\"settings\"], _23);\n  return main;\n}\n","function _1(md){return(\nmd`# Arquero\n\nArquero is a library for query processing and transformation of array-backed data tables. Following the [relational algebra](https://en.wikipedia.org/wiki/Relational_algebra) and inspired by the design of [dplyr](https://dplyr.tidyverse.org/), Arquero provides a fluent API for manipulating column-oriented data frames. Arquero supports a range of data transformation tasks, including filter, sample, aggregation, window, join, and reshaping operations. Arquero is Spanish for \"archer\": if datasets are [arrows](https://observablehq.com/@theneuralbit/introduction-to-apache-arrow), Arquero helps their aim stay true.`\n)}\n\nfunction _2(md){return(\nmd`Import Arquero and extend it to print HTML tables in Observable:`\n)}\n\nasync function _aq(require,aq_version,aq_packages,toView)\n{\n  const aq = await require(`arquero@${aq_version}`);\n\n  // load and install any additional packages\n  (await Promise.all(aq_packages.map(pkg => require(pkg))))\n    .forEach(pkg => aq.addPackage(pkg));\n\n  // Add HTML table view method to tables\n  aq.addTableMethod('view', toView, { override: true });\n\n  return aq;\n}\n\n\nfunction _aq_version(){return(\n'4.2.0'\n)}\n\nfunction _aq_packages(){return(\n[]\n)}\n\nfunction _6(md){return(\nmd`Export a global reference to Arquero operations:`\n)}\n\nfunction _op(aq){return(\naq.op\n)}\n\nfunction _8(md){return(\nmd`To use the same setup in your own notebooks, add a cell with the following code:\n~~~ js\nimport { aq, op } from '@uwdata/arquero'\n~~~\n`\n)}\n\nfunction _9(md){return(\nmd`To get started, see the [Introducing Arquero](https://observablehq.com/@uwdata/introducing-arquero) and [Arquero Cookbook](https://observablehq.com/@uwdata/arquero-cookbook) notebooks.`\n)}\n\nfunction _10(md){return(\nmd`To use Arquero outside of Observable, see [https://github.com/uwdata/arquero](https://github.com/uwdata/arquero).`\n)}\n\nfunction _11(md){return(\nmd`<hr>\n## Examples\n\nThe core abstractions in Arquero are *data tables*, which model each column as an array of values, and *verbs* that transform data and return new tables. Verbs are table methods, allowing method chaining for multi-step transformations. Though each table is unique, many verbs reuse the underlying columns to limit duplication.\n`\n)}\n\nfunction _12(md){return(\nmd`Average hours of sunshine per month, from [https://usclimatedata.com/](https://usclimatedata.com/):`\n)}\n\nfunction _dt(aq){return(\naq.table({\n  'Seattle': [69, 108, 178, 207, 253, 268, 312, 281, 221, 142, 72, 52],\n  'Chicago': [135, 136, 187, 215, 281, 311, 318, 283, 226, 193, 113, 106],\n  'San Francisco': [165, 182, 251, 281, 314, 330, 300, 272, 267, 243, 189, 156]\n})\n)}\n\nfunction _14(md){return(\nmd`Sorted differences between Seattle and Chicago:`\n)}\n\nfunction _15(dt,op){return(\ndt.derive({\n    month: d => op.row_number(),\n    diff:  d => d.Seattle - d.Chicago\n  })\n  .select('month', 'diff')\n  .orderby('month')\n  .view({ height: 400 })\n)}\n\nfunction _16(md){return(\nmd`Is Seattle more correlated with San Francisco or Chicago?`\n)}\n\nfunction _17(dt,op){return(\ndt.rollup({\n    corr_sf:  op.corr('Seattle', 'San Francisco'),\n    corr_chi: op.corr('Seattle', 'Chicago')\n  })\n  .view()\n)}\n\nfunction _18(md){return(\nmd`Summary statistics per city, as output objects:`\n)}\n\nfunction _19(dt,aq,op){return(\ndt.fold(aq.all(), { as: ['city', 'sun'] })\n  .groupby('city')\n  .rollup({\n    min:  d => op.min(d.sun), // functional form of op.min('sun')\n    max:  d => op.max(d.sun),\n    avg:  d => op.average(d.sun),\n    med:  d => op.median(d.sun),\n    // functional forms permit flexible table expressions\n    skew: ({sun: s}) => (op.mean(s) - op.median(s)) / op.stdev(s) || 0\n  })\n  .objects()\n)}\n\nfunction _20(md){return(\nmd`<hr>\n## Utilities\n`\n)}\n\nfunction _toView(html)\n{\n  const DEFAULT_LIMIT = 100;\n  const DEFAULT_NULL = value => `<span style=\"color: #999;\">${value}</span>`;\n  const tableStyle = 'margin: 0; border-collapse: collapse; width: initial;';\n  const cellStyle = 'padding: 1px 5px; white-space: nowrap; overflow-x: hidden; text-overflow: ellipsis; font-variant-numeric: tabular-nums;';\n\n  // extend table prototype to provide an HTML table view\n  return function(dt, opt = {}) {\n    // permit shorthand for limit\n    if (typeof opt === 'number') opt = { limit: opt };\n    \n    // marshal cell color options\n    const color = { ...opt.color };\n    if (typeof opt.color === 'function') {\n      // if function, apply to all columns\n      dt.columnNames().forEach(name => color[name] = opt.color);\n    } else {\n      // otherwise, gather per-column color options\n      for (const key in color) {\n        const value = color[key];\n        color[key] = typeof value === 'function' ? value : () => value;\n      }\n    }\n\n    // marshal CSS styles as toHTML() options\n    const table = `${tableStyle}`;\n    const td = (name, index, row) => {\n      return `${cellStyle} max-width: ${+opt.maxCellWidth || 300}px;`\n        + (color[name] ? ` background-color: ${color[name](index, row)};` : '');\n    };\n\n    opt = {\n      limit: DEFAULT_LIMIT,\n      null: DEFAULT_NULL,\n      ...opt,\n      style: { table, td, th: td }\n    };\n\n    // return container div, bind table value to support viewof operator\n    const size = `max-height: ${+opt.height || 270}px`;\n    const style = `${size}; overflow-x: auto; overflow-y: auto;`;\n    const view = html`<div style=\"${style}\">${dt.toHTML(opt)}</div>`;\n    view.value = dt;\n    return view;\n  };\n}\n\n\nexport default function define(runtime, observer) {\n  const main = runtime.module();\n  main.variable(observer()).define([\"md\"], _1);\n  main.variable(observer()).define([\"md\"], _2);\n  main.variable(observer(\"aq\")).define(\"aq\", [\"require\",\"aq_version\",\"aq_packages\",\"toView\"], _aq);\n  main.variable(observer(\"aq_version\")).define(\"aq_version\", _aq_version);\n  main.variable(observer(\"aq_packages\")).define(\"aq_packages\", _aq_packages);\n  main.variable(observer()).define([\"md\"], _6);\n  main.variable(observer(\"op\")).define(\"op\", [\"aq\"], _op);\n  main.variable(observer()).define([\"md\"], _8);\n  main.variable(observer()).define([\"md\"], _9);\n  main.variable(observer()).define([\"md\"], _10);\n  main.variable(observer()).define([\"md\"], _11);\n  main.variable(observer()).define([\"md\"], _12);\n  main.variable(observer(\"dt\")).define(\"dt\", [\"aq\"], _dt);\n  main.variable(observer()).define([\"md\"], _14);\n  main.variable(observer()).define([\"dt\",\"op\"], _15);\n  main.variable(observer()).define([\"md\"], _16);\n  main.variable(observer()).define([\"dt\",\"op\"], _17);\n  main.variable(observer()).define([\"md\"], _18);\n  main.variable(observer()).define([\"dt\",\"aq\",\"op\"], _19);\n  main.variable(observer()).define([\"md\"], _20);\n  main.variable(observer(\"toView\")).define(\"toView\", [\"html\"], _toView);\n  return main;\n}\n","import define1 from \"./79750b3b8e929d9d@209.js\";\n\nfunction _1(md){return(\nmd`# Fellegi Sunter utils`\n)}\n\nfunction _records_l(){return(\n[\n  {\n    uid: \"1_l\",\n    fname: \"John\",\n    sname: \"Smith\",\n    dob: \"1989-03-02\",\n    town: \"Bristol\"\n  },\n  {\n    uid: \"2_l\",\n    fname: \"Tom\",\n    sname: \"Hanks\",\n    dob: \"1956-07-09\",\n    town: \"Concord\"\n  },\n  {\n    uid: \"3_l\",\n    fname: \"David\",\n    sname: \"Smith\",\n    dob: \"1981-08-21\",\n    town: \"London\"\n  }\n]\n)}\n\nfunction _records_r(){return(\n[\n  {\n    uid: \"1_r\",\n    fname: \"Jonathan\",\n    sname: \"Smith\",\n    dob: \"1989-03-02\",\n    town: \"Bristol\"\n  },\n  {\n    uid: \"2_r\",\n    fname: \"David\",\n    sname: \"Smith\",\n    dob: \"1981-08-21\",\n    town: \"Peckham\"\n  }\n]\n)}\n\nfunction _df_r(aq,records_r){return(\naq.from(records_r)\n)}\n\nfunction _splink_settings()\n{\n  return {\n    proportion_of_matches: 1 / 100,\n    comparison_columns: [\n      {\n        num_levels: 3,\n        col_name: \"fname\",\n        u_probabilities: [0.8, 0.2],\n        m_probabilities: [0.2, 0.8],\n        case_expression: (row) => {\n          if (row.fname_l == row.fname_r) {\n            return 1;\n          } else {\n            return 0;\n          }\n        }\n      },\n      {\n        num_levels: 3,\n        col_name: \"sname\",\n        u_probabilities: [0.9, 0.1],\n        m_probabilities: [0.2, 0.8],\n        case_expression: (row) => {\n          if (row.sname_l == row.sname_r) {\n            return 1;\n          } else {\n            return 0;\n          }\n        }\n      },\n      {\n        col_name: \"dob\",\n        u_probabilities: [0.99, 0.01],\n        m_probabilities: [0.2, 0.8],\n        case_expression: (row) => {\n          if (row.dob_l == row.dob_r) {\n            return 1;\n          } else {\n            return 0;\n          }\n        }\n      },\n      {\n        col_name: \"town\",\n        u_probabilities: [0.7, 0.3],\n        m_probabilities: [0.3, 0.7],\n        case_expression: (row) => {\n          if (row.town_l == row.town_r) {\n            return 1;\n          } else {\n            return 0;\n          }\n        }\n      }\n    ]\n  };\n}\n\n\nfunction _df_comparison(get_df_comparison,records_l,records_r){return(\nget_df_comparison(records_l, records_r)\n)}\n\nfunction _7(df_comparison){return(\ndf_comparison.view()\n)}\n\nfunction _df_gammas(get_df_gammas,df_comparison,splink_settings){return(\nget_df_gammas(df_comparison, splink_settings)\n)}\n\nfunction _9(df_gammas){return(\ndf_gammas.view()\n)}\n\nfunction _10(get_df_e,df_gammas,splink_settings,term_freqs){return(\nget_df_e(df_gammas, splink_settings, term_freqs).view()\n)}\n\nfunction _get_df_e(get_match_probability,aq){return(\nfunction get_df_e(df_gammas, splink_settings, term_freqs = {}) {\n  let df_e = df_gammas.objects().map(function (row) {\n    row[\"match_probability\"] = get_match_probability(\n      row,\n      splink_settings,\n      term_freqs\n    );\n    return row;\n  });\n  let df = aq.from(df_e);\n  df = df.relocate([\"match_probability\"], { after: \"uid_r\" });\n  return df;\n}\n)}\n\nfunction _get_match_probability(prob_to_log2_bf,log2_bf_to_prob){return(\nfunction (row, settings, term_freqs = {}) {\n  let comparison_columns = settings.comparison_columns;\n  let prior_log2_bg = prob_to_log2_bf(settings.proportion_of_matches);\n\n  let log2_bayes = comparison_columns.reduce((a, cc) => {\n    let gamma_col_name = \"𝛾_\" + cc.col_name;\n    let gamma = row[gamma_col_name];\n\n    // gamma = -1 means one side of the comparison is null\n    if (gamma == -1) {\n      return a;\n    }\n\n    let m = cc[\"m_probabilities\"][gamma];\n    let u = cc[\"u_probabilities\"][gamma];\n\n    // If TF lookup provided, attempt to use to overwrite u\n    let l_val = row[cc.col_name + \"_l\"].toLowerCase();\n    let r_val = row[cc.col_name + \"_r\"].toLowerCase();\n\n    if (l_val == r_val) {\n      if (cc.col_name in term_freqs) {\n        let tfs = term_freqs[cc.col_name];\n\n        let u_l = tfs[l_val] || 0;\n        let u_r = tfs[r_val] || 0;\n        let u_new = Math.max(u_l, u_r);\n        if (u_new > 0) {\n          u = u_new;\n        }\n      }\n    }\n\n    return a + Math.log2(m / u);\n  }, prior_log2_bg);\n\n  return log2_bf_to_prob(log2_bayes);\n}\n)}\n\nfunction _get_match_probability_components(prob_to_log2_bf,log2_bf_to_prob){return(\nfunction (row, settings, num_columns) {\n  if (num_columns == undefined) {\n    num_columns = settings.comparison_columns.length;\n  }\n  let comparison_columns = settings.comparison_columns.slice(0, num_columns);\n  let prior_log2_bg = prob_to_log2_bf(settings.proportion_of_matches);\n\n  let d = {\n    comparison_vector: [],\n    gamma_symbols: [],\n    m_values: [],\n    u_values: [],\n    m_symbols: [],\n    u_symbols: [],\n\n    bayes_factors: [],\n    log2_bayes_factors: [],\n    col_names: [],\n    match_probability: null,\n    lam: settings.proportion_of_matches\n  };\n\n  comparison_columns.forEach((cc) => {\n    let col_name = \"𝛾_\" + cc.col_name;\n    let gamma = row[col_name];\n    let m = cc[\"m_probabilities\"][gamma];\n    let u = cc[\"u_probabilities\"][gamma];\n    let col_name_escaped = cc.col_name.replace(\"_\", \"\\\\_\");\n\n    d[\"comparison_vector\"].push(gamma);\n    d[\"gamma_symbols\"].push(`\\\\gamma_\\\\text{${col_name_escaped}}`);\n    d[\"col_names\"].push(col_name);\n    d[\"m_values\"].push(m);\n    d[\"m_symbols\"].push(`m_{\\\\text{${col_name_escaped}},${gamma}}`);\n    d[\"u_values\"].push(u);\n    d[\"u_symbols\"].push(`u_{\\\\text{${col_name_escaped}},${gamma}}`);\n    d[\"bayes_factors\"].push(m / u);\n    d[\"log2_bayes_factors\"].push(Math.log2(m / u));\n  });\n\n  let log2_bayes = d[\"log2_bayes_factors\"].reduce((a, bf) => {\n    return a + bf;\n  }, prior_log2_bg);\n\n  d[\"match_probability\"] = log2_bf_to_prob(log2_bayes);\n  let lam = settings.proportion_of_matches;\n  d[\"size_of_match_portion\"] = lam * d[\"m_values\"].reduce((a, b) => a * b, 1);\n  d[\"size_of_non_match_portion\"] =\n    (1 - lam) * d[\"u_values\"].reduce((a, b) => a * b, 1);\n  return d;\n}\n)}\n\nfunction _get_m_u_formula_numbers(get_match_probability_components){return(\nfunction(row, settings, num_columns) {\n  let d = get_match_probability_components(row, settings, num_columns);\n  let m = d[\"m_values\"].map(d => d.toPrecision(3));\n  let u = d[\"u_values\"].map(d => d.toPrecision(3));\n  let lam = d[\"lam\"].toPrecision(3);\n  let lam_m = [lam].concat(m);\n  let lam_u = [`(1 - ${lam})`].concat(u);\n\n  let m_tex = lam_m.join(\" \\\\times \");\n  let u_tex = lam_u.join(\" \\\\times \");\n\n  let p = d[\"match_probability\"].toPrecision(3);\n  let m_part = d[\"size_of_match_portion\"].toPrecision(3);\n  let u_part = d[\"size_of_non_match_portion\"].toPrecision(3);\n  return `\\\\frac{${m_tex}}{(${m_tex}) + (${u_tex})}  \\\\newline\\[10pt] = \\\\frac{${m_part}}{${m_part} + ${u_part}}  \\\\newline\\[10pt] = ${p}`;\n}\n)}\n\nfunction _get_m_u_formula_symbols(get_match_probability_components){return(\nfunction(row, settings) {\n  let d = get_match_probability_components(row, settings);\n  let m = d[\"m_symbols\"];\n  let u = d[\"u_symbols\"];\n  let lam = d[\"lam\"];\n  let lam_m = [\"\\\\lambda\"].concat(m);\n  let lam_u = [`(1 - \\\\lambda)`].concat(u);\n  let m_tex = lam_m.join(\" \");\n  let u_tex = lam_u.join(\" \");\n\n  return `\\\\frac{${m_tex}}{${m_tex}) + ${u_tex}}`;\n}\n)}\n\nfunction _16(tex,get_m_u_formula_symbols,df_gammas,splink_settings){return(\ntex`${get_m_u_formula_symbols(df_gammas.objects()[0], splink_settings)}\n`\n)}\n\nfunction _get_comparison_vector_symbols_and_numbers(get_match_probability_components){return(\nfunction (\n  row,\n  settings,\n  num_columns\n) {\n  let d = get_match_probability_components(row, settings, num_columns);\n  let joined = d[\"gamma_symbols\"].join(\", \");\n  let joined2 = d[\"comparison_vector\"].join(\", \");\n  return `\\\\bm{\\\\gamma} = [${joined}]= [${joined2}]`;\n}\n)}\n\nfunction _18(tex,get_comparison_vector_symbols_and_numbers,df_gammas,splink_settings){return(\ntex`${get_comparison_vector_symbols_and_numbers(\n  df_gammas.objects()[0],\n  splink_settings\n)}\n`\n)}\n\nfunction _19(tex){return(\ntex`\\bm{\\gamma} = [\\gamma_\\text{fname}, \\gamma_\\text{sname}]`\n)}\n\nfunction _20(tex,get_m_u_formula_numbers,df_gammas,splink_settings){return(\ntex`${get_m_u_formula_numbers(df_gammas.objects()[0], splink_settings)}`\n)}\n\nfunction _21(get_match_probability_components,df_gammas,splink_settings)\n{\n  return get_match_probability_components(\n    df_gammas.objects()[0],\n    splink_settings\n  );\n}\n\n\nfunction _get_df_comparison(aq){return(\nfunction (records_as_dict_l, records_as_dict_r) {\n  let df_l = aq.from(records_as_dict_l);\n  let df_r = aq.from(records_as_dict_r);\n  let df_comparison = df_l.join(df_r, (a, b) => true, null, {\n    suffix: [\"_l\", \"_r\"]\n  });\n\n  // Group columns\n  let colname_no_suffix = df_l.columnNames();\n\n  let cols_ordered = [];\n  colname_no_suffix.forEach((d) => {\n    cols_ordered.push(d + \"_l\");\n    cols_ordered.push(d + \"_r\");\n  });\n\n  df_comparison = df_comparison.select(cols_ordered);\n\n  return df_comparison;\n}\n)}\n\nfunction _get_df_gammas(aq){return(\nfunction get_df_gammas(df_comparison, splink_settings) {\n  let comparison_columns = splink_settings[\"comparison_columns\"];\n  // let df_gammas = df_comparison;\n  // let derivation = {};\n  // comparison_columns.forEach(function (cc) {\n  //   derivation[\"𝛾_\" + cc.col_name] = cc.case_expression;\n  // });\n\n  // df_gammas = df_gammas.derive(derivation);\n\n  // Since we want function calls like double metaphone in our comparison columns, we need to\n  // roundtrip from aq -> object -> aq\n\n  let df_gammas = df_comparison.objects();\n\n  comparison_columns.forEach(function (cc) {\n    df_gammas.forEach(function (row) {\n      row[\"𝛾_\" + cc.col_name] = cc.case_expression(row);\n    });\n  });\n\n  df_gammas = aq.from(df_gammas);\n\n  // Put columns in order\n  let col_order = [\"uid_l\", \"uid_r\"];\n  comparison_columns.forEach((cc) => {\n    col_order.push(cc.col_name + \"_l\");\n    col_order.push(cc.col_name + \"_r\");\n    col_order.push(\"𝛾_\" + cc.col_name);\n  });\n\n  df_gammas = df_gammas.select(col_order);\n\n  return df_gammas;\n}\n)}\n\nfunction _bayes_factor_to_prob(){return(\nfunction bayes_factor_to_prob(b) {\n  return b / (b + 1);\n}\n)}\n\nfunction _log2_bf_to_prob(bayes_factor_to_prob){return(\nfunction log2_bf_to_prob(b) {\n  return bayes_factor_to_prob(2 ** b);\n}\n)}\n\nfunction _prob_to_bayes_factor(){return(\nfunction prob_to_bayes_factor(p) {\n  return p / (1 - p);\n}\n)}\n\nfunction _prob_to_log2_bf(prob_to_bayes_factor){return(\nfunction prob_to_log2_bf(p) {\n  return Math.log2(prob_to_bayes_factor(p));\n}\n)}\n\nfunction _first_name_lookup(d3)\n{\n  return d3\n    .csv(\n      \"https://gist.githubusercontent.com/RobinL/0ee2e59db8cbecc105942fe4b101e847/raw/110e5bb3b574b7584b5452d4accfcfad71f2b19d/first_name_noyear.csv\",\n      d3.autoType\n    )\n    .then((csv_file) => {\n      let lookup = {};\n      csv_file.forEach((row) => {\n        lookup[row.firstname] = row.freq;\n      });\n      return lookup;\n    });\n}\n\n\nfunction _surname_lookup(d3)\n{\n  return d3\n    .csv(\n      \"https://gist.githubusercontent.com/RobinL/0ee2e59db8cbecc105942fe4b101e847/raw/110e5bb3b574b7584b5452d4accfcfad71f2b19d/last_name.csv\",\n      d3.autoType\n    )\n    .then((csv_file) => {\n      let lookup = {};\n      csv_file.forEach((row) => {\n        lookup[row.surname] = row.freq;\n      });\n      return lookup;\n    });\n}\n\n\nfunction _term_freqs(first_name_lookup,surname_lookup)\n{\n  return {\n    fname: first_name_lookup,\n    sname: surname_lookup\n  };\n}\n\n\nfunction _32(term_freqs){return(\nterm_freqs.fname[\"joshua\"]\n)}\n\nfunction _33(term_freqs){return(\nterm_freqs.sname[\"linacre\"]\n)}\n\nexport default function define(runtime, observer) {\n  const main = runtime.module();\n  main.variable(observer()).define([\"md\"], _1);\n  main.variable(observer(\"records_l\")).define(\"records_l\", _records_l);\n  main.variable(observer(\"records_r\")).define(\"records_r\", _records_r);\n  main.variable(observer(\"df_r\")).define(\"df_r\", [\"aq\",\"records_r\"], _df_r);\n  main.variable(observer(\"splink_settings\")).define(\"splink_settings\", _splink_settings);\n  main.variable(observer(\"df_comparison\")).define(\"df_comparison\", [\"get_df_comparison\",\"records_l\",\"records_r\"], _df_comparison);\n  main.variable(observer()).define([\"df_comparison\"], _7);\n  main.variable(observer(\"df_gammas\")).define(\"df_gammas\", [\"get_df_gammas\",\"df_comparison\",\"splink_settings\"], _df_gammas);\n  main.variable(observer()).define([\"df_gammas\"], _9);\n  main.variable(observer()).define([\"get_df_e\",\"df_gammas\",\"splink_settings\",\"term_freqs\"], _10);\n  main.variable(observer(\"get_df_e\")).define(\"get_df_e\", [\"get_match_probability\",\"aq\"], _get_df_e);\n  main.variable(observer(\"get_match_probability\")).define(\"get_match_probability\", [\"prob_to_log2_bf\",\"log2_bf_to_prob\"], _get_match_probability);\n  main.variable(observer(\"get_match_probability_components\")).define(\"get_match_probability_components\", [\"prob_to_log2_bf\",\"log2_bf_to_prob\"], _get_match_probability_components);\n  main.variable(observer(\"get_m_u_formula_numbers\")).define(\"get_m_u_formula_numbers\", [\"get_match_probability_components\"], _get_m_u_formula_numbers);\n  main.variable(observer(\"get_m_u_formula_symbols\")).define(\"get_m_u_formula_symbols\", [\"get_match_probability_components\"], _get_m_u_formula_symbols);\n  main.variable(observer()).define([\"tex\",\"get_m_u_formula_symbols\",\"df_gammas\",\"splink_settings\"], _16);\n  main.variable(observer(\"get_comparison_vector_symbols_and_numbers\")).define(\"get_comparison_vector_symbols_and_numbers\", [\"get_match_probability_components\"], _get_comparison_vector_symbols_and_numbers);\n  main.variable(observer()).define([\"tex\",\"get_comparison_vector_symbols_and_numbers\",\"df_gammas\",\"splink_settings\"], _18);\n  main.variable(observer()).define([\"tex\"], _19);\n  main.variable(observer()).define([\"tex\",\"get_m_u_formula_numbers\",\"df_gammas\",\"splink_settings\"], _20);\n  main.variable(observer()).define([\"get_match_probability_components\",\"df_gammas\",\"splink_settings\"], _21);\n  main.variable(observer(\"get_df_comparison\")).define(\"get_df_comparison\", [\"aq\"], _get_df_comparison);\n  main.variable(observer(\"get_df_gammas\")).define(\"get_df_gammas\", [\"aq\"], _get_df_gammas);\n  main.variable(observer(\"bayes_factor_to_prob\")).define(\"bayes_factor_to_prob\", _bayes_factor_to_prob);\n  main.variable(observer(\"log2_bf_to_prob\")).define(\"log2_bf_to_prob\", [\"bayes_factor_to_prob\"], _log2_bf_to_prob);\n  main.variable(observer(\"prob_to_bayes_factor\")).define(\"prob_to_bayes_factor\", _prob_to_bayes_factor);\n  main.variable(observer(\"prob_to_log2_bf\")).define(\"prob_to_log2_bf\", [\"prob_to_bayes_factor\"], _prob_to_log2_bf);\n  const child1 = runtime.module(define1);\n  main.import(\"aq\", child1);\n  main.import(\"op\", child1);\n  main.variable(observer(\"first_name_lookup\")).define(\"first_name_lookup\", [\"d3\"], _first_name_lookup);\n  main.variable(observer(\"surname_lookup\")).define(\"surname_lookup\", [\"d3\"], _surname_lookup);\n  main.variable(observer(\"term_freqs\")).define(\"term_freqs\", [\"first_name_lookup\",\"surname_lookup\"], _term_freqs);\n  main.variable(observer()).define([\"term_freqs\"], _32);\n  main.variable(observer()).define([\"term_freqs\"], _33);\n  return main;\n}\n","function _1(md){return(\nmd`# Fellegi-Sunter visualisation interface`\n)}\n\nfunction _my_interface(inputs,tex,html){return(\nfunction my_interface(col) {\n  let rad_value = col[\"gamma_value\"] == 1 ? \"match\" : \"mismatch\";\n  const rad1 = inputs.radio([\"match\", \"mismatch\"], {\n    label: `Comparison of ${col[\"col_name\"]} is a:`,\n    value: rad_value\n  });\n\n  const u0 = inputs.range([0, 1], {\n    label: tex`u_\\text{${col[\"col_name\"]},level\\_0}`,\n    value: col[\"u_probabilities\"][0]\n  });\n  const u1 = inputs.range([0, 1], {\n    label: tex`u_\\text{${col[\"col_name\"]},level\\_1}`,\n    value: col[\"u_probabilities\"][1]\n  });\n\n  const m0 = inputs.range([0, 1], {\n    label: tex`m_\\text{${col[\"col_name\"]},level\\_0}`,\n    value: col[\"m_probabilities\"][0]\n  });\n  const m1 = inputs.range([0, 1], {\n    label: tex`m_\\text{${col[\"col_name\"]},level\\_1}`,\n    value: col[\"m_probabilities\"][1]\n  });\n\n  const form = html`\n    <h4>Choose value and parameters for ${col[\"col_name\"]}</h4>\n    ${rad1}\n    <div class=\"container\">\n      <div class=\"item-0\">${u0}${m0}</div>\n      <div class=\"item-1\">${u1}${m1}</div>\n    </div>\n  `;\n\n  let get_value = () => {\n    return {\n      col_name: col[\"col_name\"],\n      gamma_value: rad1.querySelector(\"input\").checked ? 1 : 0,\n      u_probabilities: [u0.value, u1.value],\n      m_probabilities: [m0.value, m1.value]\n    };\n  };\n\n  rad1.onclick = () => {\n    // form.dispatchEvent(new CustomEvent(\"input\"));\n    console.log(rad1.value);\n    form.value = get_value();\n  };\n\n  u0.oninput = () => {\n    u1.value = 1.0 - u0.value;\n    form.value = get_value();\n    // form.dispatchEvent(new CustomEvent(\"input\"));\n  };\n\n  u1.oninput = () => {\n    u0.value = 1.0 - u1.value;\n    form.value = get_value();\n    // form.dispatchEvent(new CustomEvent(\"input\"));\n  };\n\n  m0.oninput = () => {\n    m1.value = 1.0 - m0.value;\n    form.value = get_value();\n    // form.dispatchEvent(new CustomEvent(\"input\"));\n  };\n\n  m1.oninput = () => {\n    m0.value = 1.0 - m1.value;\n    form.value = get_value();\n    // form.dispatchEvent(new CustomEvent(\"input\"));\n  };\n\n  form.value = get_value();\n\n  return form;\n}\n)}\n\nfunction _fname_val(my_interface){return(\nmy_interface({\n  col_name: \"fname\",\n  gamma_value: 1,\n  m_probabilities: [0.3, 0.7],\n  u_probabilities: [0.75, 0.25]\n})\n)}\n\nfunction _4(fname_val){return(\nfname_val\n)}\n\nfunction _sname_val(my_interface){return(\nmy_interface({\n  col_name: \"sname\",\n  gamma_value: 0,\n  m_probabilities: [0.2, 0.8],\n  u_probabilities: [0.85, 0.15]\n})\n)}\n\nfunction _dob_val(my_interface){return(\nmy_interface({\n  col_name: \"dob\",\n  gamma_value: 1,\n  m_probabilities: [0.2, 0.8],\n  u_probabilities: [0.8, 0.2]\n})\n)}\n\nfunction _town_val(my_interface){return(\nmy_interface({\n  col_name: \"town\",\n  gamma_value: 1,\n  m_probabilities: [0.3, 0.7],\n  u_probabilities: [0.9, 0.1]\n})\n)}\n\nfunction _lam(inputs,tex){return(\ninputs.range([0, 1], { label: tex`\\lambda`, value: 0.3 })\n)}\n\nfunction _splink_settings(lam,fname_val,sname_val,dob_val,town_val)\n{\n  return {\n    proportion_of_matches: lam,\n    comparison_columns: [fname_val, sname_val, dob_val, town_val]\n  };\n}\n\n\nfunction _form_styles(html){return(\nhtml`<style>.container {\n  display: flex;\nflex-wrap: wrap;\n  gap: 12px;\n}\n</style>\n`\n)}\n\nfunction _inputs(require){return(\nrequire(\"@observablehq/inputs\")\n)}\n\nexport default function define(runtime, observer) {\n  const main = runtime.module();\n  main.variable(observer()).define([\"md\"], _1);\n  main.variable(observer(\"my_interface\")).define(\"my_interface\", [\"inputs\",\"tex\",\"html\"], _my_interface);\n  main.variable(observer(\"viewof fname_val\")).define(\"viewof fname_val\", [\"my_interface\"], _fname_val);\n  main.variable(observer(\"fname_val\")).define(\"fname_val\", [\"Generators\", \"viewof fname_val\"], (G, _) => G.input(_));\n  main.variable(observer()).define([\"fname_val\"], _4);\n  main.variable(observer(\"viewof sname_val\")).define(\"viewof sname_val\", [\"my_interface\"], _sname_val);\n  main.variable(observer(\"sname_val\")).define(\"sname_val\", [\"Generators\", \"viewof sname_val\"], (G, _) => G.input(_));\n  main.variable(observer(\"viewof dob_val\")).define(\"viewof dob_val\", [\"my_interface\"], _dob_val);\n  main.variable(observer(\"dob_val\")).define(\"dob_val\", [\"Generators\", \"viewof dob_val\"], (G, _) => G.input(_));\n  main.variable(observer(\"viewof town_val\")).define(\"viewof town_val\", [\"my_interface\"], _town_val);\n  main.variable(observer(\"town_val\")).define(\"town_val\", [\"Generators\", \"viewof town_val\"], (G, _) => G.input(_));\n  main.variable(observer(\"viewof lam\")).define(\"viewof lam\", [\"inputs\",\"tex\"], _lam);\n  main.variable(observer(\"lam\")).define(\"lam\", [\"Generators\", \"viewof lam\"], (G, _) => G.input(_));\n  main.variable(observer(\"splink_settings\")).define(\"splink_settings\", [\"lam\",\"fname_val\",\"sname_val\",\"dob_val\",\"town_val\"], _splink_settings);\n  main.variable(observer(\"form_styles\")).define(\"form_styles\", [\"html\"], _form_styles);\n  main.variable(observer(\"inputs\")).define(\"inputs\", [\"require\"], _inputs);\n  return main;\n}\n","// https://observablehq.com/@robinl/visualising-fellegi-sunter@1011\nimport define1 from \"./379dba93f4bb9357@1129.js\";\nimport define2 from \"./d25176b0fe784ad0@488.js\";\nimport define3 from \"./ecf81050a24329e5@163.js\";\n\nfunction _title(md){return(\nmd`# Visualising the Fellegi Sunter model `\n)}\n\nfunction _2(md){return(\nmd`*A final version of this notebook can be viewed on my blog [here](https://www.robinlinacre.com/visualising_fellegi_sunter/).*`\n)}\n\nfunction _para_1(md,texd){return(\nmd`The [previous article](https://www.robinlinacre.com/maths_of_fellegi_sunter/) presented an implementation of the Fellegi Sunter model.  We showed that match probability could be represented by Equation 1 - which is reproduced below:\n${texd`\n\\operatorname{Pr}(\\text{records match}|\\gamma_{1},\\gamma_{2},\\ldots,\\gamma_{K})  \\newline [10pt] = \\frac{\\lambda m_{1\\ell}m_{2\\ell}\\ldots m_{K\\ell}}{\\lambda m_{1\\ell}m_{2\\ell}\\ldots m_{K\\ell}+ (1-\\lambda)u_{1\\ell}u_{1\\ell} \\ldots u_{K\\ell}} `}\n\n`\n)}\n\nfunction _para_2(md){return(\nmd`This article presents a way to understand and visualise this formula.`\n)}\n\nfunction _para_3(md){return(\nmd`In our visualisation, we are going to take each piece of evidence into account in turn. This is possible due to our assumption of conditional independence of comparison columns given the match status.\n\nThe means Equation 1 is equivalent to a repeated application of Bayes' Theorem (see annex). See [here](https://www.youtube.com/watch?v=HZGCoVF3YvM) is more in depth video about Bayes Theorem.\n`\n)}\n\nfunction _para_4(md){return(\nmd`## Example\n\nWe are going to compute match probability for a record comparison with the following comparison columns:\n\n- \\`fname\\` (first name)\n- \\`sname\\` (surname)\n- \\`dob\\` (date of birth)\n- \\`town\\` \n\n\nThe default parameter values are a bit unrealistic, but help make sure the diagrams are legible.\n`\n)}\n\nfunction _subhead_1(md){return(\nmd`## Step 1`\n)}\n\nfunction _para_5(md,m,nm,tex){return(\nmd`We begin by visualising the space of all pairwise record comparisons, splitting the overall comparison space into ${m`matches`} and ${nm`non-matches`} using our prior, ${tex`\\operatorname{Pr}(\\text{records match}) =  \\lambda`}`\n)}\n\nfunction _lam_view($0){return(\n$0\n)}\n\nfunction _treemap_1(plot_treemap,splink_settings){return(\nplot_treemap(splink_settings, 0, 300)\n)}\n\nfunction _para_6(md,texd,color_match,color_non_match,splink_settings){return(\nmd`Using only this information, our estimate of match probability is just the prior:\n\n${texd`\\text{match probability} =  \\frac{\\lambda }{\\lambda + (1-\\lambda)}  \\newline [10pt] = \\frac{\\colorbox{${color_match.hex()}}{\\text{yellow area}}}{\\colorbox{${color_match.hex()}}{\\text{yellow area}} + \\colorbox{${color_non_match.hex()}}{\\text{blue area}} }= ${splink_settings[\n  \"proportion_of_matches\"\n].toPrecision(4)} `}\n\n`\n)}\n\nfunction _subhead_2(md){return(\nmd`## Step 2 - First name`\n)}\n\nfunction _para_7(md){return(\nmd`We will now choose the parameters of the model for the first name field, and then take this information into account in the diagram.`\n)}\n\nfunction _fname_view($0){return(\n$0\n)}\n\nfunction _para_8(md,choice_text,splink_settings,dict_as_md_table_row,get_row_no_gammas,get_m_u_text,get_row,m,nm){return(\nmd` ${choice_text(\"fname\", splink_settings)}\nAn example of the data would be:\n${dict_as_md_table_row(get_row_no_gammas(1))}\n\nAccording to the model parameters you've chosen:\n\n\n- ${get_m_u_text(\"fname\", get_row(1), splink_settings, \"m\")}\n- ${get_m_u_text(\"fname\", get_row(1), splink_settings, \"u\")}\n\n\n\nGiven this observation, we can subdivide the comparison space, and we know we must be in the ${m`yellow`} or ${nm`blue`} part of the following diagram:\n`\n)}\n\nfunction _treemap_2(plot_treemap,splink_settings){return(\nplot_treemap(splink_settings, 1, 300)\n)}\n\nfunction _para_9(md,m,texd,color_match,color_non_match,tex,get_m_u_formula_numbers,get_row,splink_settings){return(\nmd` What's the probability we're in the ${m`yellow`} area?  This must be:\n\n${texd`\\text{match probability} = \\frac{\\colorbox{${color_match.hex()}}{\\text{yellow area}}}{\\colorbox{${color_match.hex()}}{\\text{yellow area}} + \\colorbox{${color_non_match.hex()}}{\\text{blue area}} } `}\n\nFrom this diagram we can see that the ${tex`\\colorbox{${color_match.hex()}}{$\\text{yellow area} = \\lambda m_{1\\ell}$}`} and the \n${tex`\\colorbox{${color_non_match.hex()}}{$\\text{blue area} = (1-\\lambda) u_{1\\ell}$}`}.\n\nSo:\n\n${texd`\\text{match probability} =  \\frac{\\lambda m_{1\\ell}}{\\lambda m_{1\\ell}+ (1-\\lambda)u_{1\\ell}}`}\n\nWhich, in numbers is:\n\n${tex`${get_m_u_formula_numbers(get_row(2), splink_settings, 1)}`}\n`\n)}\n\nfunction _subhead_3(md){return(\nmd`## Step 3 - Surname`\n)}\n\nfunction _para_10(md){return(\nmd`Let's also choose parameters for \\`sname\\`, the surname field:`\n)}\n\nfunction _sname_view($0){return(\n$0\n)}\n\nfunction _para_11(md,choice_text,splink_settings,dict_as_md_table_row,get_row_no_gammas,get_m_u_text,get_row,m,nm){return(\nmd`${choice_text(\"sname\", splink_settings)}\nAn example of the data would be:\n${dict_as_md_table_row(get_row_no_gammas(2))}\n\nAccording to the model parameters you've chosen:\n\n\n- ${get_m_u_text(\"sname\", get_row(2), splink_settings, \"m\")}\n- ${get_m_u_text(\"sname\", get_row(2), splink_settings, \"u\")}\n\n\n\nGiven this observation, we can subdivide the comparison space, and we know we must be in the ${m`yellow`} or ${nm`blue`} part of the following diagram:`\n)}\n\nfunction _treemap_3(plot_treemap,splink_settings){return(\nplot_treemap(splink_settings, 2, 300)\n)}\n\nfunction _para_12(md,texd,color_match,color_non_match,get_m_u_formula_numbers,get_row,splink_settings){return(\nmd`We now have:\n\n${texd`\\text{match probability} = \\frac{\\colorbox{${color_match.hex()}}{\\text{yellow area}}}{\\colorbox{${color_match.hex()}}{\\text{yellow area}} + \\colorbox{${color_non_match.hex()}}{\\text{blue area}} } `}\n\n${texd`= \\frac{\\lambda m_{1\\ell}m_{2\\ell}}{\\lambda m_{1\\ell}m_{2\\ell}+ (1-\\lambda)u_{1\\ell}u_{2\\ell}}`}\n\nWhich, in numbers is:\n\n${texd`${get_m_u_formula_numbers(get_row(2), splink_settings, 2)}`}\n`\n)}\n\nfunction _subhead_4(md){return(\nmd`## Step 4 - Date of birth`\n)}\n\nfunction _dob_view($0){return(\n$0\n)}\n\nfunction _para_13(md,choice_text,splink_settings,dict_as_md_table_row,get_row_no_gammas,get_m_u_text,get_row,m,nm){return(\nmd` ${choice_text(\"dob\", splink_settings)}\nAn example of the data would be:\n${dict_as_md_table_row(get_row_no_gammas(3))}\n\nAccording to the model parameters you've chosen:\n\n\n- ${get_m_u_text(\"dob\", get_row(3), splink_settings, \"m\")}\n- ${get_m_u_text(\"dob\", get_row(3), splink_settings, \"u\")}\n\n\n\nGiven this observation, we can subdivide the comparison space, and we know we must be in the ${m`yellow`} or ${nm`blue`} part of the following diagram:\n`\n)}\n\nfunction _treemap_4(plot_treemap,splink_settings){return(\nplot_treemap(splink_settings, 3, 300)\n)}\n\nfunction _para_14(md,texd,get_m_u_formula_numbers,get_row,splink_settings){return(\nmd`We now have:\n\n${texd`\\text{match probability} =  \\frac{\\lambda m_{1\\ell}m_{2\\ell}m_{3\\ell}}{\\lambda m_{1\\ell}m_{2\\ell}m_{3\\ell}+ (1-\\lambda)u_{1\\ell}u_{2\\ell}u_{3\\ell}}`}\n\n${texd`${get_m_u_formula_numbers(get_row(3), splink_settings, 3)}`}\n`\n)}\n\nfunction _subhead_5(md){return(\nmd`## Step 5: Town`\n)}\n\nfunction _town_view($0){return(\n$0\n)}\n\nfunction _para_15(md,choice_text,splink_settings,dict_as_md_table_row,get_row_no_gammas,get_m_u_text,get_row,m,nm){return(\nmd`The final column is town.\n\n${choice_text(\"town\", splink_settings)}\nAn example of the final data would be:\n${dict_as_md_table_row(get_row_no_gammas(4))}\n\nAccording to the model parameters you've chosen:\n\n\n- ${get_m_u_text(\"town\", get_row(4), splink_settings, \"m\")}\n- ${get_m_u_text(\"town\", get_row(4), splink_settings, \"u\")}\n\n\n\nGiven this observation, we can subdivide the comparison space, and we know we must be in the ${m`yellow`} or ${nm`blue`} part of the following diagram:\n`\n)}\n\nfunction _treemap_5(plot_treemap,splink_settings){return(\nplot_treemap(splink_settings, 4, 300)\n)}\n\nfunction _para_16(md,texd,tex,get_m_u_formula_numbers,get_row,splink_settings){return(\nmd`The final match probability is therefore:\n\n${texd`\\text{match probability} =  \\frac{\\lambda m_{1\\ell}m_{2\\ell}m_{3\\ell}m_{4\\ell}}{\\lambda m_{1\\ell}m_{2\\ell}m_{3\\ell}m_{4\\ell}+ (1-\\lambda)u_{1\\ell}u_{2\\ell}u_{3\\ell}u_{4\\ell}}`}\n\nWhich, in numbers is:\n\n\n${tex`${get_m_u_formula_numbers(get_row(4), splink_settings)}`}\n`\n)}\n\nfunction _annex(md,tex,texd){return(\nmd`## Annex:  Mathematical representation\n\nThis annex shows why it's possible to represent the calculation of match probability as a step-by-step computation.  \n\nIn particular, we will show that we can calculate match probability using a repeated application of Bayes Theorem.  In pseudocode, our algorithm will be:\n\n\\`\\`\\`\nprior = lambda\nfor col in compaison_columns:\n  posterior = bayes(col, prior)\n  prior = posterior\n\\`\\`\\`\n\n\nWhere the final value of the posterior is equal to ${tex`\n\\operatorname{Pr}(\\text{records match}|\\gamma_{1},\\gamma_{2},\\ldots,\\gamma_{K})`}.\n\nTo demonstrate why this works, consider equation 1, for the case of two columns:\n\n${texd`\n\\operatorname{Pr}(\\text{records match}|\\gamma_{1},\\gamma_{2}) = \\frac{\\lambda m_{1\\ell}m_{2\\ell}}{\\lambda m_{1\\ell}m_{2\\ell}+ (1-\\lambda)u_{1\\ell}u_{1\\ell}} \\tag{2.1}`}\n\nWe start by applying Bayes Theorem once, accounting for the first comparison column:\n\n${texd`\n\\operatorname{Pr}(\\text{records match}|\\gamma_{1}) = t = \\frac{\\lambda m_{1\\ell}}{\\lambda m_{1\\ell}+ (1-\\lambda)u_{1\\ell}}`}\n\nThis posterior, ${tex`t`}, becomes the new prior, which we now use instead of lambda:\n${texd`\n\\text{posterior} = \\operatorname{Pr}(\\text{records match}|\\gamma_{1},\\gamma_{2}) = \\frac{t m_{2\\ell}}{t m_{2\\ell}+ (1-t)u_{2\\ell}}\\tag{2.2}`}\n\nNote that:\n\n${texd`\n1- t = 1 - \\frac{\\lambda m_{1\\ell}}{\\lambda m_{1\\ell}+ (1-\\lambda)u_{1\\ell}} = \\frac{\\lambda m_{1\\ell}+ (1-\\lambda)u_{1\\ell} - \\lambda m_{1\\ell}}{\\lambda m_{1\\ell}+ (1-\\lambda)u_{1\\ell}} = \\frac{(1-\\lambda)u_{1\\ell} }{\\lambda m_{1\\ell}+ (1-\\lambda)u_{1\\ell}}\\tag{2.3}`}\n\nBut ${tex`(2.3)`} shows that  the term ${tex`(\\lambda m_{1\\ell}+ (1-\\lambda)u_{1\\ell})`} appears on both top and bottom of ${tex`(2.2)`} and therefore cancels, leaving ${tex`(2.1)`}  as desired.\n\n`\n)}\n\nfunction _texd(tex){return(\ntex.options({\n  displayMode: true,\n  fleqn: true\n})\n)}\n\nfunction _css_styles(html,color_match,color_non_match){return(\nhtml`<style>\n.katex-display>.katex { font-size: 1em}\n\n\ntextarea {\n    max-height: 1000em !important;\n    font-family: monospace !important;\n}\n\n.katex-display>.katex>.katex-html>.tag {right: unset; padding-left:4em}\n\n.hl_m {\nbackground-color: ${color_match.hex()};\ndisplay:inline-block;\n}\n\n.hl_nm {\nbackground-color: ${color_non_match.hex()};\ndisplay:inline-block;\n}\n\n</style>`\n)}\n\nfunction _get_row(splink_settings){return(\nfunction get_row(depth) {\n  let row = {};\n\n  let lookup = {\n    fname: [\n      { fname_l: \"John\", fname_r: \"Tom\" },\n      { fname_l: \"John\", fname_r: \"John\" }\n    ],\n    sname: [\n      { sname_l: \"Smith\", sname_r: \"Hanks\" },\n      { sname_l: \"Smith\", sname_r: \"Smith\" }\n    ],\n    dob: [\n      { dob_l: \"1989-03-02\", dob_r: \"1981-08-21\" },\n      { dob_l: \"1989-03-02\", dob_r: \"1989-03-02\" }\n    ],\n    town: [\n      { town_l: \"Bristol\", town_r: \"Peckham\" },\n      { town_l: \"Bristol\", town_r: \"Bristol\" }\n    ]\n  };\n  let ccs = splink_settings.comparison_columns.slice(0, depth);\n  ccs.forEach((cc) => {\n    let values = lookup[cc.col_name][cc.gamma_value];\n    row = { ...row, ...values };\n    let gamma_name = \"𝛾_\" + cc.col_name;\n    row[gamma_name] = cc.gamma_value;\n  });\n  return row;\n}\n)}\n\nfunction _get_row_no_gammas(get_row){return(\nfunction get_row_no_gammas(depth) {\n  let row = get_row(depth);\n  let keys = Object.keys(row).filter((d) => !d.includes(\"𝛾_\"));\n  let new_object = {};\n\n  keys.forEach((k) => {\n    new_object[k] = row[k];\n  });\n  return new_object;\n}\n)}\n\nfunction _dict_as_md_table_row(md){return(\nfunction dict_as_md_table_row(dict) {\n  let row1 = Object.keys(dict).join(\" | \");\n  let row2 = Object.keys(dict)\n    .map((d) => \"-\")\n    .join(\" | \");\n  let row3 = Object.values(dict).join(\" | \");\n  return md`${row1} \\n ${row2} \\n ${row3} \\n`;\n}\n)}\n\nfunction _additional_styles(styles){return(\nstyles\n)}\n\nfunction _nm(html){return(\nfunction nm(text) {\n  return html`<span class=\"hl_nm\">${text}</span>`;\n}\n)}\n\nfunction _m(html){return(\nfunction m(text) {\n  return html`<span class=\"hl_m\">${text}</span>`;\n}\n)}\n\nfunction _styles2(form_styles){return(\nform_styles\n)}\n\nfunction _get_m_u_text(m,nm,md){return(\nfunction get_m_u_text(colname, row, settings, m_or_u) {\n  let cc = settings.comparison_columns.filter(\n    (cc) => cc.col_name == colname\n  )[0];\n\n  let gamma_value = row[\"𝛾_\" + colname];\n\n  let matches_text;\n  if (gamma_value == 1) {\n    matches_text = \"matches\";\n  } else if (gamma_value == 0) {\n    matches_text = \"does not match\";\n  }\n\n  let col_name_escaped = colname.replace(\"_\", \"\\\\_\");\n  let gamma_tex = `The column \\`${colname}\\` ${matches_text}`;\n  let percentage = cc[`${m_or_u}_probabilities`][gamma_value] * 100;\n  percentage = parseFloat(percentage).toFixed(0) + \"%\";\n  let match_or_non_match;\n  if (m_or_u == \"m\") {\n    match_or_non_match = m`matching records`;\n  } else {\n    match_or_non_match = nm`non-matching records`;\n  }\n  return md`${gamma_tex} in ${percentage} of ${match_or_non_match}`;\n}\n)}\n\nfunction _choice_text(md,tex){return(\nfunction choice_text(col_name, splink_settings) {\n  let cc;\n  splink_settings.comparison_columns.forEach((d) => {\n    if (d.col_name == col_name) {\n      cc = d;\n    }\n  });\n  let matches_text;\n  let gamma_value = cc[\"gamma_value\"];\n  if (gamma_value == 0) {\n    matches_text = \"does not match\";\n  } else {\n    matches_text = \"matches\";\n  }\n  return md`You have chosen that the column \\`${col_name}\\` ${matches_text}, i.e. that ${tex`\\gamma_\\text{${col_name}}`} = ${gamma_value}.`;\n}\n)}\n\nfunction _inputs(require){return(\nrequire(\"@observablehq/inputs\")\n)}\n\nexport default function define(runtime, observer) {\n  const main = runtime.module();\n  main.variable(observer(\"title\")).define(\"title\", [\"md\"], _title);\n  main.variable(observer()).define([\"md\"], _2);\n  main.variable(observer(\"para_1\")).define(\"para_1\", [\"md\",\"texd\"], _para_1);\n  main.variable(observer(\"para_2\")).define(\"para_2\", [\"md\"], _para_2);\n  main.variable(observer(\"para_3\")).define(\"para_3\", [\"md\"], _para_3);\n  main.variable(observer(\"para_4\")).define(\"para_4\", [\"md\"], _para_4);\n  main.variable(observer(\"subhead_1\")).define(\"subhead_1\", [\"md\"], _subhead_1);\n  main.variable(observer(\"para_5\")).define(\"para_5\", [\"md\",\"m\",\"nm\",\"tex\"], _para_5);\n  main.variable(observer(\"lam_view\")).define(\"lam_view\", [\"viewof lam\"], _lam_view);\n  main.variable(observer(\"treemap_1\")).define(\"treemap_1\", [\"plot_treemap\",\"splink_settings\"], _treemap_1);\n  main.variable(observer(\"para_6\")).define(\"para_6\", [\"md\",\"texd\",\"color_match\",\"color_non_match\",\"splink_settings\"], _para_6);\n  main.variable(observer(\"subhead_2\")).define(\"subhead_2\", [\"md\"], _subhead_2);\n  main.variable(observer(\"para_7\")).define(\"para_7\", [\"md\"], _para_7);\n  main.variable(observer(\"fname_view\")).define(\"fname_view\", [\"viewof fname_val\"], _fname_view);\n  main.variable(observer(\"para_8\")).define(\"para_8\", [\"md\",\"choice_text\",\"splink_settings\",\"dict_as_md_table_row\",\"get_row_no_gammas\",\"get_m_u_text\",\"get_row\",\"m\",\"nm\"], _para_8);\n  main.variable(observer(\"treemap_2\")).define(\"treemap_2\", [\"plot_treemap\",\"splink_settings\"], _treemap_2);\n  main.variable(observer(\"para_9\")).define(\"para_9\", [\"md\",\"m\",\"texd\",\"color_match\",\"color_non_match\",\"tex\",\"get_m_u_formula_numbers\",\"get_row\",\"splink_settings\"], _para_9);\n  main.variable(observer(\"subhead_3\")).define(\"subhead_3\", [\"md\"], _subhead_3);\n  main.variable(observer(\"para_10\")).define(\"para_10\", [\"md\"], _para_10);\n  main.variable(observer(\"sname_view\")).define(\"sname_view\", [\"viewof sname_val\"], _sname_view);\n  main.variable(observer(\"para_11\")).define(\"para_11\", [\"md\",\"choice_text\",\"splink_settings\",\"dict_as_md_table_row\",\"get_row_no_gammas\",\"get_m_u_text\",\"get_row\",\"m\",\"nm\"], _para_11);\n  main.variable(observer(\"treemap_3\")).define(\"treemap_3\", [\"plot_treemap\",\"splink_settings\"], _treemap_3);\n  main.variable(observer(\"para_12\")).define(\"para_12\", [\"md\",\"texd\",\"color_match\",\"color_non_match\",\"get_m_u_formula_numbers\",\"get_row\",\"splink_settings\"], _para_12);\n  main.variable(observer(\"subhead_4\")).define(\"subhead_4\", [\"md\"], _subhead_4);\n  main.variable(observer(\"dob_view\")).define(\"dob_view\", [\"viewof dob_val\"], _dob_view);\n  main.variable(observer(\"para_13\")).define(\"para_13\", [\"md\",\"choice_text\",\"splink_settings\",\"dict_as_md_table_row\",\"get_row_no_gammas\",\"get_m_u_text\",\"get_row\",\"m\",\"nm\"], _para_13);\n  main.variable(observer(\"treemap_4\")).define(\"treemap_4\", [\"plot_treemap\",\"splink_settings\"], _treemap_4);\n  main.variable(observer(\"para_14\")).define(\"para_14\", [\"md\",\"texd\",\"get_m_u_formula_numbers\",\"get_row\",\"splink_settings\"], _para_14);\n  main.variable(observer(\"subhead_5\")).define(\"subhead_5\", [\"md\"], _subhead_5);\n  main.variable(observer(\"town_view\")).define(\"town_view\", [\"viewof town_val\"], _town_view);\n  main.variable(observer(\"para_15\")).define(\"para_15\", [\"md\",\"choice_text\",\"splink_settings\",\"dict_as_md_table_row\",\"get_row_no_gammas\",\"get_m_u_text\",\"get_row\",\"m\",\"nm\"], _para_15);\n  main.variable(observer(\"treemap_5\")).define(\"treemap_5\", [\"plot_treemap\",\"splink_settings\"], _treemap_5);\n  main.variable(observer(\"para_16\")).define(\"para_16\", [\"md\",\"texd\",\"tex\",\"get_m_u_formula_numbers\",\"get_row\",\"splink_settings\"], _para_16);\n  main.variable(observer(\"annex\")).define(\"annex\", [\"md\",\"tex\",\"texd\"], _annex);\n  main.variable(observer(\"texd\")).define(\"texd\", [\"tex\"], _texd);\n  main.variable(observer(\"css_styles\")).define(\"css_styles\", [\"html\",\"color_match\",\"color_non_match\"], _css_styles);\n  const child1 = runtime.module(define1);\n  main.import(\"default_settings\", child1);\n  main.variable(observer(\"get_row\")).define(\"get_row\", [\"splink_settings\"], _get_row);\n  main.variable(observer(\"get_row_no_gammas\")).define(\"get_row_no_gammas\", [\"get_row\"], _get_row_no_gammas);\n  const child2 = runtime.module(define2);\n  main.import(\"get_m_u_formula_symbols\", child2);\n  main.import(\"get_m_u_formula_numbers\", child2);\n  main.import(\"get_comparison_vector_symbols_and_numbers\", child2);\n  main.import(\"get_match_probability_components\", child2);\n  main.variable(observer(\"dict_as_md_table_row\")).define(\"dict_as_md_table_row\", [\"md\"], _dict_as_md_table_row);\n  const child3 = runtime.module(define1);\n  main.import(\"styles\", child3);\n  main.import(\"plot_treemap\", child3);\n  main.import(\"color_match\", child3);\n  main.import(\"color_non_match\", child3);\n  main.variable(observer(\"additional_styles\")).define(\"additional_styles\", [\"styles\"], _additional_styles);\n  main.variable(observer(\"nm\")).define(\"nm\", [\"html\"], _nm);\n  main.variable(observer(\"m\")).define(\"m\", [\"html\"], _m);\n  const child4 = runtime.module(define3);\n  main.import(\"splink_settings\", child4);\n  main.import(\"viewof lam\", child4);\n  main.import(\"lam\", child4);\n  main.import(\"viewof fname_val\", child4);\n  main.import(\"fname_val\", child4);\n  main.import(\"viewof sname_val\", child4);\n  main.import(\"sname_val\", child4);\n  main.import(\"viewof dob_val\", child4);\n  main.import(\"dob_val\", child4);\n  main.import(\"viewof town_val\", child4);\n  main.import(\"town_val\", child4);\n  main.import(\"form_styles\", child4);\n  main.variable(observer(\"styles2\")).define(\"styles2\", [\"form_styles\"], _styles2);\n  main.variable(observer(\"get_m_u_text\")).define(\"get_m_u_text\", [\"m\",\"nm\",\"md\"], _get_m_u_text);\n  main.variable(observer(\"choice_text\")).define(\"choice_text\", [\"md\",\"tex\"], _choice_text);\n  main.variable(observer(\"inputs\")).define(\"inputs\", [\"require\"], _inputs);\n  return main;\n}\n","/*@jsxRuntime classic @jsx React.createElement @jsxFrag React.Fragment*/\nimport React from \"react\";\nimport {MDXLayoutWide as MDXLayout} from \"../components/MDXLayout\";\nimport ProbHomeNav from \"../components/ProbHomeNav\";\nimport notebook from '@robinl/visualising-fellegi-sunter';\nimport ObservableNotebook from '../components/ObservableNotebook';\nimport TutorialNav from '../components/TutorialNav';\nimport CompactTutorialNav from '../components/CompactTutorialNav';\nexport const output_order = [\"additional_styles\", \"title\", \"para_1\", \"para_2\", \"para_3\", \"para_4\", \"subhead_1\", \"para_5\", \"lam_view\", \"treemap_1\", \"para_6\", \"subhead_2\", \"para_7\", \"fname_view\", \"para_8\", \"treemap_2\", \"para_9\", \"subhead_3\", \"para_10\", \"sname_view\", \"para_11\", \"treemap_3\", \"para_12\", \"subhead_4\", \"dob_view\", \"para_13\", \"treemap_4\", \"para_14\", \"subhead_5\", \"town_view\", \"para_15\", \"treemap_5\", \"para_16\", \"annex\", \"additional_styles\", \"styles2\", \"css_styles\"];\nfunction _createMdxContent(props) {\n  return React.createElement(React.Fragment, null, React.createElement(ProbHomeNav), \"\\n\", React.createElement(ObservableNotebook, {\n    notebook: notebook,\n    cells: output_order\n  }), \"\\n\", React.createElement(ProbHomeNav));\n}\nfunction MDXContent(props = {}) {\n  return React.createElement(MDXLayout, props, React.createElement(_createMdxContent, props));\n}\nexport default MDXContent;\n","import React from 'react';\nimport { Link, useStaticQuery, graphql } from 'gatsby';\n\nconst CompactTutorialNav = ({ frontmatter }) => {\n    const { tutorial_number } = frontmatter;\n\n    const data = useStaticQuery(graphql`\n        query {\n            allMdx(filter: { frontmatter: { tutorial_number: { ne: null } } }) {\n                edges {\n                    node {\n                        frontmatter {\n                            tutorial_number\n                        }\n                        fields {\n                            slug\n                        }\n                    }\n                }\n            }\n        }\n    `);\n\n    const tutorials = data.allMdx.edges.map(\n        edge => edge.node.frontmatter.tutorial_number\n    );\n    const prevExists = tutorials.includes(tutorial_number - 1);\n    const nextExists = tutorials.includes(tutorial_number + 1);\n\n    const prevSlug = data.allMdx.edges.find(\n        edge => edge.node.frontmatter.tutorial_number === tutorial_number - 1\n    )?.node?.fields?.slug;\n    const nextSlug = data.allMdx.edges.find(\n        edge => edge.node.frontmatter.tutorial_number === tutorial_number + 1\n    )?.node?.fields?.slug;\n\n    return (\n        <div className=\"bg-gray-100 p-2 mt-2 mb-2 italic rounded-md text-gray-600 text-xs\">\n            <div className=\"flex justify-between\">\n                <div className=\"w-1/3 text-left\">\n                    {prevExists && (\n                        <Link\n                            to={prevSlug}\n                            className=\"text-blue-500 hover:underline\"\n                        >\n                            &larr; Previous article\n                        </Link>\n                    )}\n                </div>\n                <div className=\"w-1/3 text-center\">\n                    <span>\n                        This is part {tutorial_number} of the{' '}\n                        <Link\n                            to=\"/probabilistic_linkage\"\n                            className=\"text-blue-500 hover:underline\"\n                        >\n                            tutorial\n                        </Link>\n                    </span>\n                </div>\n                <div className=\"w-1/3 text-right\">\n                    {nextExists && (\n                        <Link\n                            to={nextSlug}\n                            className=\"text-blue-500 hover:underline\"\n                        >\n                            Next article &rarr;\n                        </Link>\n                    )}\n                </div>\n            </div>\n        </div>\n    );\n};\n\nexport default CompactTutorialNav;\n","import React, { useRef, useEffect } from 'react';\nimport { Runtime, Inspector, Library } from '@observablehq/runtime';\n\nconst mountId = 'mdx-container-div';\n\nconst stdlib = new Library();\n\nconst library = Object.assign({}, stdlib, { width: width_mdx });\n\nfunction width_mdx() {\n    return stdlib.Generators.observe(notify => {\n        let width1 = notify(document.getElementById(mountId).clientWidth);\n        function resized() {\n            let width2 = document.getElementById(mountId).clientWidth;\n            if (width2 !== width1) notify((width1 = width2));\n        }\n\n        window.addEventListener('resize', resized);\n        return () => window.removeEventListener('resize', resized);\n    });\n}\n\nfunction ObservableNotebook({ notebook, cells, customClassName }) {\n    const refs = useRef(cells.map(() => React.createRef()));\n\n    useEffect(() => {\n        const runtime = new Runtime(library);\n        runtime.module(notebook, name => {\n            const index = cells.indexOf(name);\n            if (index !== -1) {\n                return new Inspector(refs.current[index].current);\n            }\n        });\n        return () => runtime.dispose();\n    }, [notebook, cells]);\n\n    return (\n        <div className={customClassName}>\n            {refs.current.map((ref, index) => (\n                <div key={index} ref={ref} />\n            ))}\n        </div>\n    );\n}\n\nexport default ObservableNotebook;\n","import React from 'react';\nimport { Link } from 'gatsby';\n\nconst ProbHomeNav = () => {\n    return (\n        <div className=\"bg-gray-100 p-2 mt-2 mb-2 italic rounded-md text-gray-600 text-xs\">\n            <div className=\"flex justify-center items-center\">\n                <div className=\"text-center\">\n                    <span>\n                        This article is part of the&nbsp;\n                        <Link\n                            to=\"/probabilistic_linkage\"\n                            className=\"text-blue-500 hover:underline\"\n                        >\n                            probabilistic linkage training materials\n                        </Link>\n                    </span>\n                </div>\n            </div>\n        </div>\n    );\n};\n\nexport default ProbHomeNav;\n","import React from 'react';\nimport { Link, useStaticQuery, graphql } from 'gatsby';\n\nconst TutorialNav = ({ frontmatter }) => {\n    const { tutorial_number, title } = frontmatter;\n\n    const data = useStaticQuery(graphql`\n        query {\n            allMdx(filter: { frontmatter: { tutorial_number: { ne: null } } }) {\n                edges {\n                    node {\n                        frontmatter {\n                            tutorial_number\n                            title\n                        }\n                        fields {\n                            slug\n                        }\n                    }\n                }\n            }\n        }\n    `);\n\n    const sortedTutorials = data.allMdx.edges.sort(\n        (a, b) =>\n            a.node.frontmatter.tutorial_number -\n            b.node.frontmatter.tutorial_number\n    );\n\n    return (\n        <div className=\"bg-blue-100  p-4 mt-8  mb-4 rounded-lg \">\n            <div className=\"container mx-auto\">\n                <div className=\"text-blue-800 font-semibold text-base mb-2\">\n                    <Link\n                        to=\"/probabilistic_linkage\"\n                        className=\"text-blue-500 hover:underline\"\n                    >\n                        Probabilistic Linkage Tutorial Navigation:\n                    </Link>\n                </div>\n                <ol className=\"space-y-2 text-sm\">\n                    {sortedTutorials.map(edge => (\n                        <li\n                            key={edge.node.frontmatter.tutorial_number}\n                            className=\"text-blue-600 text-sm\"\n                        >\n                            {tutorial_number ===\n                            edge.node.frontmatter.tutorial_number ? (\n                                <span className=\"font-bold text-sm\">\n                                    {edge.node.frontmatter.title}\n                                </span>\n                            ) : (\n                                <Link\n                                    to={edge.node.fields.slug}\n                                    className=\"hover:underline\"\n                                >\n                                    {edge.node.frontmatter.title}\n                                </Link>\n                            )}\n                        </li>\n                    ))}\n                </ol>\n            </div>\n        </div>\n    );\n};\n\nexport default TutorialNav;\n"],"names":["_1","md","_settings_raw","inputs","default_settings","textarea","value","rows","_max_depth_1","settings","num_levels","length","range","step","label","_4","_5","plot_treemap","max_depth_1","_plot_treemap","generate_treemap_data","treemap","html","d3","width","DOM","box_html","max_depth","height","data_generated","root","container","tooltip","select","append","attr","style","svg","grouped_data","filter","d","depth","group","node","selectAll","data","join","x0","y0","nodeUid","uid","id","x1","y1","rgb","colour","col","hex","opacity","children","i","nodes","on","event","top","left","this_data","this","datum","b_html","getBoundingClientRect","tt_width","offsetY","layerX","offsetX","visible","console","log","layerY","_add_children_from_column","children_to_add","add_children_from_column","subtree","column","match","forEach","c","items_to_add","_children_to_add","color_match","color_non_match","parent","probabilities","this_colour","prob","name","child","name_list","concat","prob_list","push","_generate_treemap_data","lam","start_template","matches","non_matches","_box_html","format_perc","elems","map","k","text","final_prob","reduce","a","b","contents","innerHTML","_settings","settings_raw","JSON","parse","_12","stringify","_styles","_treemap","tile","treemapSquarify","size","paddingOuter","paddingTop","paddingInner","round","hierarchy","sum","sort","_default_settings","_format_perc","format","_colours","scaleOrdinal","schemeCategory10","_color_match","colours","brighter","_color_non_match","_d3","require","_inputs","_22","_23","runtime","observer","main","module","variable","define","G","_","input","_2","async","_aq","aq_version","aq_packages","toView","aq","Promise","all","pkg","addPackage","addTableMethod","override","_aq_version","_aq_packages","_6","_op","_8","_9","_10","_11","_dt","table","_14","_15","dt","op","derive","month","row_number","diff","Seattle","Chicago","orderby","view","_16","_17","rollup","corr_sf","corr","corr_chi","_18","_19","fold","as","groupby","min","sun","max","avg","average","med","median","skew","s","mean","stdev","objects","_20","_toView","DEFAULT_NULL","opt","limit","color","columnNames","key","td","index","row","maxCellWidth","null","th","toHTML","_records_l","fname","sname","dob","town","_records_r","_df_r","records_r","from","_splink_settings","proportion_of_matches","comparison_columns","col_name","u_probabilities","m_probabilities","case_expression","fname_l","fname_r","sname_l","sname_r","dob_l","dob_r","town_l","town_r","_df_comparison","get_df_comparison","records_l","_7","df_comparison","_df_gammas","get_df_gammas","splink_settings","df_gammas","get_df_e","term_freqs","_get_df_e","get_match_probability","df_e","df","relocate","after","_get_match_probability","prob_to_log2_bf","log2_bf_to_prob","prior_log2_bg","log2_bayes","cc","gamma_col_name","gamma","m","u","l_val","toLowerCase","r_val","tfs","u_l","u_r","u_new","Math","log2","_get_match_probability_components","num_columns","undefined","slice","comparison_vector","gamma_symbols","m_values","u_values","m_symbols","u_symbols","bayes_factors","log2_bayes_factors","col_names","match_probability","col_name_escaped","replace","bf","_get_m_u_formula_numbers","get_match_probability_components","toPrecision","lam_m","lam_u","m_tex","u_tex","p","m_part","_get_m_u_formula_symbols","tex","get_m_u_formula_symbols","_get_comparison_vector_symbols_and_numbers","get_comparison_vector_symbols_and_numbers","get_m_u_formula_numbers","_21","_get_df_comparison","records_as_dict_l","records_as_dict_r","df_l","df_r","suffix","colname_no_suffix","cols_ordered","_get_df_gammas","col_order","_bayes_factor_to_prob","_log2_bf_to_prob","bayes_factor_to_prob","_prob_to_bayes_factor","_prob_to_log2_bf","prob_to_bayes_factor","_first_name_lookup","csv","autoType","then","csv_file","lookup","firstname","freq","_surname_lookup","surname","_term_freqs","first_name_lookup","surname_lookup","_32","_33","child1","import","_my_interface","rad_value","rad1","radio","u0","u1","m0","m1","form","get_value","gamma_value","querySelector","checked","onclick","oninput","_fname_val","my_interface","fname_val","_sname_val","_dob_val","_town_val","_lam","sname_val","dob_val","town_val","_form_styles","_title","_para_1","texd","_para_2","_para_3","_para_4","_subhead_1","_para_5","nm","_lam_view","$0","_treemap_1","_para_6","_subhead_2","_para_7","_fname_view","_para_8","choice_text","dict_as_md_table_row","get_row_no_gammas","get_m_u_text","get_row","_treemap_2","_para_9","_subhead_3","_para_10","_sname_view","_para_11","_treemap_3","_para_12","_subhead_4","_dob_view","_para_13","_treemap_4","_para_14","_subhead_5","_town_view","_para_15","_treemap_5","_para_16","_annex","_texd","options","displayMode","fleqn","_css_styles","_get_row","values","gamma_name","_get_row_no_gammas","keys","Object","includes","new_object","_dict_as_md_table_row","dict","row1","row2","row3","_additional_styles","styles","_nm","_m","_styles2","form_styles","_get_m_u_text","colname","m_or_u","matches_text","match_or_non_match","gamma_tex","percentage","parseFloat","toFixed","_choice_text","child2","child3","child4","output_order","_createMdxContent","props","React","ProbHomeNav","ObservableNotebook","notebook","cells","MDXLayout","_ref","_data$allMdx$edges$fi","_data$allMdx$edges$fi2","_data$allMdx$edges$fi3","_data$allMdx$edges$fi4","_data$allMdx$edges$fi5","_data$allMdx$edges$fi6","frontmatter","tutorial_number","useStaticQuery","tutorials","allMdx","edges","edge","prevExists","nextExists","prevSlug","find","fields","slug","nextSlug","className","Link","to","mountId","stdlib","Library","library","assign","Generators","observe","notify","width1","document","getElementById","clientWidth","resized","width2","window","addEventListener","removeEventListener","customClassName","refs","useRef","useEffect","Runtime","indexOf","Inspector","current","dispose","ref","title","sortedTutorials"],"sourceRoot":""}